/*
 * JsSIP 0.6.0
 * Copyright (c) 2012-2014 Jos√© Luis Mill√°n - Versatica <http://www.versatica.com>
 * Homepage: http://jssip.net
 * License: http://jssip.net/license
 */

!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.JsSIP=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function e(){var a=arguments,b=this.useColors;if(a[0]=(b?"%c":"")+this.namespace+(b?" %c":" ")+a[0]+(b?"%c ":" ")+"+"+c.humanize(this.diff),!b)return a;var d="color: "+this.color;a=[a[0],d,"color: inherit"].concat(Array.prototype.slice.call(a,1));var e=0,f=0;return a[0].replace(/%[a-z%]/g,function(a){"%%"!==a&&(e++,"%c"===a&&(f=e))}),a.splice(f,0,d),a}function f(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)}function g(a){try{null==a?localStorage.removeItem("debug"):localStorage.debug=a}catch(b){}}function h(){var a;try{a=localStorage.debug}catch(b){}return a}c=b.exports=a("./debug"),c.log=f,c.formatArgs=e,c.save=g,c.load=h,c.useColors=d,c.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],c.formatters.j=function(a){return JSON.stringify(a)},c.enable(h())},{"./debug":2}],2:[function(a,b,c){function d(){return c.colors[k++%c.colors.length]}function e(a){function b(){}function e(){var a=e,b=+new Date,f=b-(j||b);a.diff=f,a.prev=j,a.curr=b,j=b,null==a.useColors&&(a.useColors=c.useColors()),null==a.color&&a.useColors&&(a.color=d());var g=Array.prototype.slice.call(arguments);g[0]=c.coerce(g[0]),"string"!=typeof g[0]&&(g=["%o"].concat(g));var h=0;g[0]=g[0].replace(/%([a-z%])/g,function(b,d){if("%%"===b)return b;h++;var e=c.formatters[d];if("function"==typeof e){var f=g[h];b=e.call(a,f),g.splice(h,1),h--}return b}),"function"==typeof c.formatArgs&&(g=c.formatArgs.apply(a,g));var i=e.log||c.log||console.log.bind(console);i.apply(a,g)}b.enabled=!1,e.enabled=!0;var f=c.enabled(a)?e:b;return f.namespace=a,f}function f(a){c.save(a);for(var b=(a||"").split(/[\s,]+/),d=b.length,e=0;d>e;e++)b[e]&&(a=b[e].replace(/\*/g,".*?"),"-"===a[0]?c.skips.push(new RegExp("^"+a.substr(1)+"$")):c.names.push(new RegExp("^"+a+"$")))}function g(){c.enable("")}function h(a){var b,d;for(b=0,d=c.skips.length;d>b;b++)if(c.skips[b].test(a))return!1;for(b=0,d=c.names.length;d>b;b++)if(c.names[b].test(a))return!0;return!1}function i(a){return a instanceof Error?a.stack||a.message:a}c=b.exports=e,c.coerce=i,c.disable=g,c.enable=f,c.enabled=h,c.humanize=a("ms"),c.names=[],c.skips=[],c.formatters={};var j,k=0},{ms:3}],3:[function(a,b){function c(a){var b=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(a);if(b){var c=parseFloat(b[1]),d=(b[2]||"ms").toLowerCase();switch(d){case"years":case"year":case"y":return c*k;case"days":case"day":case"d":return c*j;case"hours":case"hour":case"h":return c*i;case"minutes":case"minute":case"m":return c*h;case"seconds":case"second":case"s":return c*g;case"ms":return c}}}function d(a){return a>=j?Math.round(a/j)+"d":a>=i?Math.round(a/i)+"h":a>=h?Math.round(a/h)+"m":a>=g?Math.round(a/g)+"s":a+"ms"}function e(a){return f(a,j,"day")||f(a,i,"hour")||f(a,h,"minute")||f(a,g,"second")||a+" ms"}function f(a,b,c){return b>a?void 0:1.5*b>a?Math.floor(a/b)+" "+c:Math.ceil(a/b)+" "+c+"s"}var g=1e3,h=60*g,i=60*h,j=24*i,k=365.25*j;b.exports=function(a,b){return b=b||{},"string"==typeof a?c(a):b.long?e(a):d(a)}},{}],4:[function(a,b){function c(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function d(a){return"function"==typeof a}function e(a){return"number"==typeof a}function f(a){return"object"==typeof a&&null!==a}function g(a){return void 0===a}b.exports=c,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._maxListeners=void 0,c.defaultMaxListeners=10,c.prototype.setMaxListeners=function(a){if(!e(a)||0>a||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},c.prototype.emit=function(a){var b,c,e,h,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||f(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;throw TypeError('Uncaught, unspecified "error" event.')}if(c=this._events[a],g(c))return!1;if(d(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(e=arguments.length,h=new Array(e-1),i=1;e>i;i++)h[i-1]=arguments[i];c.apply(this,h)}else if(f(c)){for(e=arguments.length,h=new Array(e-1),i=1;e>i;i++)h[i-1]=arguments[i];for(j=c.slice(),e=j.length,i=0;e>i;i++)j[i].apply(this,h)}return!0},c.prototype.addListener=function(a,b){var e;if(!d(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,d(b.listener)?b.listener:b),this._events[a]?f(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,f(this._events[a])&&!this._events[a].warned){var e;e=g(this._maxListeners)?c.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[a].length>e&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())}return this},c.prototype.on=c.prototype.addListener,c.prototype.once=function(a,b){function c(){this.removeListener(a,c),e||(e=!0,b.apply(this,arguments))}if(!d(b))throw TypeError("listener must be a function");var e=!1;return c.listener=b,this.on(a,c),this},c.prototype.removeListener=function(a,b){var c,e,g,h;if(!d(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],g=c.length,e=-1,c===b||d(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(f(c)){for(h=g;h-->0;)if(c[h]===b||c[h].listener&&c[h].listener===b){e=h;break}if(0>e)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(e,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},c.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],d(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},c.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?d(this._events[a])?[this._events[a]]:this._events[a].slice():[]},c.listenerCount=function(a,b){var c;return c=a._events&&a._events[b]?d(a._events[b])?1:a._events[b].length:0}},{}],5:[function(a,b){b.exports="function"==typeof Object.create?function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],6:[function(a,b){function c(){}var d=b.exports={};d.nextTick=function(){var a="undefined"!=typeof window&&window.setImmediate,b="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};if(b){var c=[];return window.addEventListener("message",function(a){var b=a.source;if((b===window||null===b)&&"process-tick"===a.data&&(a.stopPropagation(),c.length>0)){var d=c.shift();d()}},!0),function(a){c.push(a),window.postMessage("process-tick","*")}}return function(a){setTimeout(a,0)}}(),d.title="browser",d.browser=!0,d.env={},d.argv=[],d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.binding=function(){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(){throw new Error("process.chdir is not supported")}},{}],7:[function(a,b){b.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},{}],8:[function(a,b,c){(function(b,d){function e(a,b){var d={seen:[],stylize:g};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),p(b)?d.showHidden=b:b&&c._extend(d,b),v(d.showHidden)&&(d.showHidden=!1),v(d.depth)&&(d.depth=2),v(d.colors)&&(d.colors=!1),v(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=f),i(d,a,d.depth)}function f(a,b){var c=e.styles[b];return c?"["+e.colors[c][0]+"m"+a+"["+e.colors[c][1]+"m":a}function g(a){return a}function h(a){var b={};return a.forEach(function(a){b[a]=!0}),b}function i(a,b,d){if(a.customInspect&&b&&A(b.inspect)&&b.inspect!==c.inspect&&(!b.constructor||b.constructor.prototype!==b)){var e=b.inspect(d,a);return t(e)||(e=i(a,e,d)),e}var f=j(a,b);if(f)return f;var g=Object.keys(b),p=h(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(b)),z(b)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return k(b);if(0===g.length){if(A(b)){var q=b.name?": "+b.name:"";return a.stylize("[Function"+q+"]","special")}if(w(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(y(b))return a.stylize(Date.prototype.toString.call(b),"date");if(z(b))return k(b)}var r="",s=!1,u=["{","}"];if(o(b)&&(s=!0,u=["[","]"]),A(b)){var v=b.name?": "+b.name:"";r=" [Function"+v+"]"}if(w(b)&&(r=" "+RegExp.prototype.toString.call(b)),y(b)&&(r=" "+Date.prototype.toUTCString.call(b)),z(b)&&(r=" "+k(b)),0===g.length&&(!s||0==b.length))return u[0]+r+u[1];if(0>d)return w(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);var x;return x=s?l(a,b,d,p,g):g.map(function(c){return m(a,b,d,p,c,s)}),a.seen.pop(),n(x,r,u)}function j(a,b){if(v(b))return a.stylize("undefined","undefined");if(t(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return s(b)?a.stylize(""+b,"number"):p(b)?a.stylize(""+b,"boolean"):q(b)?a.stylize("null","null"):void 0}function k(a){return"["+Error.prototype.toString.call(a)+"]"}function l(a,b,c,d,e){for(var f=[],g=0,h=b.length;h>g;++g)f.push(F(b,String(g))?m(a,b,c,d,String(g),!0):"");return e.forEach(function(e){e.match(/^\d+$/)||f.push(m(a,b,c,d,e,!0))}),f}function m(a,b,c,d,e,f){var g,h,j;if(j=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},j.get?h=j.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):j.set&&(h=a.stylize("[Setter]","special")),F(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(j.value)<0?(h=q(c)?i(a,j.value,null):i(a,j.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),v(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function n(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function o(a){return Array.isArray(a)}function p(a){return"boolean"==typeof a}function q(a){return null===a}function r(a){return null==a}function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return"symbol"==typeof a}function v(a){return void 0===a}function w(a){return x(a)&&"[object RegExp]"===C(a)}function x(a){return"object"==typeof a&&null!==a}function y(a){return x(a)&&"[object Date]"===C(a)}function z(a){return x(a)&&("[object Error]"===C(a)||a instanceof Error)}function A(a){return"function"==typeof a}function B(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function C(a){return Object.prototype.toString.call(a)}function D(a){return 10>a?"0"+a.toString(10):a.toString(10)}function E(){var a=new Date,b=[D(a.getHours()),D(a.getMinutes()),D(a.getSeconds())].join(":");return[a.getDate(),J[a.getMonth()],b].join(" ")}function F(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var G=/%[sdj%]/g;c.format=function(a){if(!t(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(G,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(b){return"[Circular]"}default:return a}}),h=d[c];f>c;h=d[++c])g+=q(h)||!x(h)?" "+h:" "+e(h);return g},c.deprecate=function(a,e){function f(){if(!g){if(b.throwDeprecation)throw new Error(e);b.traceDeprecation?console.trace(e):console.error(e),g=!0}return a.apply(this,arguments)}if(v(d.process))return function(){return c.deprecate(a,e).apply(this,arguments)};if(b.noDeprecation===!0)return a;var g=!1;return f};var H,I={};c.debuglog=function(a){if(v(H)&&(H=b.env.NODE_DEBUG||""),a=a.toUpperCase(),!I[a])if(new RegExp("\\b"+a+"\\b","i").test(H)){var d=b.pid;I[a]=function(){var b=c.format.apply(c,arguments);console.error("%s %d: %s",a,d,b)}}else I[a]=function(){};return I[a]},c.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},c.isArray=o,c.isBoolean=p,c.isNull=q,c.isNullOrUndefined=r,c.isNumber=s,c.isString=t,c.isSymbol=u,c.isUndefined=v,c.isRegExp=w,c.isObject=x,c.isDate=y,c.isError=z,c.isFunction=A,c.isPrimitive=B,c.isBuffer=a("./support/isBuffer");var J=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];c.log=function(){console.log("%s - %s",E(),c.format.apply(c,arguments))},c.inherits=a("inherits"),c._extend=function(a,b){if(!b||!x(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":7,_process:6,inherits:5}],9:[function(a,b){var c=b.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-]*)\/(\d*)(?:\s*\/(\S*))?/,names:["payload","codec","rate","encoding"],format:function(a){return a.encoding?"rtpmap:%d %s/%s/%s":"rtpmap:%d %s/%s"}},{push:"fmtp",reg:/^fmtp:(\d*) (\S*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(a){return null!=a.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(a){return null!=a.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["value","uri","config"],format:function(a){return null!=a.config?"extmap:%s %s %s":"extmap:%s %s"}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(a){return null!=a.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:(\w*)/,format:"mid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/,format:"%s"},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: generation (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","generation"],format:function(a){var b="candidate:%s %d %s %d %s %d typ %s";return b+=null!=a.raddr?" raddr %s rport %d":"%v%v",null!=a.generation&&(b+=" generation %d"),b}},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_]*):(.*)/,names:["id","attribute","value"],format:"ssrc:%d %s:%s"},{name:"msidSemantic",reg:/^msid-semantic: (\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{push:"invalid",names:["value"]}]};Object.keys(c).forEach(function(a){var b=c[a];b.forEach(function(a){a.reg||(a.reg=/(.*)/),a.format||(a.format="%s")})})},{}],10:[function(a,b,c){var d=a("./parser"),e=a("./writer");c.write=e,c.parse=d.parse,c.parseFmtpConfig=d.parseFmtpConfig,c.parsePayloads=d.parsePayloads,c.parseRemoteCandidates=d.parseRemoteCandidates},{"./parser":11,"./writer":12}],11:[function(a,b,c){var d=function(a){return String(Number(a))===a?Number(a):a},e=function(a,b,c,e){if(e&&!c)b[e]=d(a[1]);else for(var f=0;f<c.length;f+=1)null!=a[f+1]&&(b[c[f]]=d(a[f+1]))},f=function(a,b,c){var d=a.name&&a.names;a.push&&!b[a.push]?b[a.push]=[]:d&&!b[a.name]&&(b[a.name]={});var f=a.push?{}:d?b[a.name]:b;e(c.match(a.reg),f,a.names,a.name),a.push&&b[a.push].push(f)},g=a("./grammar"),h=RegExp.prototype.test.bind(/^([a-z])=(.*)/);c.parse=function(a){var b={},c=[],d=b;return a.split("\r\n").filter(h).forEach(function(a){var b=a[0],e=a.slice(2);"m"===b&&(c.push({rtp:[],fmtp:[]}),d=c[c.length-1]);for(var h=0;h<(g[b]||[]).length;h+=1){var i=g[b][h];if(i.reg.test(e))return f(i,d,e)}}),b.media=c,b};var i=function(a,b){var c=b.split("=");return 2===c.length&&(a[c[0]]=d(c[1])),a};c.parseFmtpConfig=function(a){return a.split(";").reduce(i,{})},c.parsePayloads=function(a){return a.split(" ").map(Number)},c.parseRemoteCandidates=function(a){for(var b=[],c=a.split(" ").map(d),e=0;e<c.length;e+=3)b.push({component:c[e],ip:c[e+1],port:c[e+2]});return b}},{"./grammar":9}],12:[function(a,b){var c=a("./grammar"),d=/%[sdv%]/g,e=function(a){var b=1,c=arguments,e=c.length;return a.replace(d,function(a){if(b>=e)return a;var d=c[b];switch(b+=1,a){case"%%":return"%";case"%s":return String(d);case"%d":return Number(d);case"%v":return""}})},f=function(a,b,c){var d=b.format instanceof Function?b.format(b.push?c:c[b.name]):b.format,f=[a+"="+d];if(b.names)for(var g=0;g<b.names.length;g+=1){var h=b.names[g];f.push(b.name?c[b.name][h]:c[b.names[g]])}else f.push(c[b.name]);return e.apply(null,f)},g=["v","o","s","i","u","e","p","c","b","t","r","z","a"],h=["i","c","b","a"];b.exports=function(a,b){b=b||{},null==a.version&&(a.version=0),null==a.name&&(a.name=" "),a.media.forEach(function(a){null==a.payloads&&(a.payloads="")});var d=b.outerOrder||g,e=b.innerOrder||h,i=[];return d.forEach(function(b){c[b].forEach(function(c){c.name in a?i.push(f(b,c,a)):c.push in a&&a[c.push].forEach(function(a){i.push(f(b,c,a))})})}),a.media.forEach(function(a){i.push(f("m",c.m[0],a)),e.forEach(function(b){c[b].forEach(function(c){c.name in a?i.push(f(b,c,a)):c.push in a&&a[c.push].forEach(function(a){i.push(f(b,c,a))})})})}),i.join("\r\n")+"\r\n"}},{"./grammar":9}],13:[function(a,b){function c(a,b){var c;return c=b?new e(a,b):new e(a)}var d=function(){return this}(),e=d.WebSocket||d.MozWebSocket;b.exports=e?c:null,e&&(c.prototype=e.prototype)},{}],14:[function(a,b){b.exports={name:"jssip",title:"JsSIP",description:"the Javascript SIP library",version:"0.6.0",homepage:"http://jssip.net",author:"Jos√© Luis Mill√°n <jmillan@aliax.net> (https://github.com/jmillan)",contributors:["I√±aki Baz Castillo <ibc@aliax.net> (https://github.com/ibc)","Sa√∫l Ibarra Corretg√© <saghul@gmail.com> (https://github.com/saghul)"],main:"src/JsSIP.js",keywords:["sip","websocket","webrtc","node","browser","library"],license:"MIT",repository:{type:"git",url:"https://github.com/versatica/JsSIP.git"},bugs:{url:"https://github.com/versatica/JsSIP/issues"},dependencies:{debug:"^2.1.0","sdp-transform":"~0.6.1",ws:"~0.4.32"},devDependencies:{grunt:"~0.4.5","grunt-contrib-jshint":"~0.10.0","grunt-contrib-concat":"~0.5.0","grunt-contrib-nodeunit":"~0.4.1","grunt-contrib-uglify":"~0.6.0","grunt-contrib-watch":"~0.6.1","grunt-contrib-symlink":"~0.3.0","grunt-browserify":"~3.0.1","grunt-jsdoc":"~0.5.7",pegjs:"0.7.0"},scripts:{test:"grunt test"}}},{}],15:[function(a,b){var c=a("../package.json"),d={USER_AGENT:c.title+" "+c.version,SIP:"sip",SIPS:"sips",causes:{CONNECTION_ERROR:"Connection Error",REQUEST_TIMEOUT:"Request Timeout",SIP_FAILURE_CODE:"SIP Failure Code",INTERNAL_ERROR:"Internal Error",BUSY:"Busy",REJECTED:"Rejected",REDIRECTED:"Redirected",UNAVAILABLE:"Unavailable",NOT_FOUND:"Not Found",ADDRESS_INCOMPLETE:"Address Incomplete",INCOMPATIBLE_SDP:"Incompatible SDP",MISSING_SDP:"Missing SDP",AUTHENTICATION_ERROR:"Authentication Error",DIALOG_ERROR:"Dialog Error",BYE:"Terminated",WEBRTC_NOT_SUPPORTED:"WebRTC Not Supported",WEBRTC_ERROR:"WebRTC Error",CANCELED:"Canceled",NO_ANSWER:"No Answer",EXPIRES:"Expires",NO_ACK:"No ACK",USER_DENIED_MEDIA_ACCESS:"User Denied Media Access",BAD_MEDIA_DESCRIPTION:"Bad Media Description",RTP_TIMEOUT:"RTP Timeout"},SIP_ERROR_CAUSES:{REDIRECTED:[300,301,302,305,380],BUSY:[486,600],REJECTED:[403,603],NOT_FOUND:[404,604],UNAVAILABLE:[480,410,408,430],ADDRESS_INCOMPLETE:[484],INCOMPATIBLE_SDP:[488,606],AUTHENTICATION_ERROR:[401,407]},ACK:"ACK",BYE:"BYE",CANCEL:"CANCEL",INFO:"INFO",INVITE:"INVITE",MESSAGE:"MESSAGE",NOTIFY:"NOTIFY",OPTIONS:"OPTIONS",REGISTER:"REGISTER",UPDATE:"UPDATE",SUBSCRIBE:"SUBSCRIBE",REASON_PHRASE:{100:"Trying",180:"Ringing",181:"Call Is Being Forwarded",182:"Queued",183:"Session Progress",199:"Early Dialog Terminated",200:"OK",202:"Accepted",204:"No Notification",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",305:"Use Proxy",380:"Alternative Service",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",410:"Gone",412:"Conditional Request Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Unsupported URI Scheme",417:"Unknown Resource-Priority",420:"Bad Extension",421:"Extension Required",422:"Session Interval Too Small",423:"Interval Too Brief",428:"Use Identity Header",429:"Provide Referrer Identity",430:"Flow Failed",433:"Anonymity Disallowed",436:"Bad Identity-Info",437:"Unsupported Certificate",438:"Invalid Identity Header",439:"First Hop Lacks Outbound Support",440:"Max-Breadth Exceeded",469:"Bad Info Package",470:"Consent Needed",478:"Unresolvable Destination",480:"Temporarily Unavailable",481:"Call/Transaction Does Not Exist",482:"Loop Detected",483:"Too Many Hops",484:"Address Incomplete",485:"Ambiguous",486:"Busy Here",487:"Request Terminated",488:"Not Acceptable Here",489:"Bad Event",491:"Request Pending",493:"Undecipherable",494:"Security Agreement Required",500:"JsSIP Internal Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Server Time-out",505:"Version Not Supported",513:"Message Too Large",580:"Precondition Failure",600:"Busy Everywhere",603:"Decline",604:"Does Not Exist Anywhere",606:"Not Acceptable"},ALLOWED_METHODS:"INVITE,ACK,CANCEL,BYE,UPDATE,MESSAGE,OPTIONS",ACCEPTED_BODY_TYPES:"application/sdp, application/dtmf-relay",MAX_FORWARDS:69};b.exports=d},{"../package.json":14}],16:[function(a,b){function c(a,b,c,g){var h;return this.uac_pending_reply=!1,this.uas_pending_reply=!1,b.hasHeader("contact")?(g=b instanceof f.IncomingResponse?b.status_code<200?d.STATUS_EARLY:d.STATUS_CONFIRMED:g||d.STATUS_CONFIRMED,h=b.parseHeader("contact"),"UAS"===c?(this.id={call_id:b.call_id,local_tag:b.to_tag,remote_tag:b.from_tag,toString:function(){return this.call_id+this.local_tag+this.remote_tag}},this.state=g,this.remote_seqnum=b.cseq,this.local_uri=b.parseHeader("to").uri,this.remote_uri=b.parseHeader("from").uri,this.remote_target=h.uri,this.route_set=b.getHeaders("record-route")):"UAC"===c&&(this.id={call_id:b.call_id,local_tag:b.from_tag,remote_tag:b.to_tag,toString:function(){return this.call_id+this.local_tag+this.remote_tag}},this.state=g,this.local_seqnum=b.cseq,this.local_uri=b.parseHeader("from").uri,this.remote_uri=b.parseHeader("to").uri,this.remote_target=h.uri,this.route_set=b.getHeaders("record-route").reverse()),this.owner=a,a.ua.dialogs[this.id.toString()]=this,void e("new "+c+" dialog created with status "+(this.state===d.STATUS_EARLY?"EARLY":"CONFIRMED"))):{error:"unable to create a Dialog without Contact header field"}}b.exports=c;var d={STATUS_EARLY:1,STATUS_CONFIRMED:2};c.C=d;var e=a("debug")("JsSIP:Dialog"),f=a("./SIPMessage"),g=a("./Constants"),h=a("./Transactions"),i=a("./Dialog/RequestSender");c.prototype={update:function(a,b){this.state=d.STATUS_CONFIRMED,e("dialog "+this.id.toString()+"  changed to CONFIRMED state"),"UAC"===b&&(this.route_set=a.getHeaders("record-route").reverse())},terminate:function(){e("dialog "+this.id.toString()+" deleted"),delete this.owner.ua.dialogs[this.id.toString()]},createRequest:function(a,b,c){var d,e;return b=b&&b.slice()||[],this.local_seqnum||(this.local_seqnum=Math.floor(1e4*Math.random())),d=a===g.CANCEL||a===g.ACK?this.local_seqnum:this.local_seqnum+=1,e=new f.OutgoingRequest(a,this.remote_target,this.owner.ua,{cseq:d,call_id:this.id.call_id,from_uri:this.local_uri,from_tag:this.id.local_tag,to_uri:this.remote_uri,to_tag:this.id.remote_tag,route_set:this.route_set},b,c),e.dialog=this,e},checkInDialogRequest:function(a){var b=this;if(this.remote_seqnum){if(a.cseq<this.remote_seqnum)return a.method!==g.ACK&&a.reply(500),!1;a.cseq>this.remote_seqnum&&(this.remote_seqnum=a.cseq)}else this.remote_seqnum=a.cseq;if(a.method===g.INVITE||a.method===g.UPDATE&&a.body){if(this.uac_pending_reply===!0)a.reply(491);else{if(this.uas_pending_reply===!0){var c=(10*Math.random()|0)+1;return a.reply(500,null,["Retry-After:"+c]),!1}this.uas_pending_reply=!0,a.server_transaction.on("stateChanged",function d(){(this.state===h.C.STATUS_ACCEPTED||this.state===h.C.STATUS_COMPLETED||this.state===h.C.STATUS_TERMINATED)&&(a.server_transaction.removeListener("stateChanged",d),b.uas_pending_reply=!1,b.uac_pending_reply===!1&&b.owner.onReadyToReinvite())})}a.hasHeader("contact")&&a.server_transaction.on("stateChanged",function(){this.state===h.C.STATUS_ACCEPTED&&(b.remote_target=a.parseHeader("contact").uri)})}else a.method===g.NOTIFY&&a.hasHeader("contact")&&a.server_transaction.on("stateChanged",function(){this.state===h.C.STATUS_COMPLETED&&(b.remote_target=a.parseHeader("contact").uri)});return!0},sendRequest:function(a,b,c){c=c||{};var d=c.extraHeaders&&c.extraHeaders.slice()||[],e=c.body||null,f=this.createRequest(b,d,e),g=new i(this,a,f);g.send()},receiveRequest:function(a){this.checkInDialogRequest(a)&&this.owner.receiveRequest(a)}}},{"./Constants":15,"./Dialog/RequestSender":17,"./SIPMessage":31,"./Transactions":33,debug:1}],17:[function(a,b){function c(a,b,c){this.dialog=a,this.applicant=b,this.request=c,this.reattempt=!1,this.reattemptTimer=null}b.exports=c;var d=a("../Constants"),e=a("../Transactions"),f=a("../RTCSession"),g=a("../RequestSender");c.prototype={send:function(){var a=this,b=new g(this,this.dialog.owner.ua);b.send(),this.request.method===d.INVITE&&b.clientTransaction.state!==e.C.STATUS_TERMINATED&&(this.dialog.uac_pending_reply=!0,b.clientTransaction.on("stateChanged",function c(){(this.state===e.C.STATUS_ACCEPTED||this.state===e.C.STATUS_COMPLETED||this.state===e.C.STATUS_TERMINATED)&&(b.clientTransaction.removeListener("stateChanged",c),a.dialog.uac_pending_reply=!1,a.dialog.uas_pending_reply===!1&&a.dialog.owner.onReadyToReinvite())}))},onRequestTimeout:function(){this.applicant.onRequestTimeout()},onTransportError:function(){this.applicant.onTransportError()},receiveResponse:function(a){var b=this;408===a.status_code||481===a.status_code?this.applicant.onDialogError(a):a.method===d.INVITE&&491===a.status_code?this.reattempt?this.applicant.receiveResponse(a):(this.request.cseq.value=this.dialog.local_seqnum+=1,this.reattemptTimer=setTimeout(function(){b.applicant.owner.status!==f.C.STATUS_TERMINATED&&(b.reattempt=!0,b.request_sender.send())},this.getReattemptTimeout())):this.applicant.receiveResponse(a)}}},{"../Constants":15,"../RTCSession":25,"../RequestSender":30,"../Transactions":33}],18:[function(a,b){function c(a){this.username=a.configuration.authorization_user,this.password=a.configuration.password,this.cnonce=null,this.nc=0,this.ncHex="00000000",this.response=null}b.exports=c;var d=a("debug")("JsSIP:DigestAuthentication"),e=a("./Utils");c.prototype.authenticate=function(a,b){if(this.algorithm=b.algorithm,this.realm=b.realm,this.nonce=b.nonce,this.opaque=b.opaque,this.stale=b.stale,this.algorithm){if("MD5"!==this.algorithm)return d('challenge with Digest algorithm different than "MD5", authentication aborted'),!1}else this.algorithm="MD5";if(!this.realm)return d("challenge without Digest realm, authentication aborted"),!1;if(!this.nonce)return d("challenge without Digest nonce, authentication aborted"),!1;if(b.qop)if(b.qop.indexOf("auth")>-1)this.qop="auth";else{if(!(b.qop.indexOf("auth-int")>-1))return d('challenge without Digest qop different than "auth" or "auth-int", authentication aborted'),!1;this.qop="auth-int"}else this.qop=null;return this.method=a.method,this.uri=a.ruri,this.cnonce=e.createRandomToken(12),this.nc+=1,this.updateNcHex(),4294967296===this.nc&&(this.nc=1,this.ncHex="00000001"),this.calculateResponse(),!0},c.prototype.calculateResponse=function(){var a,b;a=e.calculateMD5(this.username+":"+this.realm+":"+this.password),"auth"===this.qop?(b=e.calculateMD5(this.method+":"+this.uri),this.response=e.calculateMD5(a+":"+this.nonce+":"+this.ncHex+":"+this.cnonce+":auth:"+b)):"auth-int"===this.qop?(b=e.calculateMD5(this.method+":"+this.uri+":"+e.calculateMD5(this.body?this.body:"")),this.response=e.calculateMD5(a+":"+this.nonce+":"+this.ncHex+":"+this.cnonce+":auth-int:"+b)):null===this.qop&&(b=e.calculateMD5(this.method+":"+this.uri),this.response=e.calculateMD5(a+":"+this.nonce+":"+b))
},c.prototype.toString=function(){var a=[];if(!this.response)throw new Error("response field does not exist, cannot generate Authorization header");return a.push("algorithm="+this.algorithm),a.push('username="'+this.username+'"'),a.push('realm="'+this.realm+'"'),a.push('nonce="'+this.nonce+'"'),a.push('uri="'+this.uri+'"'),a.push('response="'+this.response+'"'),this.opaque&&a.push('opaque="'+this.opaque+'"'),this.qop&&(a.push("qop="+this.qop),a.push('cnonce="'+this.cnonce+'"'),a.push("nc="+this.ncHex)),"Digest "+a.join(", ")},c.prototype.updateNcHex=function(){var a=Number(this.nc).toString(16);this.ncHex="00000000".substr(0,8-a.length)+a}},{"./Utils":37,debug:1}],19:[function(a,b){var c={ConfigurationError:function(){var a=function(a,b){this.code=1,this.name="CONFIGURATION_ERROR",this.parameter=a,this.value=b,this.message=this.value?"Invalid value "+JSON.stringify(this.value)+' for parameter "'+this.parameter+'"':"Missing parameter: "+this.parameter};return a.prototype=new Error,a}(),InvalidStateError:function(){var a=function(a){this.code=2,this.name="INVALID_STATE_ERROR",this.status=a,this.message="Invalid status: "+a};return a.prototype=new Error,a}(),NotSupportedError:function(){var a=function(a){this.code=3,this.name="NOT_SUPPORTED_ERROR",this.message=a};return a.prototype=new Error,a}(),NotReadyError:function(){var a=function(a){this.code=4,this.name="NOT_READY_ERROR",this.message=a};return a.prototype=new Error,a}()};b.exports=c},{}],20:[function(a,b){b.exports=function(){function b(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var c={parse:function(c,d){function e(a){le>je||(je>le&&(le=je,me=[]),me.push(a))}function f(){var a;return"\r\n"===c.substr(je,2)?(a="\r\n",je+=2):(a=null,0===ke&&e('"\\r\\n"')),a}function g(){var a;return/^[0-9]/.test(c.charAt(je))?(a=c.charAt(je),je++):(a=null,0===ke&&e("[0-9]")),a}function h(){var a;return/^[a-zA-Z]/.test(c.charAt(je))?(a=c.charAt(je),je++):(a=null,0===ke&&e("[a-zA-Z]")),a}function i(){var a;return/^[0-9a-fA-F]/.test(c.charAt(je))?(a=c.charAt(je),je++):(a=null,0===ke&&e("[0-9a-fA-F]")),a}function j(){var a;return a=m(),null===a&&(a=n()),a}function k(){var a;return/^[\0-\xFF]/.test(c.charAt(je))?(a=c.charAt(je),je++):(a=null,0===ke&&e("[\\0-\\xFF]")),a}function l(){var a;return/^["]/.test(c.charAt(je))?(a=c.charAt(je),je++):(a=null,0===ke&&e('["]')),a}function m(){var a;return 32===c.charCodeAt(je)?(a=" ",je++):(a=null,0===ke&&e('" "')),a}function n(){var a;return 9===c.charCodeAt(je)?(a="	",je++):(a=null,0===ke&&e('"\\t"')),a}function o(){var a;return/^[a-zA-Z0-9]/.test(c.charAt(je))?(a=c.charAt(je),je++):(a=null,0===ke&&e("[a-zA-Z0-9]")),a}function p(){var a;return 59===c.charCodeAt(je)?(a=";",je++):(a=null,0===ke&&e('";"')),null===a&&(47===c.charCodeAt(je)?(a="/",je++):(a=null,0===ke&&e('"/"')),null===a&&(63===c.charCodeAt(je)?(a="?",je++):(a=null,0===ke&&e('"?"')),null===a&&(58===c.charCodeAt(je)?(a=":",je++):(a=null,0===ke&&e('":"')),null===a&&(64===c.charCodeAt(je)?(a="@",je++):(a=null,0===ke&&e('"@"')),null===a&&(38===c.charCodeAt(je)?(a="&",je++):(a=null,0===ke&&e('"&"')),null===a&&(61===c.charCodeAt(je)?(a="=",je++):(a=null,0===ke&&e('"="')),null===a&&(43===c.charCodeAt(je)?(a="+",je++):(a=null,0===ke&&e('"+"')),null===a&&(36===c.charCodeAt(je)?(a="$",je++):(a=null,0===ke&&e('"$"')),null===a&&(44===c.charCodeAt(je)?(a=",",je++):(a=null,0===ke&&e('","'))))))))))),a}function q(){var a;return a=o(),null===a&&(a=r()),a}function r(){var a;return 45===c.charCodeAt(je)?(a="-",je++):(a=null,0===ke&&e('"-"')),null===a&&(95===c.charCodeAt(je)?(a="_",je++):(a=null,0===ke&&e('"_"')),null===a&&(46===c.charCodeAt(je)?(a=".",je++):(a=null,0===ke&&e('"."')),null===a&&(33===c.charCodeAt(je)?(a="!",je++):(a=null,0===ke&&e('"!"')),null===a&&(126===c.charCodeAt(je)?(a="~",je++):(a=null,0===ke&&e('"~"')),null===a&&(42===c.charCodeAt(je)?(a="*",je++):(a=null,0===ke&&e('"*"')),null===a&&(39===c.charCodeAt(je)?(a="'",je++):(a=null,0===ke&&e('"\'"')),null===a&&(40===c.charCodeAt(je)?(a="(",je++):(a=null,0===ke&&e('"("')),null===a&&(41===c.charCodeAt(je)?(a=")",je++):(a=null,0===ke&&e('")"')))))))))),a}function s(){var a,b,d,f,g;return f=je,g=je,37===c.charCodeAt(je)?(a="%",je++):(a=null,0===ke&&e('"%"')),null!==a?(b=i(),null!==b?(d=i(),null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(a,b){return b.join("")}(f,a)),null===a&&(je=f),a}function t(){var a,b,c,d,e,g;for(d=je,e=je,g=je,a=[],b=j();null!==b;)a.push(b),b=j();if(null!==a?(b=f(),null!==b?a=[a,b]:(a=null,je=g)):(a=null,je=g),a=null!==a?a:"",null!==a){if(c=j(),null!==c)for(b=[];null!==c;)b.push(c),c=j();else b=null;null!==b?a=[a,b]:(a=null,je=e)}else a=null,je=e;return null!==a&&(a=function(){return" "}(d)),null===a&&(je=d),a}function u(){var a;return a=t(),a=null!==a?a:""}function v(){var a,b,d,f,g;for(f=je,g=je,a=[],b=m(),null===b&&(b=n());null!==b;)a.push(b),b=m(),null===b&&(b=n());return null!==a?(58===c.charCodeAt(je)?(b=":",je++):(b=null,0===ke&&e('":"')),null!==b?(d=u(),null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(){return":"}(f)),null===a&&(je=f),a}function w(){var a,b,d,e,f,g,h;if(f=je,g=je,b=x(),null!==b)for(a=[];null!==b;)a.push(b),b=x();else a=null;if(null!==a){for(b=[],h=je,d=[],e=t();null!==e;)d.push(e),e=t();for(null!==d?(e=x(),null!==e?d=[d,e]:(d=null,je=h)):(d=null,je=h);null!==d;){for(b.push(d),h=je,d=[],e=t();null!==e;)d.push(e),e=t();null!==d?(e=x(),null!==e?d=[d,e]:(d=null,je=h)):(d=null,je=h)}null!==b?a=[a,b]:(a=null,je=g)}else a=null,je=g;return null!==a&&(a=function(a){return c.substring(je,a)}(f)),null===a&&(je=f),a}function x(){var a;return/^[!-~]/.test(c.charAt(je))?(a=c.charAt(je),je++):(a=null,0===ke&&e("[!-~]")),null===a&&(a=y()),a}function y(){var a;return/^[\x80-\uFFFF]/.test(c.charAt(je))?(a=c.charAt(je),je++):(a=null,0===ke&&e("[\\x80-\\uFFFF]")),a}function z(){var a;return/^[\x80-\xBF]/.test(c.charAt(je))?(a=c.charAt(je),je++):(a=null,0===ke&&e("[\\x80-\\xBF]")),a}function A(){var a;return a=g(),null===a&&(/^[a-f]/.test(c.charAt(je))?(a=c.charAt(je),je++):(a=null,0===ke&&e("[a-f]"))),a}function B(){var a,b,d;if(d=je,b=o(),null===b&&(45===c.charCodeAt(je)?(b="-",je++):(b=null,0===ke&&e('"-"')),null===b&&(46===c.charCodeAt(je)?(b=".",je++):(b=null,0===ke&&e('"."')),null===b&&(33===c.charCodeAt(je)?(b="!",je++):(b=null,0===ke&&e('"!"')),null===b&&(37===c.charCodeAt(je)?(b="%",je++):(b=null,0===ke&&e('"%"')),null===b&&(42===c.charCodeAt(je)?(b="*",je++):(b=null,0===ke&&e('"*"')),null===b&&(95===c.charCodeAt(je)?(b="_",je++):(b=null,0===ke&&e('"_"')),null===b&&(43===c.charCodeAt(je)?(b="+",je++):(b=null,0===ke&&e('"+"')),null===b&&(96===c.charCodeAt(je)?(b="`",je++):(b=null,0===ke&&e('"`"')),null===b&&(39===c.charCodeAt(je)?(b="'",je++):(b=null,0===ke&&e('"\'"')),null===b&&(126===c.charCodeAt(je)?(b="~",je++):(b=null,0===ke&&e('"~"')))))))))))),null!==b)for(a=[];null!==b;)a.push(b),b=o(),null===b&&(45===c.charCodeAt(je)?(b="-",je++):(b=null,0===ke&&e('"-"')),null===b&&(46===c.charCodeAt(je)?(b=".",je++):(b=null,0===ke&&e('"."')),null===b&&(33===c.charCodeAt(je)?(b="!",je++):(b=null,0===ke&&e('"!"')),null===b&&(37===c.charCodeAt(je)?(b="%",je++):(b=null,0===ke&&e('"%"')),null===b&&(42===c.charCodeAt(je)?(b="*",je++):(b=null,0===ke&&e('"*"')),null===b&&(95===c.charCodeAt(je)?(b="_",je++):(b=null,0===ke&&e('"_"')),null===b&&(43===c.charCodeAt(je)?(b="+",je++):(b=null,0===ke&&e('"+"')),null===b&&(96===c.charCodeAt(je)?(b="`",je++):(b=null,0===ke&&e('"`"')),null===b&&(39===c.charCodeAt(je)?(b="'",je++):(b=null,0===ke&&e('"\'"')),null===b&&(126===c.charCodeAt(je)?(b="~",je++):(b=null,0===ke&&e('"~"'))))))))))));else a=null;return null!==a&&(a=function(a){return c.substring(je,a)}(d)),null===a&&(je=d),a}function C(){var a,b,d;if(d=je,b=o(),null===b&&(45===c.charCodeAt(je)?(b="-",je++):(b=null,0===ke&&e('"-"')),null===b&&(33===c.charCodeAt(je)?(b="!",je++):(b=null,0===ke&&e('"!"')),null===b&&(37===c.charCodeAt(je)?(b="%",je++):(b=null,0===ke&&e('"%"')),null===b&&(42===c.charCodeAt(je)?(b="*",je++):(b=null,0===ke&&e('"*"')),null===b&&(95===c.charCodeAt(je)?(b="_",je++):(b=null,0===ke&&e('"_"')),null===b&&(43===c.charCodeAt(je)?(b="+",je++):(b=null,0===ke&&e('"+"')),null===b&&(96===c.charCodeAt(je)?(b="`",je++):(b=null,0===ke&&e('"`"')),null===b&&(39===c.charCodeAt(je)?(b="'",je++):(b=null,0===ke&&e('"\'"')),null===b&&(126===c.charCodeAt(je)?(b="~",je++):(b=null,0===ke&&e('"~"'))))))))))),null!==b)for(a=[];null!==b;)a.push(b),b=o(),null===b&&(45===c.charCodeAt(je)?(b="-",je++):(b=null,0===ke&&e('"-"')),null===b&&(33===c.charCodeAt(je)?(b="!",je++):(b=null,0===ke&&e('"!"')),null===b&&(37===c.charCodeAt(je)?(b="%",je++):(b=null,0===ke&&e('"%"')),null===b&&(42===c.charCodeAt(je)?(b="*",je++):(b=null,0===ke&&e('"*"')),null===b&&(95===c.charCodeAt(je)?(b="_",je++):(b=null,0===ke&&e('"_"')),null===b&&(43===c.charCodeAt(je)?(b="+",je++):(b=null,0===ke&&e('"+"')),null===b&&(96===c.charCodeAt(je)?(b="`",je++):(b=null,0===ke&&e('"`"')),null===b&&(39===c.charCodeAt(je)?(b="'",je++):(b=null,0===ke&&e('"\'"')),null===b&&(126===c.charCodeAt(je)?(b="~",je++):(b=null,0===ke&&e('"~"')))))))))));else a=null;return null!==a&&(a=function(a){return c.substring(je,a)}(d)),null===a&&(je=d),a}function D(){var a;return 40===c.charCodeAt(je)?(a="(",je++):(a=null,0===ke&&e('"("')),null===a&&(41===c.charCodeAt(je)?(a=")",je++):(a=null,0===ke&&e('")"')),null===a&&(60===c.charCodeAt(je)?(a="<",je++):(a=null,0===ke&&e('"<"')),null===a&&(62===c.charCodeAt(je)?(a=">",je++):(a=null,0===ke&&e('">"')),null===a&&(64===c.charCodeAt(je)?(a="@",je++):(a=null,0===ke&&e('"@"')),null===a&&(44===c.charCodeAt(je)?(a=",",je++):(a=null,0===ke&&e('","')),null===a&&(59===c.charCodeAt(je)?(a=";",je++):(a=null,0===ke&&e('";"')),null===a&&(58===c.charCodeAt(je)?(a=":",je++):(a=null,0===ke&&e('":"')),null===a&&(92===c.charCodeAt(je)?(a="\\",je++):(a=null,0===ke&&e('"\\\\"')),null===a&&(a=l(),null===a&&(47===c.charCodeAt(je)?(a="/",je++):(a=null,0===ke&&e('"/"')),null===a&&(91===c.charCodeAt(je)?(a="[",je++):(a=null,0===ke&&e('"["')),null===a&&(93===c.charCodeAt(je)?(a="]",je++):(a=null,0===ke&&e('"]"')),null===a&&(63===c.charCodeAt(je)?(a="?",je++):(a=null,0===ke&&e('"?"')),null===a&&(61===c.charCodeAt(je)?(a="=",je++):(a=null,0===ke&&e('"="')),null===a&&(123===c.charCodeAt(je)?(a="{",je++):(a=null,0===ke&&e('"{"')),null===a&&(125===c.charCodeAt(je)?(a="}",je++):(a=null,0===ke&&e('"}"')),null===a&&(a=m(),null===a&&(a=n())))))))))))))))))),a}function E(){var a,b,d;if(d=je,b=o(),null===b&&(45===c.charCodeAt(je)?(b="-",je++):(b=null,0===ke&&e('"-"')),null===b&&(46===c.charCodeAt(je)?(b=".",je++):(b=null,0===ke&&e('"."')),null===b&&(33===c.charCodeAt(je)?(b="!",je++):(b=null,0===ke&&e('"!"')),null===b&&(37===c.charCodeAt(je)?(b="%",je++):(b=null,0===ke&&e('"%"')),null===b&&(42===c.charCodeAt(je)?(b="*",je++):(b=null,0===ke&&e('"*"')),null===b&&(95===c.charCodeAt(je)?(b="_",je++):(b=null,0===ke&&e('"_"')),null===b&&(43===c.charCodeAt(je)?(b="+",je++):(b=null,0===ke&&e('"+"')),null===b&&(96===c.charCodeAt(je)?(b="`",je++):(b=null,0===ke&&e('"`"')),null===b&&(39===c.charCodeAt(je)?(b="'",je++):(b=null,0===ke&&e('"\'"')),null===b&&(126===c.charCodeAt(je)?(b="~",je++):(b=null,0===ke&&e('"~"')),null===b&&(40===c.charCodeAt(je)?(b="(",je++):(b=null,0===ke&&e('"("')),null===b&&(41===c.charCodeAt(je)?(b=")",je++):(b=null,0===ke&&e('")"')),null===b&&(60===c.charCodeAt(je)?(b="<",je++):(b=null,0===ke&&e('"<"')),null===b&&(62===c.charCodeAt(je)?(b=">",je++):(b=null,0===ke&&e('">"')),null===b&&(58===c.charCodeAt(je)?(b=":",je++):(b=null,0===ke&&e('":"')),null===b&&(92===c.charCodeAt(je)?(b="\\",je++):(b=null,0===ke&&e('"\\\\"')),null===b&&(b=l(),null===b&&(47===c.charCodeAt(je)?(b="/",je++):(b=null,0===ke&&e('"/"')),null===b&&(91===c.charCodeAt(je)?(b="[",je++):(b=null,0===ke&&e('"["')),null===b&&(93===c.charCodeAt(je)?(b="]",je++):(b=null,0===ke&&e('"]"')),null===b&&(63===c.charCodeAt(je)?(b="?",je++):(b=null,0===ke&&e('"?"')),null===b&&(123===c.charCodeAt(je)?(b="{",je++):(b=null,0===ke&&e('"{"')),null===b&&(125===c.charCodeAt(je)?(b="}",je++):(b=null,0===ke&&e('"}"'))))))))))))))))))))))))),null!==b)for(a=[];null!==b;)a.push(b),b=o(),null===b&&(45===c.charCodeAt(je)?(b="-",je++):(b=null,0===ke&&e('"-"')),null===b&&(46===c.charCodeAt(je)?(b=".",je++):(b=null,0===ke&&e('"."')),null===b&&(33===c.charCodeAt(je)?(b="!",je++):(b=null,0===ke&&e('"!"')),null===b&&(37===c.charCodeAt(je)?(b="%",je++):(b=null,0===ke&&e('"%"')),null===b&&(42===c.charCodeAt(je)?(b="*",je++):(b=null,0===ke&&e('"*"')),null===b&&(95===c.charCodeAt(je)?(b="_",je++):(b=null,0===ke&&e('"_"')),null===b&&(43===c.charCodeAt(je)?(b="+",je++):(b=null,0===ke&&e('"+"')),null===b&&(96===c.charCodeAt(je)?(b="`",je++):(b=null,0===ke&&e('"`"')),null===b&&(39===c.charCodeAt(je)?(b="'",je++):(b=null,0===ke&&e('"\'"')),null===b&&(126===c.charCodeAt(je)?(b="~",je++):(b=null,0===ke&&e('"~"')),null===b&&(40===c.charCodeAt(je)?(b="(",je++):(b=null,0===ke&&e('"("')),null===b&&(41===c.charCodeAt(je)?(b=")",je++):(b=null,0===ke&&e('")"')),null===b&&(60===c.charCodeAt(je)?(b="<",je++):(b=null,0===ke&&e('"<"')),null===b&&(62===c.charCodeAt(je)?(b=">",je++):(b=null,0===ke&&e('">"')),null===b&&(58===c.charCodeAt(je)?(b=":",je++):(b=null,0===ke&&e('":"')),null===b&&(92===c.charCodeAt(je)?(b="\\",je++):(b=null,0===ke&&e('"\\\\"')),null===b&&(b=l(),null===b&&(47===c.charCodeAt(je)?(b="/",je++):(b=null,0===ke&&e('"/"')),null===b&&(91===c.charCodeAt(je)?(b="[",je++):(b=null,0===ke&&e('"["')),null===b&&(93===c.charCodeAt(je)?(b="]",je++):(b=null,0===ke&&e('"]"')),null===b&&(63===c.charCodeAt(je)?(b="?",je++):(b=null,0===ke&&e('"?"')),null===b&&(123===c.charCodeAt(je)?(b="{",je++):(b=null,0===ke&&e('"{"')),null===b&&(125===c.charCodeAt(je)?(b="}",je++):(b=null,0===ke&&e('"}"')))))))))))))))))))))))));else a=null;return null!==a&&(a=function(a){return c.substring(je,a)}(d)),null===a&&(je=d),a}function F(){var a,b,d,f,g;return f=je,g=je,a=u(),null!==a?(42===c.charCodeAt(je)?(b="*",je++):(b=null,0===ke&&e('"*"')),null!==b?(d=u(),null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(){return"*"}(f)),null===a&&(je=f),a}function G(){var a,b,d,f,g;return f=je,g=je,a=u(),null!==a?(47===c.charCodeAt(je)?(b="/",je++):(b=null,0===ke&&e('"/"')),null!==b?(d=u(),null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(){return"/"}(f)),null===a&&(je=f),a}function H(){var a,b,d,f,g;return f=je,g=je,a=u(),null!==a?(61===c.charCodeAt(je)?(b="=",je++):(b=null,0===ke&&e('"="')),null!==b?(d=u(),null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(){return"="}(f)),null===a&&(je=f),a}function I(){var a,b,d,f,g;return f=je,g=je,a=u(),null!==a?(40===c.charCodeAt(je)?(b="(",je++):(b=null,0===ke&&e('"("')),null!==b?(d=u(),null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(){return"("}(f)),null===a&&(je=f),a}function J(){var a,b,d,f,g;return f=je,g=je,a=u(),null!==a?(41===c.charCodeAt(je)?(b=")",je++):(b=null,0===ke&&e('")"')),null!==b?(d=u(),null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(){return")"}(f)),null===a&&(je=f),a}function K(){var a,b,d,f;return d=je,f=je,62===c.charCodeAt(je)?(a=">",je++):(a=null,0===ke&&e('">"')),null!==a?(b=u(),null!==b?a=[a,b]:(a=null,je=f)):(a=null,je=f),null!==a&&(a=function(){return">"}(d)),null===a&&(je=d),a}function L(){var a,b,d,f;return d=je,f=je,a=u(),null!==a?(60===c.charCodeAt(je)?(b="<",je++):(b=null,0===ke&&e('"<"')),null!==b?a=[a,b]:(a=null,je=f)):(a=null,je=f),null!==a&&(a=function(){return"<"}(d)),null===a&&(je=d),a}function M(){var a,b,d,f,g;return f=je,g=je,a=u(),null!==a?(44===c.charCodeAt(je)?(b=",",je++):(b=null,0===ke&&e('","')),null!==b?(d=u(),null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(){return","}(f)),null===a&&(je=f),a}function N(){var a,b,d,f,g;return f=je,g=je,a=u(),null!==a?(59===c.charCodeAt(je)?(b=";",je++):(b=null,0===ke&&e('";"')),null!==b?(d=u(),null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(){return";"}(f)),null===a&&(je=f),a}function O(){var a,b,d,f,g;return f=je,g=je,a=u(),null!==a?(58===c.charCodeAt(je)?(b=":",je++):(b=null,0===ke&&e('":"')),null!==b?(d=u(),null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(){return":"}(f)),null===a&&(je=f),a}function P(){var a,b,c,d;return c=je,d=je,a=u(),null!==a?(b=l(),null!==b?a=[a,b]:(a=null,je=d)):(a=null,je=d),null!==a&&(a=function(){return'"'}(c)),null===a&&(je=c),a}function Q(){var a,b,c,d;return c=je,d=je,a=l(),null!==a?(b=u(),null!==b?a=[a,b]:(a=null,je=d)):(a=null,je=d),null!==a&&(a=function(){return'"'}(c)),null===a&&(je=c),a}function R(){var a,b,c,d;if(d=je,a=I(),null!==a){for(b=[],c=S(),null===c&&(c=W(),null===c&&(c=R()));null!==c;)b.push(c),c=S(),null===c&&(c=W(),null===c&&(c=R()));null!==b?(c=J(),null!==c?a=[a,b,c]:(a=null,je=d)):(a=null,je=d)}else a=null,je=d;return a}function S(){var a;return/^[!-']/.test(c.charAt(je))?(a=c.charAt(je),je++):(a=null,0===ke&&e("[!-']")),null===a&&(/^[*-[]/.test(c.charAt(je))?(a=c.charAt(je),je++):(a=null,0===ke&&e("[*-[]")),null===a&&(/^[\]-~]/.test(c.charAt(je))?(a=c.charAt(je),je++):(a=null,0===ke&&e("[\\]-~]")),null===a&&(a=y(),null===a&&(a=t())))),a}function T(){var a,b,d,e,f,g;if(f=je,g=je,a=u(),null!==a)if(b=l(),null!==b){for(d=[],e=V(),null===e&&(e=W());null!==e;)d.push(e),e=V(),null===e&&(e=W());null!==d?(e=l(),null!==e?a=[a,b,d,e]:(a=null,je=g)):(a=null,je=g)}else a=null,je=g;else a=null,je=g;return null!==a&&(a=function(a){return c.substring(je,a)}(f)),null===a&&(je=f),a}function U(){var a,b,d,e,f,g;if(f=je,g=je,a=u(),null!==a)if(b=l(),null!==b){for(d=[],e=V(),null===e&&(e=W());null!==e;)d.push(e),e=V(),null===e&&(e=W());null!==d?(e=l(),null!==e?a=[a,b,d,e]:(a=null,je=g)):(a=null,je=g)}else a=null,je=g;else a=null,je=g;return null!==a&&(a=function(a){return c.substring(je-1,a+1)}(f)),null===a&&(je=f),a}function V(){var a;return a=t(),null===a&&(33===c.charCodeAt(je)?(a="!",je++):(a=null,0===ke&&e('"!"')),null===a&&(/^[#-[]/.test(c.charAt(je))?(a=c.charAt(je),je++):(a=null,0===ke&&e("[#-[]")),null===a&&(/^[\]-~]/.test(c.charAt(je))?(a=c.charAt(je),je++):(a=null,0===ke&&e("[\\]-~]")),null===a&&(a=y())))),a}function W(){var a,b,d;return d=je,92===c.charCodeAt(je)?(a="\\",je++):(a=null,0===ke&&e('"\\\\"')),null!==a?(/^[\0-\t]/.test(c.charAt(je))?(b=c.charAt(je),je++):(b=null,0===ke&&e("[\\0-\\t]")),null===b&&(/^[\x0B-\f]/.test(c.charAt(je))?(b=c.charAt(je),je++):(b=null,0===ke&&e("[\\x0B-\\f]")),null===b&&(/^[\x0E-]/.test(c.charAt(je))?(b=c.charAt(je),je++):(b=null,0===ke&&e("[\\x0E-]")))),null!==b?a=[a,b]:(a=null,je=d)):(a=null,je=d),a}function X(){var a,b,d,f,g,h;return g=je,h=je,a=Z(),null!==a?(58===c.charCodeAt(je)?(b=":",je++):(b=null,0===ke&&e('":"')),null!==b?(d=$(),d=null!==d?d:"",null!==d?(f=cb(),null!==f?a=[a,b,d,f]:(a=null,je=h)):(a=null,je=h)):(a=null,je=h)):(a=null,je=h),null!==a&&(a=function(){try{pe.uri=new ne(pe.scheme,pe.user,pe.host,pe.port),delete pe.scheme,delete pe.user,delete pe.host,delete pe.host_type,delete pe.port}catch(a){pe=-1}}(g)),null===a&&(je=g),a}function Y(){var a,b,f,g,h,i,j,k;return j=je,k=je,a=Z(),null!==a?(58===c.charCodeAt(je)?(b=":",je++):(b=null,0===ke&&e('":"')),null!==b?(f=$(),f=null!==f?f:"",null!==f?(g=cb(),null!==g?(h=ob(),null!==h?(i=Bb(),i=null!==i?i:"",null!==i?a=[a,b,f,g,h,i]:(a=null,je=k)):(a=null,je=k)):(a=null,je=k)):(a=null,je=k)):(a=null,je=k)):(a=null,je=k),null!==a&&(a=function(){try{pe.uri=new ne(pe.scheme,pe.user,pe.host,pe.port,pe.uri_params,pe.uri_headers),delete pe.scheme,delete pe.user,delete pe.host,delete pe.host_type,delete pe.port,delete pe.uri_params,"SIP_URI"===d&&(pe=pe.uri)}catch(a){pe=-1}}(j)),null===a&&(je=j),a}function Z(){var a,b;return"sip"===c.substr(je,3).toLowerCase()?(a=c.substr(je,3),je+=3):(a=null,0===ke&&e('"sip"')),null===a&&(b=je,"sips"===c.substr(je,4).toLowerCase()?(a=c.substr(je,4),je+=4):(a=null,0===ke&&e('"sips"')),null!==a&&(a=function(){pe.scheme=uri_scheme.toLowerCase()}(b)),null===a&&(je=b)),a}function $(){var a,b,d,f,g,h;return f=je,g=je,a=_(),null!==a?(h=je,58===c.charCodeAt(je)?(b=":",je++):(b=null,0===ke&&e('":"')),null!==b?(d=bb(),null!==d?b=[b,d]:(b=null,je=h)):(b=null,je=h),b=null!==b?b:"",null!==b?(64===c.charCodeAt(je)?(d="@",je++):(d=null,0===ke&&e('"@"')),null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(a){pe.user=decodeURIComponent(c.substring(je-1,a))}(f)),null===a&&(je=f),a}function _(){var a,b;if(b=q(),null===b&&(b=s(),null===b&&(b=ab())),null!==b)for(a=[];null!==b;)a.push(b),b=q(),null===b&&(b=s(),null===b&&(b=ab()));else a=null;return a}function ab(){var a;return 38===c.charCodeAt(je)?(a="&",je++):(a=null,0===ke&&e('"&"')),null===a&&(61===c.charCodeAt(je)?(a="=",je++):(a=null,0===ke&&e('"="')),null===a&&(43===c.charCodeAt(je)?(a="+",je++):(a=null,0===ke&&e('"+"')),null===a&&(36===c.charCodeAt(je)?(a="$",je++):(a=null,0===ke&&e('"$"')),null===a&&(44===c.charCodeAt(je)?(a=",",je++):(a=null,0===ke&&e('","')),null===a&&(59===c.charCodeAt(je)?(a=";",je++):(a=null,0===ke&&e('";"')),null===a&&(63===c.charCodeAt(je)?(a="?",je++):(a=null,0===ke&&e('"?"')),null===a&&(47===c.charCodeAt(je)?(a="/",je++):(a=null,0===ke&&e('"/"'))))))))),a}function bb(){var a,b,d;for(d=je,a=[],b=q(),null===b&&(b=s(),null===b&&(38===c.charCodeAt(je)?(b="&",je++):(b=null,0===ke&&e('"&"')),null===b&&(61===c.charCodeAt(je)?(b="=",je++):(b=null,0===ke&&e('"="')),null===b&&(43===c.charCodeAt(je)?(b="+",je++):(b=null,0===ke&&e('"+"')),null===b&&(36===c.charCodeAt(je)?(b="$",je++):(b=null,0===ke&&e('"$"')),null===b&&(44===c.charCodeAt(je)?(b=",",je++):(b=null,0===ke&&e('","'))))))));null!==b;)a.push(b),b=q(),null===b&&(b=s(),null===b&&(38===c.charCodeAt(je)?(b="&",je++):(b=null,0===ke&&e('"&"')),null===b&&(61===c.charCodeAt(je)?(b="=",je++):(b=null,0===ke&&e('"="')),null===b&&(43===c.charCodeAt(je)?(b="+",je++):(b=null,0===ke&&e('"+"')),null===b&&(36===c.charCodeAt(je)?(b="$",je++):(b=null,0===ke&&e('"$"')),null===b&&(44===c.charCodeAt(je)?(b=",",je++):(b=null,0===ke&&e('","'))))))));return null!==a&&(a=function(a){pe.password=c.substring(je,a)}(d)),null===a&&(je=d),a}function cb(){var a,b,d,f,g;return f=je,a=db(),null!==a?(g=je,58===c.charCodeAt(je)?(b=":",je++):(b=null,0===ke&&e('":"')),null!==b?(d=nb(),null!==d?b=[b,d]:(b=null,je=g)):(b=null,je=g),b=null!==b?b:"",null!==b?a=[a,b]:(a=null,je=f)):(a=null,je=f),a}function db(){var a,b;return b=je,a=lb(),null===a&&(a=hb(),null===a&&(a=eb())),null!==a&&(a=function(a){return pe.host=c.substring(je,a).toLowerCase(),pe.host}(b)),null===a&&(je=b),a}function eb(){var a,b,d,f,g,h;for(f=je,g=je,a=[],h=je,b=fb(),null!==b?(46===c.charCodeAt(je)?(d=".",je++):(d=null,0===ke&&e('"."')),null!==d?b=[b,d]:(b=null,je=h)):(b=null,je=h);null!==b;)a.push(b),h=je,b=fb(),null!==b?(46===c.charCodeAt(je)?(d=".",je++):(d=null,0===ke&&e('"."')),null!==d?b=[b,d]:(b=null,je=h)):(b=null,je=h);return null!==a?(b=gb(),null!==b?(46===c.charCodeAt(je)?(d=".",je++):(d=null,0===ke&&e('"."')),d=null!==d?d:"",null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(a){return pe.host_type="domain",c.substring(je,a)}(f)),null===a&&(je=f),a}function fb(){var a,b;if(/^[a-zA-Z0-9_\-]/.test(c.charAt(je))?(b=c.charAt(je),je++):(b=null,0===ke&&e("[a-zA-Z0-9_\\-]")),null!==b)for(a=[];null!==b;)a.push(b),/^[a-zA-Z0-9_\-]/.test(c.charAt(je))?(b=c.charAt(je),je++):(b=null,0===ke&&e("[a-zA-Z0-9_\\-]"));else a=null;return a}function gb(){var a,b;if(/^[a-zA-Z0-9_\-]/.test(c.charAt(je))?(b=c.charAt(je),je++):(b=null,0===ke&&e("[a-zA-Z0-9_\\-]")),null!==b)for(a=[];null!==b;)a.push(b),/^[a-zA-Z0-9_\-]/.test(c.charAt(je))?(b=c.charAt(je),je++):(b=null,0===ke&&e("[a-zA-Z0-9_\\-]"));else a=null;return a}function hb(){var a,b,d,f,g;return f=je,g=je,91===c.charCodeAt(je)?(a="[",je++):(a=null,0===ke&&e('"["')),null!==a?(b=ib(),null!==b?(93===c.charCodeAt(je)?(d="]",je++):(d=null,0===ke&&e('"]"')),null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(a){return pe.host_type="IPv6",c.substring(je,a)}(f)),null===a&&(je=f),a}function ib(){var a,b,d,f,g,h,i,j,k,l,m,n,o,p,q,r;return p=je,q=je,a=jb(),null!==a?(58===c.charCodeAt(je)?(b=":",je++):(b=null,0===ke&&e('":"')),null!==b?(d=jb(),null!==d?(58===c.charCodeAt(je)?(f=":",je++):(f=null,0===ke&&e('":"')),null!==f?(g=jb(),null!==g?(58===c.charCodeAt(je)?(h=":",je++):(h=null,0===ke&&e('":"')),null!==h?(i=jb(),null!==i?(58===c.charCodeAt(je)?(j=":",je++):(j=null,0===ke&&e('":"')),null!==j?(k=jb(),null!==k?(58===c.charCodeAt(je)?(l=":",je++):(l=null,0===ke&&e('":"')),null!==l?(m=jb(),null!==m?(58===c.charCodeAt(je)?(n=":",je++):(n=null,0===ke&&e('":"')),null!==n?(o=kb(),null!==o?a=[a,b,d,f,g,h,i,j,k,l,m,n,o]:(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q),null===a&&(q=je,"::"===c.substr(je,2)?(a="::",je+=2):(a=null,0===ke&&e('"::"')),null!==a?(b=jb(),null!==b?(58===c.charCodeAt(je)?(d=":",je++):(d=null,0===ke&&e('":"')),null!==d?(f=jb(),null!==f?(58===c.charCodeAt(je)?(g=":",je++):(g=null,0===ke&&e('":"')),null!==g?(h=jb(),null!==h?(58===c.charCodeAt(je)?(i=":",je++):(i=null,0===ke&&e('":"')),null!==i?(j=jb(),null!==j?(58===c.charCodeAt(je)?(k=":",je++):(k=null,0===ke&&e('":"')),null!==k?(l=jb(),null!==l?(58===c.charCodeAt(je)?(m=":",je++):(m=null,0===ke&&e('":"')),null!==m?(n=kb(),null!==n?a=[a,b,d,f,g,h,i,j,k,l,m,n]:(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q),null===a&&(q=je,"::"===c.substr(je,2)?(a="::",je+=2):(a=null,0===ke&&e('"::"')),null!==a?(b=jb(),null!==b?(58===c.charCodeAt(je)?(d=":",je++):(d=null,0===ke&&e('":"')),null!==d?(f=jb(),null!==f?(58===c.charCodeAt(je)?(g=":",je++):(g=null,0===ke&&e('":"')),null!==g?(h=jb(),null!==h?(58===c.charCodeAt(je)?(i=":",je++):(i=null,0===ke&&e('":"')),null!==i?(j=jb(),null!==j?(58===c.charCodeAt(je)?(k=":",je++):(k=null,0===ke&&e('":"')),null!==k?(l=kb(),null!==l?a=[a,b,d,f,g,h,i,j,k,l]:(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q),null===a&&(q=je,"::"===c.substr(je,2)?(a="::",je+=2):(a=null,0===ke&&e('"::"')),null!==a?(b=jb(),null!==b?(58===c.charCodeAt(je)?(d=":",je++):(d=null,0===ke&&e('":"')),null!==d?(f=jb(),null!==f?(58===c.charCodeAt(je)?(g=":",je++):(g=null,0===ke&&e('":"')),null!==g?(h=jb(),null!==h?(58===c.charCodeAt(je)?(i=":",je++):(i=null,0===ke&&e('":"')),null!==i?(j=kb(),null!==j?a=[a,b,d,f,g,h,i,j]:(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q),null===a&&(q=je,"::"===c.substr(je,2)?(a="::",je+=2):(a=null,0===ke&&e('"::"')),null!==a?(b=jb(),null!==b?(58===c.charCodeAt(je)?(d=":",je++):(d=null,0===ke&&e('":"')),null!==d?(f=jb(),null!==f?(58===c.charCodeAt(je)?(g=":",je++):(g=null,0===ke&&e('":"')),null!==g?(h=kb(),null!==h?a=[a,b,d,f,g,h]:(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q),null===a&&(q=je,"::"===c.substr(je,2)?(a="::",je+=2):(a=null,0===ke&&e('"::"')),null!==a?(b=jb(),null!==b?(58===c.charCodeAt(je)?(d=":",je++):(d=null,0===ke&&e('":"')),null!==d?(f=kb(),null!==f?a=[a,b,d,f]:(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q),null===a&&(q=je,"::"===c.substr(je,2)?(a="::",je+=2):(a=null,0===ke&&e('"::"')),null!==a?(b=kb(),null!==b?a=[a,b]:(a=null,je=q)):(a=null,je=q),null===a&&(q=je,"::"===c.substr(je,2)?(a="::",je+=2):(a=null,0===ke&&e('"::"')),null!==a?(b=jb(),null!==b?a=[a,b]:(a=null,je=q)):(a=null,je=q),null===a&&(q=je,a=jb(),null!==a?("::"===c.substr(je,2)?(b="::",je+=2):(b=null,0===ke&&e('"::"')),null!==b?(d=jb(),null!==d?(58===c.charCodeAt(je)?(f=":",je++):(f=null,0===ke&&e('":"')),null!==f?(g=jb(),null!==g?(58===c.charCodeAt(je)?(h=":",je++):(h=null,0===ke&&e('":"')),null!==h?(i=jb(),null!==i?(58===c.charCodeAt(je)?(j=":",je++):(j=null,0===ke&&e('":"')),null!==j?(k=jb(),null!==k?(58===c.charCodeAt(je)?(l=":",je++):(l=null,0===ke&&e('":"')),null!==l?(m=kb(),null!==m?a=[a,b,d,f,g,h,i,j,k,l,m]:(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q),null===a&&(q=je,a=jb(),null!==a?(r=je,58===c.charCodeAt(je)?(b=":",je++):(b=null,0===ke&&e('":"')),null!==b?(d=jb(),null!==d?b=[b,d]:(b=null,je=r)):(b=null,je=r),b=null!==b?b:"",null!==b?("::"===c.substr(je,2)?(d="::",je+=2):(d=null,0===ke&&e('"::"')),null!==d?(f=jb(),null!==f?(58===c.charCodeAt(je)?(g=":",je++):(g=null,0===ke&&e('":"')),null!==g?(h=jb(),null!==h?(58===c.charCodeAt(je)?(i=":",je++):(i=null,0===ke&&e('":"')),null!==i?(j=jb(),null!==j?(58===c.charCodeAt(je)?(k=":",je++):(k=null,0===ke&&e('":"')),null!==k?(l=kb(),null!==l?a=[a,b,d,f,g,h,i,j,k,l]:(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q),null===a&&(q=je,a=jb(),null!==a?(r=je,58===c.charCodeAt(je)?(b=":",je++):(b=null,0===ke&&e('":"')),null!==b?(d=jb(),null!==d?b=[b,d]:(b=null,je=r)):(b=null,je=r),b=null!==b?b:"",null!==b?(r=je,58===c.charCodeAt(je)?(d=":",je++):(d=null,0===ke&&e('":"')),null!==d?(f=jb(),null!==f?d=[d,f]:(d=null,je=r)):(d=null,je=r),d=null!==d?d:"",null!==d?("::"===c.substr(je,2)?(f="::",je+=2):(f=null,0===ke&&e('"::"')),null!==f?(g=jb(),null!==g?(58===c.charCodeAt(je)?(h=":",je++):(h=null,0===ke&&e('":"')),null!==h?(i=jb(),null!==i?(58===c.charCodeAt(je)?(j=":",je++):(j=null,0===ke&&e('":"')),null!==j?(k=kb(),null!==k?a=[a,b,d,f,g,h,i,j,k]:(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q),null===a&&(q=je,a=jb(),null!==a?(r=je,58===c.charCodeAt(je)?(b=":",je++):(b=null,0===ke&&e('":"')),null!==b?(d=jb(),null!==d?b=[b,d]:(b=null,je=r)):(b=null,je=r),b=null!==b?b:"",null!==b?(r=je,58===c.charCodeAt(je)?(d=":",je++):(d=null,0===ke&&e('":"')),null!==d?(f=jb(),null!==f?d=[d,f]:(d=null,je=r)):(d=null,je=r),d=null!==d?d:"",null!==d?(r=je,58===c.charCodeAt(je)?(f=":",je++):(f=null,0===ke&&e('":"')),null!==f?(g=jb(),null!==g?f=[f,g]:(f=null,je=r)):(f=null,je=r),f=null!==f?f:"",null!==f?("::"===c.substr(je,2)?(g="::",je+=2):(g=null,0===ke&&e('"::"')),null!==g?(h=jb(),null!==h?(58===c.charCodeAt(je)?(i=":",je++):(i=null,0===ke&&e('":"')),null!==i?(j=kb(),null!==j?a=[a,b,d,f,g,h,i,j]:(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q),null===a&&(q=je,a=jb(),null!==a?(r=je,58===c.charCodeAt(je)?(b=":",je++):(b=null,0===ke&&e('":"')),null!==b?(d=jb(),null!==d?b=[b,d]:(b=null,je=r)):(b=null,je=r),b=null!==b?b:"",null!==b?(r=je,58===c.charCodeAt(je)?(d=":",je++):(d=null,0===ke&&e('":"')),null!==d?(f=jb(),null!==f?d=[d,f]:(d=null,je=r)):(d=null,je=r),d=null!==d?d:"",null!==d?(r=je,58===c.charCodeAt(je)?(f=":",je++):(f=null,0===ke&&e('":"')),null!==f?(g=jb(),null!==g?f=[f,g]:(f=null,je=r)):(f=null,je=r),f=null!==f?f:"",null!==f?(r=je,58===c.charCodeAt(je)?(g=":",je++):(g=null,0===ke&&e('":"')),null!==g?(h=jb(),null!==h?g=[g,h]:(g=null,je=r)):(g=null,je=r),g=null!==g?g:"",null!==g?("::"===c.substr(je,2)?(h="::",je+=2):(h=null,0===ke&&e('"::"')),null!==h?(i=kb(),null!==i?a=[a,b,d,f,g,h,i]:(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q),null===a&&(q=je,a=jb(),null!==a?(r=je,58===c.charCodeAt(je)?(b=":",je++):(b=null,0===ke&&e('":"')),null!==b?(d=jb(),null!==d?b=[b,d]:(b=null,je=r)):(b=null,je=r),b=null!==b?b:"",null!==b?(r=je,58===c.charCodeAt(je)?(d=":",je++):(d=null,0===ke&&e('":"')),null!==d?(f=jb(),null!==f?d=[d,f]:(d=null,je=r)):(d=null,je=r),d=null!==d?d:"",null!==d?(r=je,58===c.charCodeAt(je)?(f=":",je++):(f=null,0===ke&&e('":"')),null!==f?(g=jb(),null!==g?f=[f,g]:(f=null,je=r)):(f=null,je=r),f=null!==f?f:"",null!==f?(r=je,58===c.charCodeAt(je)?(g=":",je++):(g=null,0===ke&&e('":"')),null!==g?(h=jb(),null!==h?g=[g,h]:(g=null,je=r)):(g=null,je=r),g=null!==g?g:"",null!==g?(r=je,58===c.charCodeAt(je)?(h=":",je++):(h=null,0===ke&&e('":"')),null!==h?(i=jb(),null!==i?h=[h,i]:(h=null,je=r)):(h=null,je=r),h=null!==h?h:"",null!==h?("::"===c.substr(je,2)?(i="::",je+=2):(i=null,0===ke&&e('"::"')),null!==i?(j=jb(),null!==j?a=[a,b,d,f,g,h,i,j]:(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q),null===a&&(q=je,a=jb(),null!==a?(r=je,58===c.charCodeAt(je)?(b=":",je++):(b=null,0===ke&&e('":"')),null!==b?(d=jb(),null!==d?b=[b,d]:(b=null,je=r)):(b=null,je=r),b=null!==b?b:"",null!==b?(r=je,58===c.charCodeAt(je)?(d=":",je++):(d=null,0===ke&&e('":"')),null!==d?(f=jb(),null!==f?d=[d,f]:(d=null,je=r)):(d=null,je=r),d=null!==d?d:"",null!==d?(r=je,58===c.charCodeAt(je)?(f=":",je++):(f=null,0===ke&&e('":"')),null!==f?(g=jb(),null!==g?f=[f,g]:(f=null,je=r)):(f=null,je=r),f=null!==f?f:"",null!==f?(r=je,58===c.charCodeAt(je)?(g=":",je++):(g=null,0===ke&&e('":"')),null!==g?(h=jb(),null!==h?g=[g,h]:(g=null,je=r)):(g=null,je=r),g=null!==g?g:"",null!==g?(r=je,58===c.charCodeAt(je)?(h=":",je++):(h=null,0===ke&&e('":"')),null!==h?(i=jb(),null!==i?h=[h,i]:(h=null,je=r)):(h=null,je=r),h=null!==h?h:"",null!==h?(r=je,58===c.charCodeAt(je)?(i=":",je++):(i=null,0===ke&&e('":"')),null!==i?(j=jb(),null!==j?i=[i,j]:(i=null,je=r)):(i=null,je=r),i=null!==i?i:"",null!==i?("::"===c.substr(je,2)?(j="::",je+=2):(j=null,0===ke&&e('"::"')),null!==j?a=[a,b,d,f,g,h,i,j]:(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q)):(a=null,je=q))))))))))))))),null!==a&&(a=function(a){return pe.host_type="IPv6",c.substring(je,a)
}(p)),null===a&&(je=p),a}function jb(){var a,b,c,d,e;return e=je,a=i(),null!==a?(b=i(),b=null!==b?b:"",null!==b?(c=i(),c=null!==c?c:"",null!==c?(d=i(),d=null!==d?d:"",null!==d?a=[a,b,c,d]:(a=null,je=e)):(a=null,je=e)):(a=null,je=e)):(a=null,je=e),a}function kb(){var a,b,d,f;return f=je,a=jb(),null!==a?(58===c.charCodeAt(je)?(b=":",je++):(b=null,0===ke&&e('":"')),null!==b?(d=jb(),null!==d?a=[a,b,d]:(a=null,je=f)):(a=null,je=f)):(a=null,je=f),null===a&&(a=lb()),a}function lb(){var a,b,d,f,g,h,i,j,k;return j=je,k=je,a=mb(),null!==a?(46===c.charCodeAt(je)?(b=".",je++):(b=null,0===ke&&e('"."')),null!==b?(d=mb(),null!==d?(46===c.charCodeAt(je)?(f=".",je++):(f=null,0===ke&&e('"."')),null!==f?(g=mb(),null!==g?(46===c.charCodeAt(je)?(h=".",je++):(h=null,0===ke&&e('"."')),null!==h?(i=mb(),null!==i?a=[a,b,d,f,g,h,i]:(a=null,je=k)):(a=null,je=k)):(a=null,je=k)):(a=null,je=k)):(a=null,je=k)):(a=null,je=k)):(a=null,je=k),null!==a&&(a=function(a){return pe.host_type="IPv4",c.substring(je,a)}(j)),null===a&&(je=j),a}function mb(){var a,b,d,f;return f=je,"25"===c.substr(je,2)?(a="25",je+=2):(a=null,0===ke&&e('"25"')),null!==a?(/^[0-5]/.test(c.charAt(je))?(b=c.charAt(je),je++):(b=null,0===ke&&e("[0-5]")),null!==b?a=[a,b]:(a=null,je=f)):(a=null,je=f),null===a&&(f=je,50===c.charCodeAt(je)?(a="2",je++):(a=null,0===ke&&e('"2"')),null!==a?(/^[0-4]/.test(c.charAt(je))?(b=c.charAt(je),je++):(b=null,0===ke&&e("[0-4]")),null!==b?(d=g(),null!==d?a=[a,b,d]:(a=null,je=f)):(a=null,je=f)):(a=null,je=f),null===a&&(f=je,49===c.charCodeAt(je)?(a="1",je++):(a=null,0===ke&&e('"1"')),null!==a?(b=g(),null!==b?(d=g(),null!==d?a=[a,b,d]:(a=null,je=f)):(a=null,je=f)):(a=null,je=f),null===a&&(f=je,/^[1-9]/.test(c.charAt(je))?(a=c.charAt(je),je++):(a=null,0===ke&&e("[1-9]")),null!==a?(b=g(),null!==b?a=[a,b]:(a=null,je=f)):(a=null,je=f),null===a&&(a=g())))),a}function nb(){var a,b,c,d,e,f,h;return f=je,h=je,a=g(),a=null!==a?a:"",null!==a?(b=g(),b=null!==b?b:"",null!==b?(c=g(),c=null!==c?c:"",null!==c?(d=g(),d=null!==d?d:"",null!==d?(e=g(),e=null!==e?e:"",null!==e?a=[a,b,c,d,e]:(a=null,je=h)):(a=null,je=h)):(a=null,je=h)):(a=null,je=h)):(a=null,je=h),null!==a&&(a=function(a,b){return b=parseInt(b.join("")),pe.port=b,b}(f,a)),null===a&&(je=f),a}function ob(){var a,b,d,f;for(a=[],f=je,59===c.charCodeAt(je)?(b=";",je++):(b=null,0===ke&&e('";"')),null!==b?(d=pb(),null!==d?b=[b,d]:(b=null,je=f)):(b=null,je=f);null!==b;)a.push(b),f=je,59===c.charCodeAt(je)?(b=";",je++):(b=null,0===ke&&e('";"')),null!==b?(d=pb(),null!==d?b=[b,d]:(b=null,je=f)):(b=null,je=f);return a}function pb(){var a;return a=qb(),null===a&&(a=rb(),null===a&&(a=sb(),null===a&&(a=tb(),null===a&&(a=ub(),null===a&&(a=vb(),null===a&&(a=wb())))))),a}function qb(){var a,b,d,f;return d=je,f=je,"transport="===c.substr(je,10).toLowerCase()?(a=c.substr(je,10),je+=10):(a=null,0===ke&&e('"transport="')),null!==a?("udp"===c.substr(je,3).toLowerCase()?(b=c.substr(je,3),je+=3):(b=null,0===ke&&e('"udp"')),null===b&&("tcp"===c.substr(je,3).toLowerCase()?(b=c.substr(je,3),je+=3):(b=null,0===ke&&e('"tcp"')),null===b&&("sctp"===c.substr(je,4).toLowerCase()?(b=c.substr(je,4),je+=4):(b=null,0===ke&&e('"sctp"')),null===b&&("tls"===c.substr(je,3).toLowerCase()?(b=c.substr(je,3),je+=3):(b=null,0===ke&&e('"tls"')),null===b&&(b=B())))),null!==b?a=[a,b]:(a=null,je=f)):(a=null,je=f),null!==a&&(a=function(a,b){pe.uri_params||(pe.uri_params={}),pe.uri_params.transport=b.toLowerCase()}(d,a[1])),null===a&&(je=d),a}function rb(){var a,b,d,f;return d=je,f=je,"user="===c.substr(je,5).toLowerCase()?(a=c.substr(je,5),je+=5):(a=null,0===ke&&e('"user="')),null!==a?("phone"===c.substr(je,5).toLowerCase()?(b=c.substr(je,5),je+=5):(b=null,0===ke&&e('"phone"')),null===b&&("ip"===c.substr(je,2).toLowerCase()?(b=c.substr(je,2),je+=2):(b=null,0===ke&&e('"ip"')),null===b&&(b=B())),null!==b?a=[a,b]:(a=null,je=f)):(a=null,je=f),null!==a&&(a=function(a,b){pe.uri_params||(pe.uri_params={}),pe.uri_params.user=b.toLowerCase()}(d,a[1])),null===a&&(je=d),a}function sb(){var a,b,d,f;return d=je,f=je,"method="===c.substr(je,7).toLowerCase()?(a=c.substr(je,7),je+=7):(a=null,0===ke&&e('"method="')),null!==a?(b=gc(),null!==b?a=[a,b]:(a=null,je=f)):(a=null,je=f),null!==a&&(a=function(a,b){pe.uri_params||(pe.uri_params={}),pe.uri_params.method=b}(d,a[1])),null===a&&(je=d),a}function tb(){var a,b,d,f;return d=je,f=je,"ttl="===c.substr(je,4).toLowerCase()?(a=c.substr(je,4),je+=4):(a=null,0===ke&&e('"ttl="')),null!==a?(b=Pd(),null!==b?a=[a,b]:(a=null,je=f)):(a=null,je=f),null!==a&&(a=function(a,b){pe.params||(pe.params={}),pe.params.ttl=b}(d,a[1])),null===a&&(je=d),a}function ub(){var a,b,d,f;return d=je,f=je,"maddr="===c.substr(je,6).toLowerCase()?(a=c.substr(je,6),je+=6):(a=null,0===ke&&e('"maddr="')),null!==a?(b=db(),null!==b?a=[a,b]:(a=null,je=f)):(a=null,je=f),null!==a&&(a=function(a,b){pe.uri_params||(pe.uri_params={}),pe.uri_params.maddr=b}(d,a[1])),null===a&&(je=d),a}function vb(){var a,b,d,f,g,h;return f=je,g=je,"lr"===c.substr(je,2).toLowerCase()?(a=c.substr(je,2),je+=2):(a=null,0===ke&&e('"lr"')),null!==a?(h=je,61===c.charCodeAt(je)?(b="=",je++):(b=null,0===ke&&e('"="')),null!==b?(d=B(),null!==d?b=[b,d]:(b=null,je=h)):(b=null,je=h),b=null!==b?b:"",null!==b?a=[a,b]:(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(){pe.uri_params||(pe.uri_params={}),pe.uri_params.lr=void 0}(f)),null===a&&(je=f),a}function wb(){var a,b,d,f,g,h;return f=je,g=je,a=xb(),null!==a?(h=je,61===c.charCodeAt(je)?(b="=",je++):(b=null,0===ke&&e('"="')),null!==b?(d=yb(),null!==d?b=[b,d]:(b=null,je=h)):(b=null,je=h),b=null!==b?b:"",null!==b?a=[a,b]:(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(a,b,c){pe.uri_params||(pe.uri_params={}),c="undefined"==typeof c?void 0:c[1],pe.uri_params[b.toLowerCase()]=c&&c.toLowerCase()}(f,a[0],a[1])),null===a&&(je=f),a}function xb(){var a,b,c;if(c=je,b=zb(),null!==b)for(a=[];null!==b;)a.push(b),b=zb();else a=null;return null!==a&&(a=function(a,b){return b.join("")}(c,a)),null===a&&(je=c),a}function yb(){var a,b,c;if(c=je,b=zb(),null!==b)for(a=[];null!==b;)a.push(b),b=zb();else a=null;return null!==a&&(a=function(a,b){return b.join("")}(c,a)),null===a&&(je=c),a}function zb(){var a;return a=Ab(),null===a&&(a=q(),null===a&&(a=s())),a}function Ab(){var a;return 91===c.charCodeAt(je)?(a="[",je++):(a=null,0===ke&&e('"["')),null===a&&(93===c.charCodeAt(je)?(a="]",je++):(a=null,0===ke&&e('"]"')),null===a&&(47===c.charCodeAt(je)?(a="/",je++):(a=null,0===ke&&e('"/"')),null===a&&(58===c.charCodeAt(je)?(a=":",je++):(a=null,0===ke&&e('":"')),null===a&&(38===c.charCodeAt(je)?(a="&",je++):(a=null,0===ke&&e('"&"')),null===a&&(43===c.charCodeAt(je)?(a="+",je++):(a=null,0===ke&&e('"+"')),null===a&&(36===c.charCodeAt(je)?(a="$",je++):(a=null,0===ke&&e('"$"')))))))),a}function Bb(){var a,b,d,f,g,h,i;if(h=je,63===c.charCodeAt(je)?(a="?",je++):(a=null,0===ke&&e('"?"')),null!==a)if(b=Cb(),null!==b){for(d=[],i=je,38===c.charCodeAt(je)?(f="&",je++):(f=null,0===ke&&e('"&"')),null!==f?(g=Cb(),null!==g?f=[f,g]:(f=null,je=i)):(f=null,je=i);null!==f;)d.push(f),i=je,38===c.charCodeAt(je)?(f="&",je++):(f=null,0===ke&&e('"&"')),null!==f?(g=Cb(),null!==g?f=[f,g]:(f=null,je=i)):(f=null,je=i);null!==d?a=[a,b,d]:(a=null,je=h)}else a=null,je=h;else a=null,je=h;return a}function Cb(){var a,b,d,f,g;return f=je,g=je,a=Db(),null!==a?(61===c.charCodeAt(je)?(b="=",je++):(b=null,0===ke&&e('"="')),null!==b?(d=Eb(),null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(a,b,c){b=b.join("").toLowerCase(),c=c.join(""),pe.uri_headers||(pe.uri_headers={}),pe.uri_headers[b]?pe.uri_headers[b].push(c):pe.uri_headers[b]=[c]}(f,a[0],a[2])),null===a&&(je=f),a}function Db(){var a,b;if(b=Fb(),null===b&&(b=q(),null===b&&(b=s())),null!==b)for(a=[];null!==b;)a.push(b),b=Fb(),null===b&&(b=q(),null===b&&(b=s()));else a=null;return a}function Eb(){var a,b;for(a=[],b=Fb(),null===b&&(b=q(),null===b&&(b=s()));null!==b;)a.push(b),b=Fb(),null===b&&(b=q(),null===b&&(b=s()));return a}function Fb(){var a;return 91===c.charCodeAt(je)?(a="[",je++):(a=null,0===ke&&e('"["')),null===a&&(93===c.charCodeAt(je)?(a="]",je++):(a=null,0===ke&&e('"]"')),null===a&&(47===c.charCodeAt(je)?(a="/",je++):(a=null,0===ke&&e('"/"')),null===a&&(63===c.charCodeAt(je)?(a="?",je++):(a=null,0===ke&&e('"?"')),null===a&&(58===c.charCodeAt(je)?(a=":",je++):(a=null,0===ke&&e('":"')),null===a&&(43===c.charCodeAt(je)?(a="+",je++):(a=null,0===ke&&e('"+"')),null===a&&(36===c.charCodeAt(je)?(a="$",je++):(a=null,0===ke&&e('"$"')))))))),a}function Gb(){var a;return a=hc(),null===a&&(a=Hb()),a}function Hb(){var a,b,c,d,e,f;return f=je,a=gc(),null!==a?(b=m(),null!==b?(c=Ib(),null!==c?(d=m(),null!==d?(e=Zb(),null!==e?a=[a,b,c,d,e]:(a=null,je=f)):(a=null,je=f)):(a=null,je=f)):(a=null,je=f)):(a=null,je=f),a}function Ib(){var a;return a=Y(),null===a&&(a=Jb()),a}function Jb(){var a,b,d,f;return f=je,a=Ub(),null!==a?(58===c.charCodeAt(je)?(b=":",je++):(b=null,0===ke&&e('":"')),null!==b?(d=Kb(),null===d&&(d=Nb()),null!==d?a=[a,b,d]:(a=null,je=f)):(a=null,je=f)):(a=null,je=f),a}function Kb(){var a,b,d,f,g;return f=je,a=Lb(),null===a&&(a=Mb()),null!==a?(g=je,63===c.charCodeAt(je)?(b="?",je++):(b=null,0===ke&&e('"?"')),null!==b?(d=Yb(),null!==d?b=[b,d]:(b=null,je=g)):(b=null,je=g),b=null!==b?b:"",null!==b?a=[a,b]:(a=null,je=f)):(a=null,je=f),a}function Lb(){var a,b,d,f;return f=je,"//"===c.substr(je,2)?(a="//",je+=2):(a=null,0===ke&&e('"//"')),null!==a?(b=Vb(),null!==b?(d=Mb(),d=null!==d?d:"",null!==d?a=[a,b,d]:(a=null,je=f)):(a=null,je=f)):(a=null,je=f),a}function Mb(){var a,b,d;return d=je,47===c.charCodeAt(je)?(a="/",je++):(a=null,0===ke&&e('"/"')),null!==a?(b=Qb(),null!==b?a=[a,b]:(a=null,je=d)):(a=null,je=d),a}function Nb(){var a,b,c,d;if(d=je,a=Pb(),null!==a){for(b=[],c=Ob();null!==c;)b.push(c),c=Ob();null!==b?a=[a,b]:(a=null,je=d)}else a=null,je=d;return a}function Ob(){var a;return a=p(),null===a&&(a=q(),null===a&&(a=s())),a}function Pb(){var a;return a=q(),null===a&&(a=s(),null===a&&(59===c.charCodeAt(je)?(a=";",je++):(a=null,0===ke&&e('";"')),null===a&&(63===c.charCodeAt(je)?(a="?",je++):(a=null,0===ke&&e('"?"')),null===a&&(58===c.charCodeAt(je)?(a=":",je++):(a=null,0===ke&&e('":"')),null===a&&(64===c.charCodeAt(je)?(a="@",je++):(a=null,0===ke&&e('"@"')),null===a&&(38===c.charCodeAt(je)?(a="&",je++):(a=null,0===ke&&e('"&"')),null===a&&(61===c.charCodeAt(je)?(a="=",je++):(a=null,0===ke&&e('"="')),null===a&&(43===c.charCodeAt(je)?(a="+",je++):(a=null,0===ke&&e('"+"')),null===a&&(36===c.charCodeAt(je)?(a="$",je++):(a=null,0===ke&&e('"$"')),null===a&&(44===c.charCodeAt(je)?(a=",",je++):(a=null,0===ke&&e('","')))))))))))),a}function Qb(){var a,b,d,f,g,h;if(g=je,a=Rb(),null!==a){for(b=[],h=je,47===c.charCodeAt(je)?(d="/",je++):(d=null,0===ke&&e('"/"')),null!==d?(f=Rb(),null!==f?d=[d,f]:(d=null,je=h)):(d=null,je=h);null!==d;)b.push(d),h=je,47===c.charCodeAt(je)?(d="/",je++):(d=null,0===ke&&e('"/"')),null!==d?(f=Rb(),null!==f?d=[d,f]:(d=null,je=h)):(d=null,je=h);null!==b?a=[a,b]:(a=null,je=g)}else a=null,je=g;return a}function Rb(){var a,b,d,f,g,h;for(g=je,a=[],b=Tb();null!==b;)a.push(b),b=Tb();if(null!==a){for(b=[],h=je,59===c.charCodeAt(je)?(d=";",je++):(d=null,0===ke&&e('";"')),null!==d?(f=Sb(),null!==f?d=[d,f]:(d=null,je=h)):(d=null,je=h);null!==d;)b.push(d),h=je,59===c.charCodeAt(je)?(d=";",je++):(d=null,0===ke&&e('";"')),null!==d?(f=Sb(),null!==f?d=[d,f]:(d=null,je=h)):(d=null,je=h);null!==b?a=[a,b]:(a=null,je=g)}else a=null,je=g;return a}function Sb(){var a,b;for(a=[],b=Tb();null!==b;)a.push(b),b=Tb();return a}function Tb(){var a;return a=q(),null===a&&(a=s(),null===a&&(58===c.charCodeAt(je)?(a=":",je++):(a=null,0===ke&&e('":"')),null===a&&(64===c.charCodeAt(je)?(a="@",je++):(a=null,0===ke&&e('"@"')),null===a&&(38===c.charCodeAt(je)?(a="&",je++):(a=null,0===ke&&e('"&"')),null===a&&(61===c.charCodeAt(je)?(a="=",je++):(a=null,0===ke&&e('"="')),null===a&&(43===c.charCodeAt(je)?(a="+",je++):(a=null,0===ke&&e('"+"')),null===a&&(36===c.charCodeAt(je)?(a="$",je++):(a=null,0===ke&&e('"$"')),null===a&&(44===c.charCodeAt(je)?(a=",",je++):(a=null,0===ke&&e('","')))))))))),a}function Ub(){var a,b,d,f,i;if(f=je,i=je,a=h(),null!==a){for(b=[],d=h(),null===d&&(d=g(),null===d&&(43===c.charCodeAt(je)?(d="+",je++):(d=null,0===ke&&e('"+"')),null===d&&(45===c.charCodeAt(je)?(d="-",je++):(d=null,0===ke&&e('"-"')),null===d&&(46===c.charCodeAt(je)?(d=".",je++):(d=null,0===ke&&e('"."'))))));null!==d;)b.push(d),d=h(),null===d&&(d=g(),null===d&&(43===c.charCodeAt(je)?(d="+",je++):(d=null,0===ke&&e('"+"')),null===d&&(45===c.charCodeAt(je)?(d="-",je++):(d=null,0===ke&&e('"-"')),null===d&&(46===c.charCodeAt(je)?(d=".",je++):(d=null,0===ke&&e('"."'))))));null!==b?a=[a,b]:(a=null,je=i)}else a=null,je=i;return null!==a&&(a=function(a){pe.scheme=c.substring(je,a)}(f)),null===a&&(je=f),a}function Vb(){var a;return a=Wb(),null===a&&(a=Xb()),a}function Wb(){var a,b,d,f;return d=je,f=je,a=$(),null!==a?(64===c.charCodeAt(je)?(b="@",je++):(b=null,0===ke&&e('"@"')),null!==b?a=[a,b]:(a=null,je=f)):(a=null,je=f),a=null!==a?a:"",null!==a?(b=cb(),null!==b?a=[a,b]:(a=null,je=d)):(a=null,je=d),a=null!==a?a:""}function Xb(){var a,b;if(b=q(),null===b&&(b=s(),null===b&&(36===c.charCodeAt(je)?(b="$",je++):(b=null,0===ke&&e('"$"')),null===b&&(44===c.charCodeAt(je)?(b=",",je++):(b=null,0===ke&&e('","')),null===b&&(59===c.charCodeAt(je)?(b=";",je++):(b=null,0===ke&&e('";"')),null===b&&(58===c.charCodeAt(je)?(b=":",je++):(b=null,0===ke&&e('":"')),null===b&&(64===c.charCodeAt(je)?(b="@",je++):(b=null,0===ke&&e('"@"')),null===b&&(38===c.charCodeAt(je)?(b="&",je++):(b=null,0===ke&&e('"&"')),null===b&&(61===c.charCodeAt(je)?(b="=",je++):(b=null,0===ke&&e('"="')),null===b&&(43===c.charCodeAt(je)?(b="+",je++):(b=null,0===ke&&e('"+"'))))))))))),null!==b)for(a=[];null!==b;)a.push(b),b=q(),null===b&&(b=s(),null===b&&(36===c.charCodeAt(je)?(b="$",je++):(b=null,0===ke&&e('"$"')),null===b&&(44===c.charCodeAt(je)?(b=",",je++):(b=null,0===ke&&e('","')),null===b&&(59===c.charCodeAt(je)?(b=";",je++):(b=null,0===ke&&e('";"')),null===b&&(58===c.charCodeAt(je)?(b=":",je++):(b=null,0===ke&&e('":"')),null===b&&(64===c.charCodeAt(je)?(b="@",je++):(b=null,0===ke&&e('"@"')),null===b&&(38===c.charCodeAt(je)?(b="&",je++):(b=null,0===ke&&e('"&"')),null===b&&(61===c.charCodeAt(je)?(b="=",je++):(b=null,0===ke&&e('"="')),null===b&&(43===c.charCodeAt(je)?(b="+",je++):(b=null,0===ke&&e('"+"')))))))))));else a=null;return a}function Yb(){var a,b;for(a=[],b=Ob();null!==b;)a.push(b),b=Ob();return a}function Zb(){var a,b,d,f,h,i,j,k;if(j=je,k=je,"sip"===c.substr(je,3).toLowerCase()?(a=c.substr(je,3),je+=3):(a=null,0===ke&&e('"SIP"')),null!==a)if(47===c.charCodeAt(je)?(b="/",je++):(b=null,0===ke&&e('"/"')),null!==b){if(f=g(),null!==f)for(d=[];null!==f;)d.push(f),f=g();else d=null;if(null!==d)if(46===c.charCodeAt(je)?(f=".",je++):(f=null,0===ke&&e('"."')),null!==f){if(i=g(),null!==i)for(h=[];null!==i;)h.push(i),i=g();else h=null;null!==h?a=[a,b,d,f,h]:(a=null,je=k)}else a=null,je=k;else a=null,je=k}else a=null,je=k;else a=null,je=k;return null!==a&&(a=function(a){pe.sip_version=c.substring(je,a)}(j)),null===a&&(je=j),a}function $b(){var a;return"INVITE"===c.substr(je,6)?(a="INVITE",je+=6):(a=null,0===ke&&e('"INVITE"')),a}function _b(){var a;return"ACK"===c.substr(je,3)?(a="ACK",je+=3):(a=null,0===ke&&e('"ACK"')),a}function ac(){var a;return"OPTIONS"===c.substr(je,7)?(a="OPTIONS",je+=7):(a=null,0===ke&&e('"OPTIONS"')),a}function bc(){var a;return"BYE"===c.substr(je,3)?(a="BYE",je+=3):(a=null,0===ke&&e('"BYE"')),a}function cc(){var a;return"CANCEL"===c.substr(je,6)?(a="CANCEL",je+=6):(a=null,0===ke&&e('"CANCEL"')),a}function dc(){var a;return"REGISTER"===c.substr(je,8)?(a="REGISTER",je+=8):(a=null,0===ke&&e('"REGISTER"')),a}function ec(){var a;return"SUBSCRIBE"===c.substr(je,9)?(a="SUBSCRIBE",je+=9):(a=null,0===ke&&e('"SUBSCRIBE"')),a}function fc(){var a;return"NOTIFY"===c.substr(je,6)?(a="NOTIFY",je+=6):(a=null,0===ke&&e('"NOTIFY"')),a}function gc(){var a,b;return b=je,a=$b(),null===a&&(a=_b(),null===a&&(a=ac(),null===a&&(a=bc(),null===a&&(a=cc(),null===a&&(a=dc(),null===a&&(a=ec(),null===a&&(a=fc(),null===a&&(a=B())))))))),null!==a&&(a=function(a){return pe.method=c.substring(je,a),pe.method}(b)),null===a&&(je=b),a}function hc(){var a,b,c,d,e,f;return f=je,a=Zb(),null!==a?(b=m(),null!==b?(c=ic(),null!==c?(d=m(),null!==d?(e=kc(),null!==e?a=[a,b,c,d,e]:(a=null,je=f)):(a=null,je=f)):(a=null,je=f)):(a=null,je=f)):(a=null,je=f),a}function ic(){var a,b;return b=je,a=jc(),null!==a&&(a=function(a,b){pe.status_code=parseInt(b.join(""))}(b,a)),null===a&&(je=b),a}function jc(){var a,b,c,d;return d=je,a=g(),null!==a?(b=g(),null!==b?(c=g(),null!==c?a=[a,b,c]:(a=null,je=d)):(a=null,je=d)):(a=null,je=d),a}function kc(){var a,b,d;for(d=je,a=[],b=p(),null===b&&(b=q(),null===b&&(b=s(),null===b&&(b=y(),null===b&&(b=z(),null===b&&(b=m(),null===b&&(b=n()))))));null!==b;)a.push(b),b=p(),null===b&&(b=q(),null===b&&(b=s(),null===b&&(b=y(),null===b&&(b=z(),null===b&&(b=m(),null===b&&(b=n()))))));return null!==a&&(a=function(a){pe.reason_phrase=c.substring(je,a)}(d)),null===a&&(je=d),a}function lc(){var a,b,c,d,e,f;if(e=je,a=Sc(),null!==a){for(b=[],f=je,c=M(),null!==c?(d=Sc(),null!==d?c=[c,d]:(c=null,je=f)):(c=null,je=f);null!==c;)b.push(c),f=je,c=M(),null!==c?(d=Sc(),null!==d?c=[c,d]:(c=null,je=f)):(c=null,je=f);null!==b?a=[a,b]:(a=null,je=e)}else a=null,je=e;return a}function mc(){var a,b,d,f,g,h;return f=je,g=je,a=E(),null!==a?(h=je,64===c.charCodeAt(je)?(b="@",je++):(b=null,0===ke&&e('"@"')),null!==b?(d=E(),null!==d?b=[b,d]:(b=null,je=h)):(b=null,je=h),b=null!==b?b:"",null!==b?a=[a,b]:(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(a){pe=c.substring(je,a)}(f)),null===a&&(je=f),a}function nc(){var a,b,c,d,e,f,g;if(e=je,a=F(),null===a)if(f=je,a=oc(),null!==a){for(b=[],g=je,c=M(),null!==c?(d=oc(),null!==d?c=[c,d]:(c=null,je=g)):(c=null,je=g);null!==c;)b.push(c),g=je,c=M(),null!==c?(d=oc(),null!==d?c=[c,d]:(c=null,je=g)):(c=null,je=g);null!==b?a=[a,b]:(a=null,je=f)}else a=null,je=f;return null!==a&&(a=function(){var a,b;for(b=pe.multi_header.length,a=0;b>a;a++)if(null===pe.multi_header[a].parsed){pe=null;break}pe=null!==pe?pe.multi_header:-1}(e)),null===a&&(je=e),a}function oc(){var a,b,c,d,e,f,g;if(e=je,f=je,a=X(),null===a&&(a=pc()),null!==a){for(b=[],g=je,c=N(),null!==c?(d=rc(),null!==d?c=[c,d]:(c=null,je=g)):(c=null,je=g);null!==c;)b.push(c),g=je,c=N(),null!==c?(d=rc(),null!==d?c=[c,d]:(c=null,je=g)):(c=null,je=g);null!==b?a=[a,b]:(a=null,je=f)}else a=null,je=f;return null!==a&&(a=function(a){var b;pe.multi_header||(pe.multi_header=[]);try{b=new oe(pe.uri,pe.display_name,pe.params),delete pe.uri,delete pe.display_name,delete pe.params}catch(c){b=null}pe.multi_header.push({possition:je,offset:a,parsed:b})}(e)),null===a&&(je=e),a}function pc(){var a,b,c,d,e;return e=je,a=qc(),a=null!==a?a:"",null!==a?(b=L(),null!==b?(c=Y(),null!==c?(d=K(),null!==d?a=[a,b,c,d]:(a=null,je=e)):(a=null,je=e)):(a=null,je=e)):(a=null,je=e),a}function qc(){var a,b,d,e,f,g,h;if(f=je,g=je,a=B(),null!==a){for(b=[],h=je,d=t(),null!==d?(e=B(),null!==e?d=[d,e]:(d=null,je=h)):(d=null,je=h);null!==d;)b.push(d),h=je,d=t(),null!==d?(e=B(),null!==e?d=[d,e]:(d=null,je=h)):(d=null,je=h);null!==b?a=[a,b]:(a=null,je=g)}else a=null,je=g;return null===a&&(a=T()),null!==a&&(a=function(a,b){b=c.substring(je,a).trim(),'"'===b[0]&&(b=b.substring(1,b.length-1)),pe.display_name=b}(f,a)),null===a&&(je=f),a}function rc(){var a;return a=sc(),null===a&&(a=tc(),null===a&&(a=wc())),a}function sc(){var a,b,d,f,g;return f=je,g=je,"q"===c.substr(je,1).toLowerCase()?(a=c.substr(je,1),je++):(a=null,0===ke&&e('"q"')),null!==a?(b=H(),null!==b?(d=vc(),null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(a,b){pe.params||(pe.params={}),pe.params.q=b}(f,a[2])),null===a&&(je=f),a}function tc(){var a,b,d,f,g;return f=je,g=je,"expires"===c.substr(je,7).toLowerCase()?(a=c.substr(je,7),je+=7):(a=null,0===ke&&e('"expires"')),null!==a?(b=H(),null!==b?(d=uc(),null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(a,b){pe.params||(pe.params={}),pe.params.expires=b}(f,a[2])),null===a&&(je=f),a}function uc(){var a,b,c;if(c=je,b=g(),null!==b)for(a=[];null!==b;)a.push(b),b=g();else a=null;return null!==a&&(a=function(a,b){return parseInt(b.join(""))}(c,a)),null===a&&(je=c),a}function vc(){var a,b,d,f,h,i,j,k;return i=je,j=je,48===c.charCodeAt(je)?(a="0",je++):(a=null,0===ke&&e('"0"')),null!==a?(k=je,46===c.charCodeAt(je)?(b=".",je++):(b=null,0===ke&&e('"."')),null!==b?(d=g(),d=null!==d?d:"",null!==d?(f=g(),f=null!==f?f:"",null!==f?(h=g(),h=null!==h?h:"",null!==h?b=[b,d,f,h]:(b=null,je=k)):(b=null,je=k)):(b=null,je=k)):(b=null,je=k),b=null!==b?b:"",null!==b?a=[a,b]:(a=null,je=j)):(a=null,je=j),null!==a&&(a=function(a){return parseFloat(c.substring(je,a))}(i)),null===a&&(je=i),a}function wc(){var a,b,c,d,e,f;return d=je,e=je,a=B(),null!==a?(f=je,b=H(),null!==b?(c=xc(),null!==c?b=[b,c]:(b=null,je=f)):(b=null,je=f),b=null!==b?b:"",null!==b?a=[a,b]:(a=null,je=e)):(a=null,je=e),null!==a&&(a=function(a,b,c){pe.params||(pe.params={}),c="undefined"==typeof c?void 0:c[1],pe.params[b.toLowerCase()]=c}(d,a[0],a[1])),null===a&&(je=d),a}function xc(){var a;return a=B(),null===a&&(a=db(),null===a&&(a=T())),a}function yc(){var a,b,c,d,e,f;if(e=je,a=zc(),null!==a){for(b=[],f=je,c=N(),null!==c?(d=Ac(),null!==d?c=[c,d]:(c=null,je=f)):(c=null,je=f);null!==c;)b.push(c),f=je,c=N(),null!==c?(d=Ac(),null!==d?c=[c,d]:(c=null,je=f)):(c=null,je=f);null!==b?a=[a,b]:(a=null,je=e)}else a=null,je=e;return a}function zc(){var a;return"render"===c.substr(je,6).toLowerCase()?(a=c.substr(je,6),je+=6):(a=null,0===ke&&e('"render"')),null===a&&("session"===c.substr(je,7).toLowerCase()?(a=c.substr(je,7),je+=7):(a=null,0===ke&&e('"session"')),null===a&&("icon"===c.substr(je,4).toLowerCase()?(a=c.substr(je,4),je+=4):(a=null,0===ke&&e('"icon"')),null===a&&("alert"===c.substr(je,5).toLowerCase()?(a=c.substr(je,5),je+=5):(a=null,0===ke&&e('"alert"')),null===a&&(a=B())))),a}function Ac(){var a;return a=Bc(),null===a&&(a=wc()),a}function Bc(){var a,b,d,f;return f=je,"handling"===c.substr(je,8).toLowerCase()?(a=c.substr(je,8),je+=8):(a=null,0===ke&&e('"handling"')),null!==a?(b=H(),null!==b?("optional"===c.substr(je,8).toLowerCase()?(d=c.substr(je,8),je+=8):(d=null,0===ke&&e('"optional"')),null===d&&("required"===c.substr(je,8).toLowerCase()?(d=c.substr(je,8),je+=8):(d=null,0===ke&&e('"required"')),null===d&&(d=B())),null!==d?a=[a,b,d]:(a=null,je=f)):(a=null,je=f)):(a=null,je=f),a}function Cc(){var a,b,c,d,e,f;if(e=je,a=B(),null!==a){for(b=[],f=je,c=M(),null!==c?(d=B(),null!==d?c=[c,d]:(c=null,je=f)):(c=null,je=f);null!==c;)b.push(c),f=je,c=M(),null!==c?(d=B(),null!==d?c=[c,d]:(c=null,je=f)):(c=null,je=f);null!==b?a=[a,b]:(a=null,je=e)}else a=null,je=e;return a}function Dc(){var a,b,c;if(c=je,b=g(),null!==b)for(a=[];null!==b;)a.push(b),b=g();else a=null;return null!==a&&(a=function(a,b){pe=parseInt(b.join(""))}(c,a)),null===a&&(je=c),a}function Ec(){var a,b;return b=je,a=Fc(),null!==a&&(a=function(a){pe=c.substring(je,a)}(b)),null===a&&(je=b),a}function Fc(){var a,b,c,d,e,f,g,h;if(g=je,a=Gc(),null!==a)if(b=G(),null!==b)if(c=Lc(),null!==c){for(d=[],h=je,e=N(),null!==e?(f=Mc(),null!==f?e=[e,f]:(e=null,je=h)):(e=null,je=h);null!==e;)d.push(e),h=je,e=N(),null!==e?(f=Mc(),null!==f?e=[e,f]:(e=null,je=h)):(e=null,je=h);null!==d?a=[a,b,c,d]:(a=null,je=g)}else a=null,je=g;else a=null,je=g;else a=null,je=g;return a}function Gc(){var a;return a=Hc(),null===a&&(a=Ic()),a}function Hc(){var a;return"text"===c.substr(je,4).toLowerCase()?(a=c.substr(je,4),je+=4):(a=null,0===ke&&e('"text"')),null===a&&("image"===c.substr(je,5).toLowerCase()?(a=c.substr(je,5),je+=5):(a=null,0===ke&&e('"image"')),null===a&&("audio"===c.substr(je,5).toLowerCase()?(a=c.substr(je,5),je+=5):(a=null,0===ke&&e('"audio"')),null===a&&("video"===c.substr(je,5).toLowerCase()?(a=c.substr(je,5),je+=5):(a=null,0===ke&&e('"video"')),null===a&&("application"===c.substr(je,11).toLowerCase()?(a=c.substr(je,11),je+=11):(a=null,0===ke&&e('"application"')),null===a&&(a=Jc()))))),a}function Ic(){var a;return"message"===c.substr(je,7).toLowerCase()?(a=c.substr(je,7),je+=7):(a=null,0===ke&&e('"message"')),null===a&&("multipart"===c.substr(je,9).toLowerCase()?(a=c.substr(je,9),je+=9):(a=null,0===ke&&e('"multipart"')),null===a&&(a=Jc())),a}function Jc(){var a;return a=B(),null===a&&(a=Kc()),a}function Kc(){var a,b,d;return d=je,"x-"===c.substr(je,2).toLowerCase()?(a=c.substr(je,2),je+=2):(a=null,0===ke&&e('"x-"')),null!==a?(b=B(),null!==b?a=[a,b]:(a=null,je=d)):(a=null,je=d),a}function Lc(){var a;return a=Jc(),null===a&&(a=B()),a}function Mc(){var a,b,c,d;return d=je,a=B(),null!==a?(b=H(),null!==b?(c=Nc(),null!==c?a=[a,b,c]:(a=null,je=d)):(a=null,je=d)):(a=null,je=d),a}function Nc(){var a;return a=B(),null===a&&(a=T()),a}function Oc(){var a,b,c,d;return d=je,a=Pc(),null!==a?(b=t(),null!==b?(c=gc(),null!==c?a=[a,b,c]:(a=null,je=d)):(a=null,je=d)):(a=null,je=d),a}function Pc(){var a,b,c;if(c=je,b=g(),null!==b)for(a=[];null!==b;)a.push(b),b=g();else a=null;return null!==a&&(a=function(a,b){pe.value=parseInt(b.join(""))}(c,a)),null===a&&(je=c),a}function Qc(){var a,b;return b=je,a=uc(),null!==a&&(a=function(a,b){pe=b}(b,a)),null===a&&(je=b),a}function Rc(){var a,b,c,d,e,f,g;if(e=je,f=je,a=Sc(),null!==a){for(b=[],g=je,c=N(),null!==c?(d=wc(),null!==d?c=[c,d]:(c=null,je=g)):(c=null,je=g);null!==c;)b.push(c),g=je,c=N(),null!==c?(d=wc(),null!==d?c=[c,d]:(c=null,je=g)):(c=null,je=g);null!==b?a=[a,b]:(a=null,je=f)}else a=null,je=f;return null!==a&&(a=function(a,b){pe.event=b.join("").toLowerCase()}(e,a[0])),null===a&&(je=e),a}function Sc(){var a,b,d,f,g,h;if(g=je,a=C(),null!==a){for(b=[],h=je,46===c.charCodeAt(je)?(d=".",je++):(d=null,0===ke&&e('"."')),null!==d?(f=C(),null!==f?d=[d,f]:(d=null,je=h)):(d=null,je=h);null!==d;)b.push(d),h=je,46===c.charCodeAt(je)?(d=".",je++):(d=null,0===ke&&e('"."')),null!==d?(f=C(),null!==f?d=[d,f]:(d=null,je=h)):(d=null,je=h);null!==b?a=[a,b]:(a=null,je=g)}else a=null,je=g;return a}function Tc(){var a,b,c,d,e,f,g;if(e=je,f=je,a=X(),null===a&&(a=pc()),null!==a){for(b=[],g=je,c=N(),null!==c?(d=Uc(),null!==d?c=[c,d]:(c=null,je=g)):(c=null,je=g);null!==c;)b.push(c),g=je,c=N(),null!==c?(d=Uc(),null!==d?c=[c,d]:(c=null,je=g)):(c=null,je=g);null!==b?a=[a,b]:(a=null,je=f)}else a=null,je=f;return null!==a&&(a=function(){var a=pe.tag;try{pe=new oe(pe.uri,pe.display_name,pe.params),a&&pe.setParam("tag",a)}catch(b){pe=-1}}(e)),null===a&&(je=e),a}function Uc(){var a;return a=Vc(),null===a&&(a=wc()),a}function Vc(){var a,b,d,f,g;return f=je,g=je,"tag"===c.substr(je,3).toLowerCase()?(a=c.substr(je,3),je+=3):(a=null,0===ke&&e('"tag"')),null!==a?(b=H(),null!==b?(d=B(),null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(a,b){pe.tag=b}(f,a[2])),null===a&&(je=f),a}function Wc(){var a,b,c;if(c=je,b=g(),null!==b)for(a=[];null!==b;)a.push(b),b=g();else a=null;return null!==a&&(a=function(a,b){pe=parseInt(b.join(""))}(c,a)),null===a&&(je=c),a}function Xc(){var a,b;return b=je,a=uc(),null!==a&&(a=function(a,b){pe=b}(b,a)),null===a&&(je=b),a}function Yc(){var a,b,c,d,e,f,g,h,i,j;for(h=je,i=je,a=[],b=qc();null!==b;)a.push(b),b=qc();if(null!==a)if(b=L(),null!==b)if(c=Y(),null!==c)if(d=K(),null!==d){for(e=[],j=je,f=N(),null!==f?(g=wc(),null!==g?f=[f,g]:(f=null,je=j)):(f=null,je=j);null!==f;)e.push(f),j=je,f=N(),null!==f?(g=wc(),null!==g?f=[f,g]:(f=null,je=j)):(f=null,je=j);null!==e?a=[a,b,c,d,e]:(a=null,je=i)}else a=null,je=i;else a=null,je=i;else a=null,je=i;else a=null,je=i;return null!==a&&(a=function(){try{pe=new oe(pe.uri,pe.display_name,pe.params)}catch(a){pe=-1}}(h)),null===a&&(je=h),a}function Zc(){var a;return a=$c()}function $c(){var a,b,d,f,g,h,i,j;if(i=je,"digest"===c.substr(je,6).toLowerCase()?(a=c.substr(je,6),je+=6):(a=null,0===ke&&e('"Digest"')),null!==a)if(b=t(),null!==b)if(d=bd(),null!==d){for(f=[],j=je,g=M(),null!==g?(h=bd(),null!==h?g=[g,h]:(g=null,je=j)):(g=null,je=j);null!==g;)f.push(g),j=je,g=M(),null!==g?(h=bd(),null!==h?g=[g,h]:(g=null,je=j)):(g=null,je=j);null!==f?a=[a,b,d,f]:(a=null,je=i)}else a=null,je=i;else a=null,je=i;else a=null,je=i;return null===a&&(a=_c()),a}function _c(){var a,b,c,d,e,f,g,h;if(g=je,a=B(),null!==a)if(b=t(),null!==b)if(c=ad(),null!==c){for(d=[],h=je,e=M(),null!==e?(f=ad(),null!==f?e=[e,f]:(e=null,je=h)):(e=null,je=h);null!==e;)d.push(e),h=je,e=M(),null!==e?(f=ad(),null!==f?e=[e,f]:(e=null,je=h)):(e=null,je=h);null!==d?a=[a,b,c,d]:(a=null,je=g)}else a=null,je=g;else a=null,je=g;else a=null,je=g;return a}function ad(){var a,b,c,d;return d=je,a=B(),null!==a?(b=H(),null!==b?(c=B(),null===c&&(c=T()),null!==c?a=[a,b,c]:(a=null,je=d)):(a=null,je=d)):(a=null,je=d),a}function bd(){var a;return a=cd(),null===a&&(a=ed(),null===a&&(a=gd(),null===a&&(a=id(),null===a&&(a=jd(),null===a&&(a=kd(),null===a&&(a=ld(),null===a&&(a=ad()))))))),a}function cd(){var a,b,d,f;return f=je,"realm"===c.substr(je,5).toLowerCase()?(a=c.substr(je,5),je+=5):(a=null,0===ke&&e('"realm"')),null!==a?(b=H(),null!==b?(d=dd(),null!==d?a=[a,b,d]:(a=null,je=f)):(a=null,je=f)):(a=null,je=f),a}function dd(){var a,b;return b=je,a=U(),null!==a&&(a=function(a,b){pe.realm=b}(b,a)),null===a&&(je=b),a}function ed(){var a,b,d,f,g,h,i,j,k;if(j=je,"domain"===c.substr(je,6).toLowerCase()?(a=c.substr(je,6),je+=6):(a=null,0===ke&&e('"domain"')),null!==a)if(b=H(),null!==b)if(d=P(),null!==d)if(f=fd(),null!==f){if(g=[],k=je,i=m(),null!==i)for(h=[];null!==i;)h.push(i),i=m();else h=null;for(null!==h?(i=fd(),null!==i?h=[h,i]:(h=null,je=k)):(h=null,je=k);null!==h;){if(g.push(h),k=je,i=m(),null!==i)for(h=[];null!==i;)h.push(i),i=m();else h=null;null!==h?(i=fd(),null!==i?h=[h,i]:(h=null,je=k)):(h=null,je=k)}null!==g?(h=Q(),null!==h?a=[a,b,d,f,g,h]:(a=null,je=j)):(a=null,je=j)}else a=null,je=j;else a=null,je=j;else a=null,je=j;else a=null,je=j;return a}function fd(){var a;return a=Jb(),null===a&&(a=Mb()),a}function gd(){var a,b,d,f;return f=je,"nonce"===c.substr(je,5).toLowerCase()?(a=c.substr(je,5),je+=5):(a=null,0===ke&&e('"nonce"')),null!==a?(b=H(),null!==b?(d=hd(),null!==d?a=[a,b,d]:(a=null,je=f)):(a=null,je=f)):(a=null,je=f),a}function hd(){var a,b;return b=je,a=U(),null!==a&&(a=function(a,b){pe.nonce=b}(b,a)),null===a&&(je=b),a}function id(){var a,b,d,f,g;return f=je,g=je,"opaque"===c.substr(je,6).toLowerCase()?(a=c.substr(je,6),je+=6):(a=null,0===ke&&e('"opaque"')),null!==a?(b=H(),null!==b?(d=U(),null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(a,b){pe.opaque=b}(f,a[2])),null===a&&(je=f),a}function jd(){var a,b,d,f,g;return f=je,"stale"===c.substr(je,5).toLowerCase()?(a=c.substr(je,5),je+=5):(a=null,0===ke&&e('"stale"')),null!==a?(b=H(),null!==b?(g=je,"true"===c.substr(je,4).toLowerCase()?(d=c.substr(je,4),je+=4):(d=null,0===ke&&e('"true"')),null!==d&&(d=function(){pe.stale=!0}(g)),null===d&&(je=g),null===d&&(g=je,"false"===c.substr(je,5).toLowerCase()?(d=c.substr(je,5),je+=5):(d=null,0===ke&&e('"false"')),null!==d&&(d=function(){pe.stale=!1}(g)),null===d&&(je=g)),null!==d?a=[a,b,d]:(a=null,je=f)):(a=null,je=f)):(a=null,je=f),a}function kd(){var a,b,d,f,g;return f=je,g=je,"algorithm"===c.substr(je,9).toLowerCase()?(a=c.substr(je,9),je+=9):(a=null,0===ke&&e('"algorithm"')),null!==a?(b=H(),null!==b?("md5"===c.substr(je,3).toLowerCase()?(d=c.substr(je,3),je+=3):(d=null,0===ke&&e('"MD5"')),null===d&&("md5-sess"===c.substr(je,8).toLowerCase()?(d=c.substr(je,8),je+=8):(d=null,0===ke&&e('"MD5-sess"')),null===d&&(d=B())),null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(a,b){pe.algorithm=b.toUpperCase()}(f,a[2])),null===a&&(je=f),a}function ld(){var a,b,d,f,g,h,i,j,k,l;if(j=je,"qop"===c.substr(je,3).toLowerCase()?(a=c.substr(je,3),je+=3):(a=null,0===ke&&e('"qop"')),null!==a)if(b=H(),null!==b)if(d=P(),null!==d){if(k=je,f=md(),null!==f){for(g=[],l=je,44===c.charCodeAt(je)?(h=",",je++):(h=null,0===ke&&e('","')),null!==h?(i=md(),null!==i?h=[h,i]:(h=null,je=l)):(h=null,je=l);null!==h;)g.push(h),l=je,44===c.charCodeAt(je)?(h=",",je++):(h=null,0===ke&&e('","')),null!==h?(i=md(),null!==i?h=[h,i]:(h=null,je=l)):(h=null,je=l);
null!==g?f=[f,g]:(f=null,je=k)}else f=null,je=k;null!==f?(g=Q(),null!==g?a=[a,b,d,f,g]:(a=null,je=j)):(a=null,je=j)}else a=null,je=j;else a=null,je=j;else a=null,je=j;return a}function md(){var a,b;return b=je,"auth-int"===c.substr(je,8).toLowerCase()?(a=c.substr(je,8),je+=8):(a=null,0===ke&&e('"auth-int"')),null===a&&("auth"===c.substr(je,4).toLowerCase()?(a=c.substr(je,4),je+=4):(a=null,0===ke&&e('"auth"')),null===a&&(a=B())),null!==a&&(a=function(a,b){pe.qop||(pe.qop=[]),pe.qop.push(b.toLowerCase())}(b,a)),null===a&&(je=b),a}function nd(){var a,b,c,d,e,f;if(e=je,a=B(),null!==a){for(b=[],f=je,c=M(),null!==c?(d=B(),null!==d?c=[c,d]:(c=null,je=f)):(c=null,je=f);null!==c;)b.push(c),f=je,c=M(),null!==c?(d=B(),null!==d?c=[c,d]:(c=null,je=f)):(c=null,je=f);null!==b?a=[a,b]:(a=null,je=e)}else a=null,je=e;return a}function od(){var a,b,c,d,e,f,g;if(e=je,f=je,a=pd(),null!==a){for(b=[],g=je,c=M(),null!==c?(d=pd(),null!==d?c=[c,d]:(c=null,je=g)):(c=null,je=g);null!==c;)b.push(c),g=je,c=M(),null!==c?(d=pd(),null!==d?c=[c,d]:(c=null,je=g)):(c=null,je=g);null!==b?a=[a,b]:(a=null,je=f)}else a=null,je=f;return null!==a&&(a=function(){var a,b;for(b=pe.multi_header.length,a=0;b>a;a++)if(null===pe.multi_header[a].parsed){pe=null;break}pe=null!==pe?pe.multi_header:-1}(e)),null===a&&(je=e),a}function pd(){var a,b,c,d,e,f,g;if(e=je,f=je,a=pc(),null!==a){for(b=[],g=je,c=N(),null!==c?(d=wc(),null!==d?c=[c,d]:(c=null,je=g)):(c=null,je=g);null!==c;)b.push(c),g=je,c=N(),null!==c?(d=wc(),null!==d?c=[c,d]:(c=null,je=g)):(c=null,je=g);null!==b?a=[a,b]:(a=null,je=f)}else a=null,je=f;return null!==a&&(a=function(a){var b;pe.multi_header||(pe.multi_header=[]);try{b=new oe(pe.uri,pe.display_name,pe.params),delete pe.uri,delete pe.display_name,delete pe.params}catch(c){b=null}pe.multi_header.push({possition:je,offset:a,parsed:b})}(e)),null===a&&(je=e),a}function qd(){var a,b,c,d,e,f;if(e=je,a=B(),null!==a){for(b=[],f=je,c=M(),null!==c?(d=B(),null!==d?c=[c,d]:(c=null,je=f)):(c=null,je=f);null!==c;)b.push(c),f=je,c=M(),null!==c?(d=B(),null!==d?c=[c,d]:(c=null,je=f)):(c=null,je=f);null!==b?a=[a,b]:(a=null,je=e)}else a=null,je=e;return a}function rd(){var a,b,c,d,e,f;if(e=je,a=sd(),null!==a){for(b=[],f=je,c=M(),null!==c?(d=sd(),null!==d?c=[c,d]:(c=null,je=f)):(c=null,je=f);null!==c;)b.push(c),f=je,c=M(),null!==c?(d=sd(),null!==d?c=[c,d]:(c=null,je=f)):(c=null,je=f);null!==b?a=[a,b]:(a=null,je=e)}else a=null,je=e;return a}function sd(){var a,b,c,d,e,f;if(e=je,a=pc(),null!==a){for(b=[],f=je,c=N(),null!==c?(d=wc(),null!==d?c=[c,d]:(c=null,je=f)):(c=null,je=f);null!==c;)b.push(c),f=je,c=N(),null!==c?(d=wc(),null!==d?c=[c,d]:(c=null,je=f)):(c=null,je=f);null!==b?a=[a,b]:(a=null,je=e)}else a=null,je=e;return a}function td(){var a,b,c,d,e,f;if(e=je,a=ud(),null!==a){for(b=[],f=je,c=N(),null!==c?(d=vd(),null!==d?c=[c,d]:(c=null,je=f)):(c=null,je=f);null!==c;)b.push(c),f=je,c=N(),null!==c?(d=vd(),null!==d?c=[c,d]:(c=null,je=f)):(c=null,je=f);null!==b?a=[a,b]:(a=null,je=e)}else a=null,je=e;return a}function ud(){var a,b;return b=je,"active"===c.substr(je,6).toLowerCase()?(a=c.substr(je,6),je+=6):(a=null,0===ke&&e('"active"')),null===a&&("pending"===c.substr(je,7).toLowerCase()?(a=c.substr(je,7),je+=7):(a=null,0===ke&&e('"pending"')),null===a&&("terminated"===c.substr(je,10).toLowerCase()?(a=c.substr(je,10),je+=10):(a=null,0===ke&&e('"terminated"')),null===a&&(a=B()))),null!==a&&(a=function(a){pe.state=c.substring(je,a)}(b)),null===a&&(je=b),a}function vd(){var a,b,d,f,g;return f=je,g=je,"reason"===c.substr(je,6).toLowerCase()?(a=c.substr(je,6),je+=6):(a=null,0===ke&&e('"reason"')),null!==a?(b=H(),null!==b?(d=wd(),null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(a,b){"undefined"!=typeof b&&(pe.reason=b)}(f,a[2])),null===a&&(je=f),null===a&&(f=je,g=je,"expires"===c.substr(je,7).toLowerCase()?(a=c.substr(je,7),je+=7):(a=null,0===ke&&e('"expires"')),null!==a?(b=H(),null!==b?(d=uc(),null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(a,b){"undefined"!=typeof b&&(pe.expires=b)}(f,a[2])),null===a&&(je=f),null===a&&(f=je,g=je,"retry_after"===c.substr(je,11).toLowerCase()?(a=c.substr(je,11),je+=11):(a=null,0===ke&&e('"retry_after"')),null!==a?(b=H(),null!==b?(d=uc(),null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(a,b){"undefined"!=typeof b&&(pe.retry_after=b)}(f,a[2])),null===a&&(je=f),null===a&&(a=wc()))),a}function wd(){var a;return"deactivated"===c.substr(je,11).toLowerCase()?(a=c.substr(je,11),je+=11):(a=null,0===ke&&e('"deactivated"')),null===a&&("probation"===c.substr(je,9).toLowerCase()?(a=c.substr(je,9),je+=9):(a=null,0===ke&&e('"probation"')),null===a&&("rejected"===c.substr(je,8).toLowerCase()?(a=c.substr(je,8),je+=8):(a=null,0===ke&&e('"rejected"')),null===a&&("timeout"===c.substr(je,7).toLowerCase()?(a=c.substr(je,7),je+=7):(a=null,0===ke&&e('"timeout"')),null===a&&("giveup"===c.substr(je,6).toLowerCase()?(a=c.substr(je,6),je+=6):(a=null,0===ke&&e('"giveup"')),null===a&&("noresource"===c.substr(je,10).toLowerCase()?(a=c.substr(je,10),je+=10):(a=null,0===ke&&e('"noresource"')),null===a&&("invariant"===c.substr(je,9).toLowerCase()?(a=c.substr(je,9),je+=9):(a=null,0===ke&&e('"invariant"')),null===a&&(a=B()))))))),a}function xd(){var a;return a=w(),a=null!==a?a:""}function yd(){var a,b,c,d,e,f;if(e=je,a=B(),null!==a){for(b=[],f=je,c=M(),null!==c?(d=B(),null!==d?c=[c,d]:(c=null,je=f)):(c=null,je=f);null!==c;)b.push(c),f=je,c=M(),null!==c?(d=B(),null!==d?c=[c,d]:(c=null,je=f)):(c=null,je=f);null!==b?a=[a,b]:(a=null,je=e)}else a=null,je=e;return a=null!==a?a:""}function zd(){var a,b,c,d,e,f,g;if(e=je,f=je,a=X(),null===a&&(a=pc()),null!==a){for(b=[],g=je,c=N(),null!==c?(d=Ad(),null!==d?c=[c,d]:(c=null,je=g)):(c=null,je=g);null!==c;)b.push(c),g=je,c=N(),null!==c?(d=Ad(),null!==d?c=[c,d]:(c=null,je=g)):(c=null,je=g);null!==b?a=[a,b]:(a=null,je=f)}else a=null,je=f;return null!==a&&(a=function(){var a=pe.tag;try{pe=new oe(pe.uri,pe.display_name,pe.params),a&&pe.setParam("tag",a)}catch(b){pe=-1}}(e)),null===a&&(je=e),a}function Ad(){var a;return a=Vc(),null===a&&(a=wc()),a}function Bd(){var a,b,c,d,e,f;if(e=je,a=Cd(),null!==a){for(b=[],f=je,c=M(),null!==c?(d=Cd(),null!==d?c=[c,d]:(c=null,je=f)):(c=null,je=f);null!==c;)b.push(c),f=je,c=M(),null!==c?(d=Cd(),null!==d?c=[c,d]:(c=null,je=f)):(c=null,je=f);null!==b?a=[a,b]:(a=null,je=e)}else a=null,je=e;return a}function Cd(){var a,b,c,d,e,f,g,h;if(g=je,a=Jd(),null!==a)if(b=t(),null!==b)if(c=Md(),null!==c){for(d=[],h=je,e=N(),null!==e?(f=Dd(),null!==f?e=[e,f]:(e=null,je=h)):(e=null,je=h);null!==e;)d.push(e),h=je,e=N(),null!==e?(f=Dd(),null!==f?e=[e,f]:(e=null,je=h)):(e=null,je=h);null!==d?a=[a,b,c,d]:(a=null,je=g)}else a=null,je=g;else a=null,je=g;else a=null,je=g;return a}function Dd(){var a;return a=Ed(),null===a&&(a=Fd(),null===a&&(a=Gd(),null===a&&(a=Hd(),null===a&&(a=Id(),null===a&&(a=wc()))))),a}function Ed(){var a,b,d,f,g;return f=je,g=je,"ttl"===c.substr(je,3).toLowerCase()?(a=c.substr(je,3),je+=3):(a=null,0===ke&&e('"ttl"')),null!==a?(b=H(),null!==b?(d=Pd(),null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(a,b){pe.ttl=b}(f,a[2])),null===a&&(je=f),a}function Fd(){var a,b,d,f,g;return f=je,g=je,"maddr"===c.substr(je,5).toLowerCase()?(a=c.substr(je,5),je+=5):(a=null,0===ke&&e('"maddr"')),null!==a?(b=H(),null!==b?(d=db(),null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(a,b){pe.maddr=b}(f,a[2])),null===a&&(je=f),a}function Gd(){var a,b,d,f,g;return f=je,g=je,"received"===c.substr(je,8).toLowerCase()?(a=c.substr(je,8),je+=8):(a=null,0===ke&&e('"received"')),null!==a?(b=H(),null!==b?(d=lb(),null===d&&(d=ib()),null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(a,b){pe.received=b}(f,a[2])),null===a&&(je=f),a}function Hd(){var a,b,d,f,g;return f=je,g=je,"branch"===c.substr(je,6).toLowerCase()?(a=c.substr(je,6),je+=6):(a=null,0===ke&&e('"branch"')),null!==a?(b=H(),null!==b?(d=B(),null!==d?a=[a,b,d]:(a=null,je=g)):(a=null,je=g)):(a=null,je=g),null!==a&&(a=function(a,b){pe.branch=b}(f,a[2])),null===a&&(je=f),a}function Id(){var a,b,d,f,h,i,j;if(h=je,i=je,"rport"===c.substr(je,5).toLowerCase()?(a=c.substr(je,5),je+=5):(a=null,0===ke&&e('"rport"')),null!==a){if(j=je,b=H(),null!==b){for(d=[],f=g();null!==f;)d.push(f),f=g();null!==d?b=[b,d]:(b=null,je=j)}else b=null,je=j;b=null!==b?b:"",null!==b?a=[a,b]:(a=null,je=i)}else a=null,je=i;return null!==a&&(a=function(){"undefined"!=typeof response_port&&(pe.rport=response_port.join(""))}(h)),null===a&&(je=h),a}function Jd(){var a,b,c,d,e,f;return f=je,a=Kd(),null!==a?(b=G(),null!==b?(c=B(),null!==c?(d=G(),null!==d?(e=Ld(),null!==e?a=[a,b,c,d,e]:(a=null,je=f)):(a=null,je=f)):(a=null,je=f)):(a=null,je=f)):(a=null,je=f),a}function Kd(){var a,b;return b=je,"sip"===c.substr(je,3).toLowerCase()?(a=c.substr(je,3),je+=3):(a=null,0===ke&&e('"SIP"')),null===a&&(a=B()),null!==a&&(a=function(a,b){pe.protocol=b}(b,a)),null===a&&(je=b),a}function Ld(){var a,b;return b=je,"udp"===c.substr(je,3).toLowerCase()?(a=c.substr(je,3),je+=3):(a=null,0===ke&&e('"UDP"')),null===a&&("tcp"===c.substr(je,3).toLowerCase()?(a=c.substr(je,3),je+=3):(a=null,0===ke&&e('"TCP"')),null===a&&("tls"===c.substr(je,3).toLowerCase()?(a=c.substr(je,3),je+=3):(a=null,0===ke&&e('"TLS"')),null===a&&("sctp"===c.substr(je,4).toLowerCase()?(a=c.substr(je,4),je+=4):(a=null,0===ke&&e('"SCTP"')),null===a&&(a=B())))),null!==a&&(a=function(a,b){pe.transport=b}(b,a)),null===a&&(je=b),a}function Md(){var a,b,c,d,e;return d=je,a=Nd(),null!==a?(e=je,b=O(),null!==b?(c=Od(),null!==c?b=[b,c]:(b=null,je=e)):(b=null,je=e),b=null!==b?b:"",null!==b?a=[a,b]:(a=null,je=d)):(a=null,je=d),a}function Nd(){var a,b;return b=je,a=lb(),null===a&&(a=hb(),null===a&&(a=eb())),null!==a&&(a=function(a){pe.host=c.substring(je,a)}(b)),null===a&&(je=b),a}function Od(){var a,b,c,d,e,f,h;return f=je,h=je,a=g(),a=null!==a?a:"",null!==a?(b=g(),b=null!==b?b:"",null!==b?(c=g(),c=null!==c?c:"",null!==c?(d=g(),d=null!==d?d:"",null!==d?(e=g(),e=null!==e?e:"",null!==e?a=[a,b,c,d,e]:(a=null,je=h)):(a=null,je=h)):(a=null,je=h)):(a=null,je=h)):(a=null,je=h),null!==a&&(a=function(a,b){pe.port=parseInt(b.join(""))}(f,a)),null===a&&(je=f),a}function Pd(){var a,b,c,d,e;return d=je,e=je,a=g(),null!==a?(b=g(),b=null!==b?b:"",null!==b?(c=g(),c=null!==c?c:"",null!==c?a=[a,b,c]:(a=null,je=e)):(a=null,je=e)):(a=null,je=e),null!==a&&(a=function(a,b){return parseInt(b.join(""))}(d,a)),null===a&&(je=d),a}function Qd(){var a;return a=$c()}function Rd(){var a,b,c,d;return d=je,a=B(),null!==a?(b=v(),null!==b?(c=Sd(),null!==c?a=[a,b,c]:(a=null,je=d)):(a=null,je=d)):(a=null,je=d),a}function Sd(){var a,b;for(a=[],b=x(),null===b&&(b=z(),null===b&&(b=t()));null!==b;)a.push(b),b=x(),null===b&&(b=z(),null===b&&(b=t()));return a}function Td(){var a,b;for(a=[],b=k();null!==b;)a.push(b),b=k();return a}function Ud(){var a,b,d,f;return f=je,a=Vd(),null!==a?(58===c.charCodeAt(je)?(b=":",je++):(b=null,0===ke&&e('":"')),null!==b?(d=Wd(),null!==d?a=[a,b,d]:(a=null,je=f)):(a=null,je=f)):(a=null,je=f),a}function Vd(){var a,b;return b=je,"stuns"===c.substr(je,5).toLowerCase()?(a=c.substr(je,5),je+=5):(a=null,0===ke&&e('"stuns"')),null===a&&("stun"===c.substr(je,4).toLowerCase()?(a=c.substr(je,4),je+=4):(a=null,0===ke&&e('"stun"'))),null!==a&&(a=function(a,b){pe.scheme=b}(b,a)),null===a&&(je=b),a}function Wd(){var a,b,d,f,g;return f=je,a=Xd(),null!==a?(g=je,58===c.charCodeAt(je)?(b=":",je++):(b=null,0===ke&&e('":"')),null!==b?(d=nb(),null!==d?b=[b,d]:(b=null,je=g)):(b=null,je=g),b=null!==b?b:"",null!==b?a=[a,b]:(a=null,je=f)):(a=null,je=f),a}function Xd(){var a,b;return b=je,a=lb(),null===a&&(a=hb(),null===a&&(a=Xb())),null!==a&&(a=function(a,b){pe.host=b}(b,a)),null===a&&(je=b),a}function Xb(){var a,b,d;for(d=je,a=[],b=Yd(),null===b&&(b=s(),null===b&&(b=Zd()));null!==b;)a.push(b),b=Yd(),null===b&&(b=s(),null===b&&(b=Zd()));return null!==a&&(a=function(a){return c.substring(je,a)}(d)),null===a&&(je=d),a}function Yd(){var a;return a=h(),null===a&&(a=g(),null===a&&(45===c.charCodeAt(je)?(a="-",je++):(a=null,0===ke&&e('"-"')),null===a&&(46===c.charCodeAt(je)?(a=".",je++):(a=null,0===ke&&e('"."')),null===a&&(95===c.charCodeAt(je)?(a="_",je++):(a=null,0===ke&&e('"_"')),null===a&&(126===c.charCodeAt(je)?(a="~",je++):(a=null,0===ke&&e('"~"'))))))),a}function Zd(){var a;return 33===c.charCodeAt(je)?(a="!",je++):(a=null,0===ke&&e('"!"')),null===a&&(36===c.charCodeAt(je)?(a="$",je++):(a=null,0===ke&&e('"$"')),null===a&&(38===c.charCodeAt(je)?(a="&",je++):(a=null,0===ke&&e('"&"')),null===a&&(39===c.charCodeAt(je)?(a="'",je++):(a=null,0===ke&&e('"\'"')),null===a&&(40===c.charCodeAt(je)?(a="(",je++):(a=null,0===ke&&e('"("')),null===a&&(41===c.charCodeAt(je)?(a=")",je++):(a=null,0===ke&&e('")"')),null===a&&(42===c.charCodeAt(je)?(a="*",je++):(a=null,0===ke&&e('"*"')),null===a&&(43===c.charCodeAt(je)?(a="+",je++):(a=null,0===ke&&e('"+"')),null===a&&(44===c.charCodeAt(je)?(a=",",je++):(a=null,0===ke&&e('","')),null===a&&(59===c.charCodeAt(je)?(a=";",je++):(a=null,0===ke&&e('";"')),null===a&&(61===c.charCodeAt(je)?(a="=",je++):(a=null,0===ke&&e('"="')))))))))))),a}function $d(){var a,b,d,f,g,h,i;return h=je,a=_d(),null!==a?(58===c.charCodeAt(je)?(b=":",je++):(b=null,0===ke&&e('":"')),null!==b?(d=Wd(),null!==d?(i=je,"?transport="===c.substr(je,11)?(f="?transport=",je+=11):(f=null,0===ke&&e('"?transport="')),null!==f?(g=Ld(),null!==g?f=[f,g]:(f=null,je=i)):(f=null,je=i),f=null!==f?f:"",null!==f?a=[a,b,d,f]:(a=null,je=h)):(a=null,je=h)):(a=null,je=h)):(a=null,je=h),a}function _d(){var a,b;return b=je,"turns"===c.substr(je,5).toLowerCase()?(a=c.substr(je,5),je+=5):(a=null,0===ke&&e('"turns"')),null===a&&("turn"===c.substr(je,4).toLowerCase()?(a=c.substr(je,4),je+=4):(a=null,0===ke&&e('"turn"'))),null!==a&&(a=function(a,b){pe.scheme=b}(b,a)),null===a&&(je=b),a}function ae(){var a,b,d,f,g;if(f=je,g=je,a=Ld(),null!==a){if("udp"===c.substr(je,3).toLowerCase()?(b=c.substr(je,3),je+=3):(b=null,0===ke&&e('"udp"')),null===b&&("tcp"===c.substr(je,3).toLowerCase()?(b=c.substr(je,3),je+=3):(b=null,0===ke&&e('"tcp"')),null===b))for(b=[],d=q();null!==d;)b.push(d),d=q();null!==b?a=[a,b]:(a=null,je=g)}else a=null,je=g;return null!==a&&(a=function(){pe.transport=transport}(f)),null===a&&(je=f),a}function be(){var a,b,d;return d=je,"uuid:"===c.substr(je,5)?(a="uuid:",je+=5):(a=null,0===ke&&e('"uuid:"')),null!==a?(b=ce(),null!==b?a=[a,b]:(a=null,je=d)):(a=null,je=d),a}function ce(){var a,b,d,f,g,h,i,j,k,l,m;return l=je,m=je,a=ee(),null!==a?(45===c.charCodeAt(je)?(b="-",je++):(b=null,0===ke&&e('"-"')),null!==b?(d=de(),null!==d?(45===c.charCodeAt(je)?(f="-",je++):(f=null,0===ke&&e('"-"')),null!==f?(g=de(),null!==g?(45===c.charCodeAt(je)?(h="-",je++):(h=null,0===ke&&e('"-"')),null!==h?(i=de(),null!==i?(45===c.charCodeAt(je)?(j="-",je++):(j=null,0===ke&&e('"-"')),null!==j?(k=fe(),null!==k?a=[a,b,d,f,g,h,i,j,k]:(a=null,je=m)):(a=null,je=m)):(a=null,je=m)):(a=null,je=m)):(a=null,je=m)):(a=null,je=m)):(a=null,je=m)):(a=null,je=m)):(a=null,je=m),null!==a&&(a=function(a){pe=c.substring(je+5,a)}(l,a[0])),null===a&&(je=l),a}function de(){var a,b,c,d,e;return e=je,a=i(),null!==a?(b=i(),null!==b?(c=i(),null!==c?(d=i(),null!==d?a=[a,b,c,d]:(a=null,je=e)):(a=null,je=e)):(a=null,je=e)):(a=null,je=e),a}function ee(){var a,b,c;return c=je,a=de(),null!==a?(b=de(),null!==b?a=[a,b]:(a=null,je=c)):(a=null,je=c),a}function fe(){var a,b,c,d;return d=je,a=de(),null!==a?(b=de(),null!==b?(c=de(),null!==c?a=[a,b,c]:(a=null,je=d)):(a=null,je=d)):(a=null,je=d),a}function ge(a){a.sort();for(var b=null,c=[],d=0;d<a.length;d++)a[d]!==b&&(c.push(a[d]),b=a[d]);return c}function he(){for(var a=1,b=1,d=!1,e=0;e<Math.max(je,le);e++){var f=c.charAt(e);"\n"===f?(d||a++,b=1,d=!1):"\r"===f||"\u2028"===f||"\u2029"===f?(a++,b=1,d=!0):(b++,d=!1)}return{line:a,column:b}}var ie={CRLF:f,DIGIT:g,ALPHA:h,HEXDIG:i,WSP:j,OCTET:k,DQUOTE:l,SP:m,HTAB:n,alphanum:o,reserved:p,unreserved:q,mark:r,escaped:s,LWS:t,SWS:u,HCOLON:v,TEXT_UTF8_TRIM:w,TEXT_UTF8char:x,UTF8_NONASCII:y,UTF8_CONT:z,LHEX:A,token:B,token_nodot:C,separators:D,word:E,STAR:F,SLASH:G,EQUAL:H,LPAREN:I,RPAREN:J,RAQUOT:K,LAQUOT:L,COMMA:M,SEMI:N,COLON:O,LDQUOT:P,RDQUOT:Q,comment:R,ctext:S,quoted_string:T,quoted_string_clean:U,qdtext:V,quoted_pair:W,SIP_URI_noparams:X,SIP_URI:Y,uri_scheme:Z,userinfo:$,user:_,user_unreserved:ab,password:bb,hostport:cb,host:db,hostname:eb,domainlabel:fb,toplabel:gb,IPv6reference:hb,IPv6address:ib,h16:jb,ls32:kb,IPv4address:lb,dec_octet:mb,port:nb,uri_parameters:ob,uri_parameter:pb,transport_param:qb,user_param:rb,method_param:sb,ttl_param:tb,maddr_param:ub,lr_param:vb,other_param:wb,pname:xb,pvalue:yb,paramchar:zb,param_unreserved:Ab,headers:Bb,header:Cb,hname:Db,hvalue:Eb,hnv_unreserved:Fb,Request_Response:Gb,Request_Line:Hb,Request_URI:Ib,absoluteURI:Jb,hier_part:Kb,net_path:Lb,abs_path:Mb,opaque_part:Nb,uric:Ob,uric_no_slash:Pb,path_segments:Qb,segment:Rb,param:Sb,pchar:Tb,scheme:Ub,authority:Vb,srvr:Wb,reg_name:Xb,query:Yb,SIP_Version:Zb,INVITEm:$b,ACKm:_b,OPTIONSm:ac,BYEm:bc,CANCELm:cc,REGISTERm:dc,SUBSCRIBEm:ec,NOTIFYm:fc,Method:gc,Status_Line:hc,Status_Code:ic,extension_code:jc,Reason_Phrase:kc,Allow_Events:lc,Call_ID:mc,Contact:nc,contact_param:oc,name_addr:pc,display_name:qc,contact_params:rc,c_p_q:sc,c_p_expires:tc,delta_seconds:uc,qvalue:vc,generic_param:wc,gen_value:xc,Content_Disposition:yc,disp_type:zc,disp_param:Ac,handling_param:Bc,Content_Encoding:Cc,Content_Length:Dc,Content_Type:Ec,media_type:Fc,m_type:Gc,discrete_type:Hc,composite_type:Ic,extension_token:Jc,x_token:Kc,m_subtype:Lc,m_parameter:Mc,m_value:Nc,CSeq:Oc,CSeq_value:Pc,Expires:Qc,Event:Rc,event_type:Sc,From:Tc,from_param:Uc,tag_param:Vc,Max_Forwards:Wc,Min_Expires:Xc,Name_Addr_Header:Yc,Proxy_Authenticate:Zc,challenge:$c,other_challenge:_c,auth_param:ad,digest_cln:bd,realm:cd,realm_value:dd,domain:ed,URI:fd,nonce:gd,nonce_value:hd,opaque:id,stale:jd,algorithm:kd,qop_options:ld,qop_value:md,Proxy_Require:nd,Record_Route:od,rec_route:pd,Require:qd,Route:rd,route_param:sd,Subscription_State:td,substate_value:ud,subexp_params:vd,event_reason_value:wd,Subject:xd,Supported:yd,To:zd,to_param:Ad,Via:Bd,via_parm:Cd,via_params:Dd,via_ttl:Ed,via_maddr:Fd,via_received:Gd,via_branch:Hd,response_port:Id,sent_protocol:Jd,protocol_name:Kd,transport:Ld,sent_by:Md,via_host:Nd,via_port:Od,ttl:Pd,WWW_Authenticate:Qd,extension_header:Rd,header_value:Sd,message_body:Td,stun_URI:Ud,stun_scheme:Vd,stun_host_port:Wd,stun_host:Xd,reg_name:Xb,stun_unreserved:Yd,sub_delims:Zd,turn_URI:$d,turn_scheme:_d,turn_transport:ae,uuid_URI:be,uuid:ce,hex4:de,hex8:ee,hex12:fe};if(void 0!==d){if(void 0===ie[d])throw new Error("Invalid rule name: "+b(d)+".")}else d="CRLF";var je=0,ke=0,le=0,me=[],ne=a("./URI"),oe=a("./NameAddrHeader"),pe={},qe=ie[d]();if(null===qe||je!==c.length){var re=Math.max(je,le),se=re<c.length?c.charAt(re):null,te=he();return new this.SyntaxError(ge(me),se,re,te.line,te.column),-1}return pe},toSource:function(){return this._source}};return c.SyntaxError=function(a,c,d,e,f){function g(a,c){var d,e;switch(a.length){case 0:d="end of input";break;case 1:d=a[0];break;default:d=a.slice(0,a.length-1).join(", ")+" or "+a[a.length-1]}return e=c?b(c):"end of input","Expected "+d+" but "+e+" found."}this.name="SyntaxError",this.expected=a,this.found=c,this.message=g(a,c),this.offset=d,this.line=e,this.column=f},c.SyntaxError.prototype=Error.prototype,c}()},{"./NameAddrHeader":23,"./URI":36}],21:[function(a,b){var c={C:a("./Constants"),Exceptions:a("./Exceptions"),Utils:a("./Utils"),UA:a("./UA"),URI:a("./URI"),NameAddrHeader:a("./NameAddrHeader"),Grammar:a("./Grammar"),debug:a("debug")};b.exports=c;var d=a("../package.json"),e=a("./RTCSession");Object.defineProperties(c,{name:{get:function(){return d.title}},version:{get:function(){return d.version}},rtcEngine:{set:function(a){e.RTCEngine=a}}})},{"../package.json":14,"./Constants":15,"./Exceptions":19,"./Grammar":20,"./NameAddrHeader":23,"./RTCSession":25,"./UA":35,"./URI":36,"./Utils":37,debug:1}],22:[function(a,b){function c(a){this.ua=a,this.data={},e.EventEmitter.call(this)}b.exports=c;var d=a("util"),e=a("events"),f=a("./Constants"),g=a("./SIPMessage"),h=a("./Utils"),i=a("./RequestSender"),j=a("./Transactions"),k=a("./Exceptions");d.inherits(c,e.EventEmitter),c.prototype.send=function(a,b,c){var d,e,h,j,k,l=a;if(void 0===a||void 0===b)throw new TypeError("Not enough arguments");if(a=this.ua.normalizeTarget(a),!a)throw new TypeError("Invalid target: "+l);c=c||{},k=c.extraHeaders&&c.extraHeaders.slice()||[],j=c.eventHandlers||{},h=c.contentType||"text/plain",this.content_type=h;for(e in j)this.on(e,j[e]);this.closed=!1,this.ua.applicants[this]=this,k.push("Content-Type: "+h),this.request=new g.OutgoingRequest(f.MESSAGE,a,this.ua,null,k),b?(this.request.body=b,this.content=b):this.content=null,d=new i(this,this.ua),this.newMessage("local",this.request),d.send()},c.prototype.receiveResponse=function(a){var b;if(!this.closed)switch(!0){case/^1[0-9]{2}$/.test(a.status_code):break;case/^2[0-9]{2}$/.test(a.status_code):delete this.ua.applicants[this],this.emit("succeeded",{originator:"remote",response:a});break;default:delete this.ua.applicants[this],b=h.sipErrorCause(a.status_code),this.emit("failed",{originator:"remote",response:a,cause:b})}},c.prototype.onRequestTimeout=function(){this.closed||this.emit("failed",{originator:"system",cause:f.causes.REQUEST_TIMEOUT})},c.prototype.onTransportError=function(){this.closed||this.emit("failed",{originator:"system",cause:f.causes.CONNECTION_ERROR})},c.prototype.close=function(){this.closed=!0,delete this.ua.applicants[this]},c.prototype.init_incoming=function(a){var b;this.request=a,this.content_type=a.getHeader("Content-Type"),this.content=a.body?a.body:null,this.newMessage("remote",a),b=this.ua.transactions.nist[a.via_branch],!b||b.state!==j.C.STATUS_TRYING&&b.state!==j.C.STATUS_PROCEEDING||a.reply(200)},c.prototype.accept=function(a){a=a||{};var b=a.extraHeaders&&a.extraHeaders.slice()||[],c=a.body;if("incoming"!==this.direction)throw new k.NotSupportedError('"accept" not supported for outgoing Message');this.request.reply(200,null,b,c)},c.prototype.reject=function(a){a=a||{};var b=a.status_code||480,c=a.reason_phrase,d=a.extraHeaders&&a.extraHeaders.slice()||[],e=a.body;if("incoming"!==this.direction)throw new k.NotSupportedError('"reject" not supported for outgoing Message');if(300>b||b>=700)throw new TypeError("Invalid status_code: "+b);this.request.reply(b,c,d,e)},c.prototype.newMessage=function(a,b){"remote"===a?(this.direction="incoming",this.local_identity=b.to,this.remote_identity=b.from):"local"===a&&(this.direction="outgoing",this.local_identity=b.from,this.remote_identity=b.to),this.ua.newMessage({originator:a,message:this,request:b})}},{"./Constants":15,"./Exceptions":19,"./RequestSender":30,"./SIPMessage":31,"./Transactions":33,"./Utils":37,events:4,util:8}],23:[function(a,b){function c(a,b,c){var e;if(!(a&&a instanceof d))throw new TypeError('missing or invalid "uri" parameter');this.uri=a,this.parameters={};for(e in c)this.setParam(e,c[e]);Object.defineProperties(this,{display_name:{get:function(){return b},set:function(a){b=0===a?"0":a}}})}b.exports=c;var d=a("./URI"),e=a("./Grammar");c.prototype={setParam:function(a,b){a&&(this.parameters[a.toLowerCase()]="undefined"==typeof b||null===b?null:b.toString())},getParam:function(a){return a?this.parameters[a.toLowerCase()]:void 0},hasParam:function(a){return a?this.parameters.hasOwnProperty(a.toLowerCase())&&!0||!1:void 0},deleteParam:function(a){var b;return a=a.toLowerCase(),this.parameters.hasOwnProperty(a)?(b=this.parameters[a],delete this.parameters[a],b):void 0},clearParams:function(){this.parameters={}},clone:function(){return new c(this.uri.clone(),this.display_name,JSON.parse(JSON.stringify(this.parameters)))},toString:function(){var a,b;a=this.display_name||0===this.display_name?'"'+this.display_name+'" ':"",a+="<"+this.uri.toString()+">";for(b in this.parameters)a+=";"+b,null!==this.parameters[b]&&(a+="="+this.parameters[b]);return a}},c.parse=function(a){return a=e.parse(a,"Name_Addr_Header"),-1!==a?a:void 0}},{"./Grammar":20,"./URI":36}],24:[function(a,b){function c(a,b){var c=b,d=0,e=0;if(a.substring(c,c+2).match(/(^\r\n)/))return-2;for(;0===d;){if(e=a.indexOf("\r\n",c),-1===e)return e;!a.substring(e+2,e+4).match(/(^\r\n)/)&&a.charAt(e+2).match(/(^\s+)/)?c=e+2:d=e}return d}function d(a,b,c,d){var e,f,g,j,k=b.indexOf(":",c),l=b.substring(c,k).trim(),m=b.substring(k+1,d).trim();switch(l.toLowerCase()){case"via":case"v":a.addHeader("via",m),1===a.getHeaders("via").length?(j=a.parseHeader("Via"),j&&(a.via=j,a.via_branch=j.branch)):j=0;break;case"from":case"f":a.setHeader("from",m),j=a.parseHeader("from"),j&&(a.from=j,a.from_tag=j.getParam("tag"));break;case"to":case"t":a.setHeader("to",m),j=a.parseHeader("to"),j&&(a.to=j,a.to_tag=j.getParam("tag"));break;case"record-route":for(j=h.parse(m,"Record_Route"),-1===j&&(j=void 0),g=j.length,f=0;g>f;f++)e=j[f],a.addHeader("record-route",m.substring(e.possition,e.offset)),a.headers["Record-Route"][a.getHeaders("record-route").length-1].parsed=e.parsed;break;case"call-id":case"i":a.setHeader("call-id",m),j=a.parseHeader("call-id"),j&&(a.call_id=m);break;case"contact":case"m":for(j=h.parse(m,"Contact"),-1===j&&(j=void 0),g=j.length,f=0;g>f;f++)e=j[f],a.addHeader("contact",m.substring(e.possition,e.offset)),a.headers.Contact[a.getHeaders("contact").length-1].parsed=e.parsed;break;case"content-length":case"l":a.setHeader("content-length",m),j=a.parseHeader("content-length");break;case"content-type":case"c":a.setHeader("content-type",m),j=a.parseHeader("content-type");break;case"cseq":a.setHeader("cseq",m),j=a.parseHeader("cseq"),j&&(a.cseq=j.value),a instanceof i.IncomingResponse&&(a.method=j.method);break;case"max-forwards":a.setHeader("max-forwards",m),j=a.parseHeader("max-forwards");break;case"www-authenticate":a.setHeader("www-authenticate",m),j=a.parseHeader("www-authenticate");break;case"proxy-authenticate":a.setHeader("proxy-authenticate",m),j=a.parseHeader("proxy-authenticate");break;default:a.setHeader(l,m),j=0}return void 0===j?{error:'error parsing header "'+l+'"'}:!0}var e={};b.exports=e;var f=a("debug")("JsSIP:Parser"),g=a("sdp-transform"),h=a("./Grammar"),i=a("./SIPMessage");e.parseMessage=function(a,b){var e,g,j,k,l,m=0,n=a.indexOf("\r\n");if(-1===n)return void f("no CRLF found, not a SIP message");if(g=a.substring(0,n),l=h.parse(g,"Request_Response"),-1===l)return void f('error parsing first line of SIP message: "'+g+'"');for(l.status_code?(e=new i.IncomingResponse,e.status_code=l.status_code,e.reason_phrase=l.reason_phrase):(e=new i.IncomingRequest(b),e.method=l.method,e.ruri=l.uri),e.data=a,m=n+2;;){if(n=c(a,m),-2===n){k=m+2;break}if(-1===n)return void l.error("malformed message");if(l=d(e,a,m,n),l!==!0)return void f(l.error);m=n+2}return e.hasHeader("content-length")?(j=e.getHeader("content-length"),e.body=a.substr(k,j)):e.body=a.substring(k),e},e.parseSDP=g.parse,e.writeSDP=g.write,e.parseFmtpConfig=g.parseFmtpConfig,e.parsePayloads=g.parsePayloads,e.parseRemoteCandidates=g.parseRemoteCandidates},{"./Grammar":20,"./SIPMessage":31,debug:1,"sdp-transform":10}],25:[function(a,b){function c(a){this.ua=a,this.status=d.STATUS_NULL,this.dialog=null,this.earlyDialogs={},this.rtcMediaHandler=null,this.is_confirmed=!1,this.late_sdp=!1,this.timers={ackTimer:null,expiresTimer:null,invite2xxTimer:null,userNoAnswerTimer:null},this.direction=null,this.local_identity=null,this.remote_identity=null,this.start_time=null,this.end_time=null,this.tones=null,this.audioMuted=!1,this.videoMuted=!1,this.local_hold=!1,this.remote_hold=!1,this.pending_actions={actions:[],length:function(){return this.actions.length},isPending:function(a){var b=0,c=this.actions.length;for(b;c>b;b++)if(this.actions[b].name===a)return!0;return!1},shift:function(){return this.actions.shift()},push:function(a){this.actions.push({name:a})},pop:function(a){var b=0,c=this.actions.length;for(b;c>b;b++)this.actions[b].name===a&&this.actions.splice(b,1)}},this.data={},f.EventEmitter.call(this)}b.exports=c;var d={STATUS_NULL:0,STATUS_INVITE_SENT:1,STATUS_1XX_RECEIVED:2,STATUS_INVITE_RECEIVED:3,STATUS_WAITING_FOR_ANSWER:4,STATUS_ANSWERED:5,STATUS_WAITING_FOR_ACK:6,STATUS_CANCELED:7,STATUS_TERMINATED:8,STATUS_CONFIRMED:9};c.C=d;var e=a("util"),f=a("events"),g=a("debug")("JsSIP:RTCSession"),h=a("./Constants"),i=a("./Exceptions"),j=a("./Transactions"),k=a("./Parser"),l=a("./Utils"),m=a("./Timers"),n=a("./UA"),o=a("./WebRTC"),p=a("./SIPMessage"),q=a("./Dialog"),r=a("./RequestSender"),s=a("./RTCSession/Request"),t=a("./RTCSession/DTMF");e.inherits(c,f.EventEmitter),Object.defineProperty(c,"RTCEngine",{get:function(){return c._RTCEngine||a("./RTCSession/RTCMediaHandler")},set:function(a){c._RTCEngine=a}}),c.prototype.terminate=function(a){a=a||{};var b,c,e=a.cause||h.causes.BYE,f=a.status_code,k=a.reason_phrase,l=a.extraHeaders&&a.extraHeaders.slice()||[],m=a.body,n=this;if(this.status===d.STATUS_TERMINATED)throw new i.InvalidStateError(this.status);switch(this.status){case d.STATUS_NULL:case d.STATUS_INVITE_SENT:case d.STATUS_1XX_RECEIVED:if(g("canceling sesssion"),f&&(200>f||f>=700))throw new TypeError("Invalid status_code: "+f);f&&(k=k||h.REASON_PHRASE[f]||"",b="SIP ;cause="+f+' ;text="'+k+'"'),this.status===d.STATUS_NULL?(this.isCanceled=!0,this.cancelReason=b):this.status===d.STATUS_INVITE_SENT?(this.isCanceled=!0,this.cancelReason=b):this.status===d.STATUS_1XX_RECEIVED&&this.request.cancel(b),this.status=d.STATUS_CANCELED,this.failed("local",null,h.causes.CANCELED);break;case d.STATUS_WAITING_FOR_ANSWER:case d.STATUS_ANSWERED:if(g("rejecting session"),f=f||480,300>f||f>=700)throw new TypeError("Invalid status_code: "+f);this.request.reply(f,k,l,m),this.failed("local",null,h.causes.REJECTED);break;case d.STATUS_WAITING_FOR_ACK:case d.STATUS_CONFIRMED:if(g("terminating session"),k=a.reason_phrase||h.REASON_PHRASE[f]||"",f&&(200>f||f>=700))throw new TypeError("Invalid status_code: "+f);f&&l.push("Reason: SIP ;cause="+f+'; text="'+k+'"'),this.status===d.STATUS_WAITING_FOR_ACK&&"incoming"===this.direction&&this.request.server_transaction.state!==j.C.STATUS_TERMINATED?(c=this.dialog,this.receiveRequest=function(a){a.method===h.ACK&&(this.sendRequest(h.BYE,{extraHeaders:l,body:m}),c.terminate())},this.request.server_transaction.on("stateChanged",function(){this.state===j.C.STATUS_TERMINATED&&(n.sendRequest(h.BYE,{extraHeaders:l,body:m}),c.terminate())}),this.ended("local",null,e),this.dialog=c,this.ua.dialogs[c.id.toString()]=c):(this.sendRequest(h.BYE,{extraHeaders:l,body:m}),this.ended("local",null,e))}this.close()},c.prototype.answer=function(a){a=a||{};var b,c,e,f,g=!1,j=!1,l=this,m=this.request,n=a.extraHeaders&&a.extraHeaders.slice()||[],o=a.mediaConstraints||{},p=a.RTCAnswerConstraints||{},q=a.mediaStream||null,r=function(a){l.rtcMediaHandler.addStream(a,t,u)},s=function(){m.reply(480),l.failed("local",null,h.causes.USER_DENIED_MEDIA_ACCESS)},t=function(){l.connecting(m),l.status!==d.STATUS_TERMINATED&&(l.late_sdp?l.rtcMediaHandler.createOffer(v,w,p):l.rtcMediaHandler.createAnswer(v,w,p))},u=function(){l.status!==d.STATUS_TERMINATED&&l.failed("system",null,h.causes.WEBRTC_ERROR)},v=function(a){var b=function(){l.status=d.STATUS_WAITING_FOR_ACK,l.setInvite2xxTimer(m,a),l.setACKTimer(),l.accepted("local")},c=function(){l.failed("system",null,h.causes.CONNECTION_ERROR)};m.reply(200,null,n,a,b,c)},w=function(){l.status!==d.STATUS_TERMINATED&&l.failed("system",null,h.causes.WEBRTC_ERROR)};if(this.data=a.data||{},"incoming"!==this.direction)throw new i.NotSupportedError('"answer" not supported for outgoing RTCSession');if(this.status!==d.STATUS_WAITING_FOR_ANSWER)throw new i.InvalidStateError(this.status);if(this.status=d.STATUS_ANSWERED,!this.createDialog(m,"UAS"))return void m.reply(500,"Missing Contact header field");for(clearTimeout(this.timers.userNoAnswerTimer),n.unshift("Contact: "+l.contact),f=this.rtcMediaHandler.peerConnection.remoteDescription||{},e=k.parseSDP(f.sdp||""),e.media instanceof Array||(e.media=[e.media||[]]),b=e.media.length;b--;)"audio"!==e.media[b].type||"sendrecv"!==e.media[b].direction&&"recvonly"!==e.media[b].direction||(g=!0),"video"!==e.media[b].type||"sendrecv"!==e.media[b].direction&&"recvonly"!==e.media[b].direction||(j=!0);
if(q&&o.audio===!1)for(c=q.getAudioTracks().length,b=0;c>b;b++)q.removeTrack(q.getAudioTracks()[b]);if(q&&o.video===!1)for(c=q.getVideoTracks().length,b=0;c>b;b++)q.removeTrack(q.getVideoTracks()[b]);void 0===o.audio&&(o.audio=g),void 0===o.video&&(o.video=j),q?r(q):this.rtcMediaHandler.getUserMedia(r,s,o)},c.prototype.sendDTMF=function(a,b){var c,e,f=0,h=this;if(b=b||{},c=b.duration||null,e=b.interToneGap||null,void 0===a)throw new TypeError("Not enough arguments");if(this.status!==d.STATUS_CONFIRMED&&this.status!==d.STATUS_WAITING_FOR_ACK)throw new i.InvalidStateError(this.status);if("number"==typeof a&&(a=a.toString()),!a||"string"!=typeof a||!a.match(/^[0-9A-D#*,]+$/i))throw new TypeError("Invalid tones: "+a);if(c&&!l.isDecimal(c))throw new TypeError("Invalid tone duration: "+c);if(c?c<t.C.MIN_DURATION?(g('"duration" value is lower than the minimum allowed, setting it to '+t.C.MIN_DURATION+" milliseconds"),c=t.C.MIN_DURATION):c>t.C.MAX_DURATION?(g('"duration" value is greater than the maximum allowed, setting it to '+t.C.MAX_DURATION+" milliseconds"),c=t.C.MAX_DURATION):c=Math.abs(c):c=t.C.DEFAULT_DURATION,b.duration=c,e&&!l.isDecimal(e))throw new TypeError("Invalid interToneGap: "+e);if(e?e<t.C.MIN_INTER_TONE_GAP?(g('"interToneGap" value is lower than the minimum allowed, setting it to '+t.C.MIN_INTER_TONE_GAP+" milliseconds"),e=t.C.MIN_INTER_TONE_GAP):e=Math.abs(e):e=t.C.DEFAULT_INTER_TONE_GAP,this.tones)return void(this.tones+=a);this.tones=a;var j=function(){var a,g,i=h.tones;if(h.status===d.STATUS_TERMINATED||!i||f>=i.length)return void(h.tones=null);if(a=i[f],f+=1,","===a)g=2e3;else{var k=new t(h);k.on("failed",function(){h.tones=null}),k.send(a,b),g=c+e}setTimeout(j,g)};j()},c.prototype.sendRequest=function(a,b){var c=new s(this);c.send(a,b)},c.prototype.isReadyToReinvite=function(){return this.rtcMediaHandler.isReady()?this.dialog.uac_pending_reply===!0||this.dialog.uas_pending_reply===!0?!1:!0:void 0},c.prototype.mute=function(a){a=a||{audio:!0,video:!1};var b=!1,c=!1;this.audioMuted===!1&&a.audio&&(b=!0,this.audioMuted=!0,this.toogleMuteAudio(!0)),this.videoMuted===!1&&a.video&&(c=!0,this.videoMuted=!0,this.toogleMuteVideo(!0)),(b===!0||c===!0)&&this.onmute({audio:b,video:c})},c.prototype.unmute=function(a){a=a||{audio:!0,video:!0};var b=!1,c=!1;this.audioMuted===!0&&a.audio&&(b=!0,this.audioMuted=!1,this.local_hold===!1&&this.toogleMuteAudio(!1)),this.videoMuted===!0&&a.video&&(c=!0,this.videoMuted=!1,this.local_hold===!1&&this.toogleMuteVideo(!1)),(b===!0||c===!0)&&this.onunmute({audio:b,video:c})},c.prototype.isMuted=function(){return{audio:this.audioMuted,video:this.videoMuted}},c.prototype.hold=function(){if(this.status!==d.STATUS_WAITING_FOR_ACK&&this.status!==d.STATUS_CONFIRMED)throw new i.InvalidStateError(this.status);return this.toogleMuteAudio(!0),this.toogleMuteVideo(!0),this.isReadyToReinvite()?void(this.local_hold!==!0&&(this.onhold("local"),this.sendReinvite({mangle:function(a){var b,c;for(a=k.parseSDP(a),c=a.media.length,b=0;c>b;b++)void 0===a.media[b].direction?a.media[b].direction="sendonly":"sendrecv"===a.media[b].direction?a.media[b].direction="sendonly":"sendonly"===a.media[b].direction&&(a.media[b].direction="inactive");return k.writeSDP(a)}}))):this.pending_actions.isPending("unhold")?void this.pending_actions.pop("unhold"):this.pending_actions.isPending("hold")?void 0:void this.pending_actions.push("hold")},c.prototype.unhold=function(){if(this.status!==d.STATUS_WAITING_FOR_ACK&&this.status!==d.STATUS_CONFIRMED)throw new i.InvalidStateError(this.status);return this.audioMuted||this.toogleMuteAudio(!1),this.videoMuted||this.toogleMuteVideo(!1),this.isReadyToReinvite()?void(this.local_hold!==!1&&(this.onunhold("local"),this.sendReinvite())):this.pending_actions.isPending("hold")?void this.pending_actions.pop("hold"):this.pending_actions.isPending("unhold")?void 0:void this.pending_actions.push("unhold")},c.prototype.isOnHold=function(){return{local:this.local_hold,remote:this.remote_hold}},c.prototype.setInvite2xxTimer=function(a,b){var c=this,e=m.T1;this.timers.invite2xxTimer=setTimeout(function f(){c.status===d.STATUS_WAITING_FOR_ACK&&(a.reply(200,null,["Contact: "+c.contact],b),e<m.T2&&(e=2*e,e>m.T2&&(e=m.T2)),c.timers.invite2xxTimer=setTimeout(f,e))},e)},c.prototype.setACKTimer=function(){var a=this;this.timers.ackTimer=setTimeout(function(){a.status===d.STATUS_WAITING_FOR_ACK&&(g("no ACK received, terminating the session"),clearTimeout(a.timers.invite2xxTimer),a.sendRequest(h.BYE),a.ended("remote",null,h.causes.NO_ACK))},m.TIMER_H)},c.prototype.getLocalStreams=function(){return this.rtcMediaHandler&&this.rtcMediaHandler.peerConnection&&this.rtcMediaHandler.peerConnection.getLocalStreams()||[]},c.prototype.getRemoteStreams=function(){return this.rtcMediaHandler&&this.rtcMediaHandler.peerConnection&&this.rtcMediaHandler.peerConnection.getRemoteStreams()||[]},c.prototype.init_incoming=function(a){var b,e=this,f=a.getHeader("Content-Type"),i=function(){e.status=d.STATUS_WAITING_FOR_ANSWER,e.timers.userNoAnswerTimer=setTimeout(function(){a.reply(408),e.failed("local",null,h.causes.NO_ANSWER)},e.ua.configuration.no_answer_timeout),b&&(e.timers.expiresTimer=setTimeout(function(){e.status===d.STATUS_WAITING_FOR_ANSWER&&(a.reply(487),e.failed("system",null,h.causes.EXPIRES))},b)),e.newRTCSession("remote",a),a.reply(180,null,["Contact: "+e.contact]),e.progress("local",null)};return a.body&&"application/sdp"!==f?void a.reply(415):(this.status=d.STATUS_INVITE_RECEIVED,this.from_tag=a.from_tag,this.id=a.call_id+this.from_tag,this.request=a,this.contact=this.ua.contact.toString(),this.ua.sessions[this.id]=this,a.hasHeader("expires")&&(b=1e3*a.getHeader("expires")),a.to_tag=l.newTag(),this.createDialog(a,"UAS",!0)?(this.rtcMediaHandler=new c.RTCEngine(this,{constraints:{optional:[{DtlsSrtpKeyAgreement:"true"}]}}),void(a.body?this.rtcMediaHandler.onMessage("offer",a.body,i,function(b){g("invalid SDP: "+b),a.reply(488)}):(this.late_sdp=!0,i()))):void a.reply(500,"Missing Contact header field"))},c.prototype.connect=function(a,b){b=b||{};var e,f,g,j=a,k=b.eventHandlers||{},m=b.extraHeaders&&b.extraHeaders.slice()||[],q=b.mediaConstraints||{audio:!0,video:!0},r=b.mediaStream||null,s=b.RTCConstraints||{},t=b.RTCOfferConstraints||{},u=b.stun_servers||null,v=b.turn_servers||null;if(this.data=b.data||{},u){if(g=n.configuration_check.optional.stun_servers(u),!g)throw new TypeError("Invalid stun_servers: "+u);u=g}if(v){if(g=n.configuration_check.optional.turn_servers(v),!g)throw new TypeError("Invalid turn_servers: "+v);v=g}if(void 0===a)throw new TypeError("Not enough arguments");if(!o.isSupported)throw new i.NotSupportedError("WebRTC not supported");if(a=this.ua.normalizeTarget(a),!a)throw new TypeError("Invalid target: "+j);if(this.status!==d.STATUS_NULL)throw new i.InvalidStateError(this.status);for(e in k)this.on(e,k[e]);this.from_tag=l.newTag(),this.anonymous=b.anonymous||!1,this.isCanceled=!1,f={from_tag:this.from_tag},this.contact=this.ua.contact.toString({anonymous:this.anonymous,outbound:!0}),this.anonymous&&(f.from_display_name="Anonymous",f.from_uri="sip:anonymous@anonymous.invalid",m.push("P-Preferred-Identity: "+this.ua.configuration.uri.toString()),m.push("Privacy: id")),m.push("Contact: "+this.contact),m.push("Content-Type: application/sdp"),this.request=new p.OutgoingRequest(h.INVITE,a,this.ua,f,m),this.id=this.request.call_id+this.from_tag,this.rtcMediaHandler=new c.RTCEngine(this,{constraints:s,stun_servers:u,turn_servers:v}),this.ua.sessions[this.id]=this,this.newRTCSession("local",this.request),this.sendInitialRequest(q,t,r)},c.prototype.close=function(){var a;if(this.status!==d.STATUS_TERMINATED){g("closing INVITE session "+this.id),this.rtcMediaHandler&&this.rtcMediaHandler.close();for(a in this.timers)clearTimeout(this.timers[a]);this.dialog&&(this.dialog.terminate(),delete this.dialog);for(a in this.earlyDialogs)this.earlyDialogs[a].terminate(),delete this.earlyDialogs[a];this.status=d.STATUS_TERMINATED,delete this.ua.sessions[this.id]}},c.prototype.createDialog=function(a,b,c){var d,e,f="UAS"===b?a.to_tag:a.from_tag,i="UAS"===b?a.from_tag:a.to_tag,j=a.call_id+f+i;return e=this.earlyDialogs[j],c?e?!0:(e=new q(this,a,b,q.C.STATUS_EARLY),e.error?(g(d.error),this.failed("remote",a,h.causes.INTERNAL_ERROR),!1):(this.earlyDialogs[j]=e,!0)):e?(e.update(a,b),this.dialog=e,delete this.earlyDialogs[j],!0):(d=new q(this,a,b),d.error?(g(d.error),this.failed("remote",a,h.causes.INTERNAL_ERROR),!1):(this.to_tag=a.to_tag,this.dialog=d,!0))},c.prototype.receiveReinvite=function(a){var b,c,e,f=this,h=a.getHeader("Content-Type"),i=!1,j=function(a,b){f.late_sdp?f.rtcMediaHandler.createOffer(a,b):f.rtcMediaHandler.createAnswer(a,b)},l=function(){j(function(b){a.reply(200,null,["Contact: "+f.contact],b,function(){f.status=d.STATUS_WAITING_FOR_ACK,f.setInvite2xxTimer(a,b),f.setACKTimer(),f.remote_hold===!0&&i===!1?f.onunhold("remote"):f.remote_hold===!1&&i===!0&&f.onhold("remote")})},function(){a.reply(500)})};if(a.body){if("application/sdp"!==h)return g("invalid Content-Type"),void a.reply(415);for(b=k.parseSDP(a.body),c=0;c<b.media.length;c++)e=b.direction||b.media[c].direction||"sendrecv",("sendonly"===e||"inactive"===e)&&(i=!0);this.rtcMediaHandler.onMessage("offer",a.body,l,function(b){g(b),a.reply(488)})}else this.late_sdp=!0,l()},c.prototype.receiveUpdate=function(a){var b,c,d,e=this,f=a.getHeader("Content-Type"),h=!0;if(!a.body)return void a.reply(200);if("application/sdp"!==f)return g("invalid Content-Type"),void a.reply(415);for(b=k.parseSDP(a.body),c=0;c<b.media.length;c++)d=b.direction||b.media[c].direction||"sendrecv","sendonly"!==d&&"inactive"!==d&&(h=!1);this.rtcMediaHandler.onMessage("offer",a.body,function(){e.rtcMediaHandler.createAnswer(function(b){a.reply(200,null,["Contact: "+e.contact],b,function(){e.remote_hold===!0&&h===!1?e.onunhold("remote"):e.remote_hold===!1&&h===!0&&e.onhold("remote")})},function(){a.reply(500)})},function(b){g(b),a.reply(488)})},c.prototype.receiveRequest=function(a){var b,c=this;if(a.method===h.CANCEL)(this.status===d.STATUS_WAITING_FOR_ANSWER||this.status===d.STATUS_ANSWERED)&&(this.status=d.STATUS_CANCELED,this.request.reply(487),this.failed("remote",a,h.causes.CANCELED));else switch(a.method){case h.ACK:if(this.status===d.STATUS_WAITING_FOR_ACK){if(clearTimeout(this.timers.ackTimer),clearTimeout(this.timers.invite2xxTimer),this.late_sdp){if(!a.body){c.ended("remote",a,h.causes.MISSING_SDP);break}this.rtcMediaHandler.onMessage("answer",a.body,function(){c.late_sdp=!1,c.status=d.STATUS_CONFIRMED},function(b){g(b),c.ended("remote",a,h.causes.BAD_MEDIA_DESCRIPTION)})}else this.status=d.STATUS_CONFIRMED;this.status!==d.STATUS_CONFIRMED||this.is_confirmed||this.confirmed("remote",a)}break;case h.BYE:this.status===d.STATUS_CONFIRMED?(a.reply(200),this.ended("remote",a,h.causes.BYE)):this.status===d.STATUS_INVITE_RECEIVED?(a.reply(200),this.request.reply(487,"BYE Received"),this.ended("remote",a,h.causes.BYE)):a.reply(403,"Wrong Status");break;case h.INVITE:this.status===d.STATUS_CONFIRMED?(g("re-INVITE received"),this.receiveReinvite(a)):a.reply(403,"Wrong Status");break;case h.INFO:this.status===d.STATUS_CONFIRMED||this.status===d.STATUS_WAITING_FOR_ACK||this.status===d.STATUS_INVITE_RECEIVED?(b=a.getHeader("content-type"),b&&b.match(/^application\/dtmf-relay/i)?new t(this).init_incoming(a):a.reply(415)):a.reply(403,"Wrong Status");break;case h.UPDATE:this.status===d.STATUS_CONFIRMED?(g("UPDATE received"),this.receiveUpdate(a)):a.reply(403,"Wrong Status");break;default:a.reply(501)}},c.prototype.sendInitialRequest=function(a,b,c){var e=this,f=new r(e,this.ua),g=function(a){e.rtcMediaHandler.addStream(a,j,k)},i=function(){e.status!==d.STATUS_TERMINATED&&e.failed("local",null,h.causes.USER_DENIED_MEDIA_ACCESS)},j=function(){e.connecting(e.request),e.status!==d.STATUS_TERMINATED&&e.rtcMediaHandler.createOffer(l,m,b)},k=function(){e.status!==d.STATUS_TERMINATED&&e.failed("system",null,h.causes.WEBRTC_ERROR)},l=function(a){e.isCanceled||e.status===d.STATUS_TERMINATED||(e.request.body=a,e.status=d.STATUS_INVITE_SENT,f.send())},m=function(){e.status!==d.STATUS_TERMINATED&&e.failed("system",null,h.causes.WEBRTC_ERROR)};this.receiveResponse=this.receiveInviteResponse,c?g(c):this.rtcMediaHandler.getUserMedia(g,i,a)},c.prototype.sendReinvite=function(a){a=a||{};var b=this,c=a.extraHeaders||[],d=a.eventHandlers||{},e=a.mangle||null;this.reinviteSucceeded=d.succeeded?d.succeeded:function(){},this.reinviteFailed=d.failed?d.failed:function(){},c.push("Contact: "+this.contact),c.push("Content-Type: application/sdp"),this.receiveResponse=this.receiveReinviteResponse,this.rtcMediaHandler.createOffer(function(a){e&&(a=e(a)),b.dialog.sendRequest(b,h.INVITE,{extraHeaders:c,body:a})},function(){b.isReadyToReinvite()&&b.onReadyToReinvite(),b.reinviteFailed()})},c.prototype.receiveInviteResponse=function(a){var b,c,e=this;if(this.dialog&&a.status_code>=200&&a.status_code<=299)return this.dialog.id.call_id===a.call_id&&this.dialog.id.local_tag===a.from_tag&&this.dialog.id.remote_tag===a.to_tag?void this.sendRequest(h.ACK):(c=new q(this,a,"UAC"),void 0!==c.error?void g(c.error):(c.sendRequest({owner:{status:d.STATUS_TERMINATED},onRequestTimeout:function(){},onTransportError:function(){},onDialogError:function(){},receiveResponse:function(){}},h.ACK),void c.sendRequest({owner:{status:d.STATUS_TERMINATED},onRequestTimeout:function(){},onTransportError:function(){},onDialogError:function(){},receiveResponse:function(){}},h.BYE)));if(this.isCanceled)return this.isCanceled=!1,void(a.status_code>=100&&a.status_code<200?this.request.cancel(this.cancelReason):a.status_code>=200&&a.status_code<299&&this.acceptAndTerminate(a));if(this.status===d.STATUS_INVITE_SENT||this.status===d.STATUS_1XX_RECEIVED)switch(!0){case/^100$/.test(a.status_code):break;case/^1[0-9]{2}$/.test(a.status_code):if(this.status!==d.STATUS_INVITE_SENT&&this.status!==d.STATUS_1XX_RECEIVED)break;if(!a.to_tag){g("1xx response received without to tag");break}if(a.hasHeader("contact")&&!this.createDialog(a,"UAC",!0))break;if(this.status=d.STATUS_1XX_RECEIVED,this.progress("remote",a),!a.body)break;this.rtcMediaHandler.onMessage("pranswer",a.body,function(){},function(b){g(b),e.earlyDialogs[a.call_id+a.from_tag+a.to_tag].terminate()});break;case/^2[0-9]{2}$/.test(a.status_code):if(this.status=d.STATUS_CONFIRMED,!a.body){this.acceptAndTerminate(a,400,h.causes.MISSING_SDP),this.failed("remote",a,h.causes.BAD_MEDIA_DESCRIPTION);break}if(!this.createDialog(a,"UAC"))break;this.rtcMediaHandler.onMessage("answer",a.body,function(){e.accepted("remote",a),e.sendRequest(h.ACK),e.confirmed("local",null)},function(b){g(b),e.acceptAndTerminate(a,488,"Not Acceptable Here"),e.failed("remote",a,h.causes.BAD_MEDIA_DESCRIPTION)});break;default:b=l.sipErrorCause(a.status_code),this.failed("remote",a,b)}},c.prototype.receiveReinviteResponse=function(a){var b=this,c=a.getHeader("Content-Type");if(this.status!==d.STATUS_TERMINATED)switch(!0){case/^1[0-9]{2}$/.test(a.status_code):break;case/^2[0-9]{2}$/.test(a.status_code):if(this.status=d.STATUS_CONFIRMED,this.sendRequest(h.ACK),!a.body){this.reinviteFailed();break}if("application/sdp"!==c){this.reinviteFailed();break}this.rtcMediaHandler.onMessage("answer",a.body,function(){b.reinviteSucceeded()},function(){b.reinviteFailed()});break;default:this.reinviteFailed()}},c.prototype.acceptAndTerminate=function(a,b,c){var e=[];b&&(c=c||h.REASON_PHRASE[b]||"",e.push("Reason: SIP ;cause="+b+'; text="'+c+'"')),(this.dialog||this.createDialog(a,"UAC"))&&(this.sendRequest(h.ACK),this.sendRequest(h.BYE,{extraHeaders:e})),this.status=d.STATUS_TERMINATED},c.prototype.toogleMuteAudio=function(a){var b,c,d,e=this.getLocalStreams();for(b in e){d=e[b].getAudioTracks();for(c in d)d[c].enabled=!a}},c.prototype.toogleMuteVideo=function(a){var b,c,d,e=this.getLocalStreams();for(b in e){d=e[b].getVideoTracks();for(c in d)d[c].enabled=!a}},c.prototype.onTransportError=function(){this.status!==d.STATUS_TERMINATED&&(this.status===d.STATUS_CONFIRMED?this.ended("system",null,h.causes.CONNECTION_ERROR):this.failed("system",null,h.causes.CONNECTION_ERROR))},c.prototype.onRequestTimeout=function(){this.status!==d.STATUS_TERMINATED&&(this.status===d.STATUS_CONFIRMED?this.ended("system",null,h.causes.REQUEST_TIMEOUT):this.failed("system",null,h.causes.REQUEST_TIMEOUT))},c.prototype.onDialogError=function(a){this.status!==d.STATUS_TERMINATED&&(this.status===d.STATUS_CONFIRMED?this.ended("remote",a,h.causes.DIALOG_ERROR):this.failed("remote",a,h.causes.DIALOG_ERROR))},c.prototype.newRTCSession=function(a,b){"remote"===a?(this.direction="incoming",this.local_identity=b.to,this.remote_identity=b.from):"local"===a&&(this.direction="outgoing",this.local_identity=b.from,this.remote_identity=b.to),this.ua.newRTCSession({originator:a,session:this,request:b})},c.prototype.connecting=function(a){this.emit("connecting",{request:a})},c.prototype.progress=function(a,b){this.emit("progress",{originator:a,response:b||null})},c.prototype.accepted=function(a,b){this.start_time=new Date,this.emit("accepted",{originator:a,response:b||null})},c.prototype.confirmed=function(a,b){this.is_confirmed=!0,this.emit("confirmed",{originator:a,ack:b||null})},c.prototype.ended=function(a,b,c){this.end_time=new Date,this.close(),this.emit("ended",{originator:a,message:b||null,cause:c})},c.prototype.failed=function(a,b,c){this.close(),this.emit("failed",{originator:a,message:b||null,cause:c})},c.prototype.newDTMF=function(a){this.emit("newDTMF",a)},c.prototype.onhold=function(a){"local"===a?this.local_hold=!0:this.remote_hold=!0,this.emit("hold",{originator:a})},c.prototype.onunhold=function(a){"local"===a?this.local_hold=!1:this.remote_hold=!1,this.emit("unhold",{originator:a})},c.prototype.onmute=function(a){this.emit("muted",{audio:a.audio,video:a.video})},c.prototype.onunmute=function(a){this.emit("unmuted",{audio:a.audio,video:a.video})},c.prototype.onReadyToReinvite=function(){var a=this.pending_actions.length()>0?this.pending_actions.shift():null;a&&("hold"===a.name?this.hold():"unhold"===a.name&&this.unhold())}},{"./Constants":15,"./Dialog":16,"./Exceptions":19,"./Parser":24,"./RTCSession/DTMF":26,"./RTCSession/RTCMediaHandler":27,"./RTCSession/Request":28,"./RequestSender":30,"./SIPMessage":31,"./Timers":32,"./Transactions":33,"./UA":35,"./Utils":37,"./WebRTC":38,debug:1,events:4,util:8}],26:[function(a,b){function c(a){this.owner=a,this.direction=null,this.tone=null,this.duration=null,f.EventEmitter.call(this)}b.exports=c;var d={MIN_DURATION:70,MAX_DURATION:6e3,DEFAULT_DURATION:100,MIN_INTER_TONE_GAP:50,DEFAULT_INTER_TONE_GAP:500};c.C=d;var e=a("util"),f=a("events"),g=a("debug")("JsSIP:RTCSession:DTMF"),h=a("../Constants"),i=a("../Exceptions"),j=a("../RTCSession"),k=a("../Utils");e.inherits(c,f.EventEmitter),c.prototype.send=function(a,b){var c,d,e,f;if(void 0===a)throw new TypeError("Not enough arguments");if(this.direction="outgoing",this.owner.status!==j.C.STATUS_CONFIRMED&&this.owner.status!==j.C.STATUS_WAITING_FOR_ACK)throw new i.InvalidStateError(this.owner.status);if(b=b||{},e=b.extraHeaders?b.extraHeaders.slice():[],d=b.eventHandlers||{},"string"==typeof a)a=a.toUpperCase();else{if("number"!=typeof a)throw new TypeError("Invalid tone: "+a);a=a.toString()}if(!a.match(/^[0-9A-D#*]$/))throw new TypeError("Invalid tone: "+a);this.tone=a,this.duration=b.duration;for(c in d)this.on(c,d[c]);e.push("Content-Type: application/dtmf-relay"),f="Signal= "+this.tone+"\r\n",f+="Duration= "+this.duration,this.owner.newDTMF({originator:"local",dtmf:this,request:this.request}),this.owner.dialog.sendRequest(this,h.INFO,{extraHeaders:e,body:f})},c.prototype.receiveResponse=function(a){var b;switch(!0){case/^1[0-9]{2}$/.test(a.status_code):break;case/^2[0-9]{2}$/.test(a.status_code):this.emit("succeeded",{originator:"remote",response:a});break;default:b=k.sipErrorCause(a.status_code),this.emit("failed",{originator:"remote",response:a,cause:b})}},c.prototype.onRequestTimeout=function(){this.emit("failed",{originator:"system",cause:h.causes.REQUEST_TIMEOUT}),this.owner.onRequestTimeout()},c.prototype.onTransportError=function(){this.emit("failed",{originator:"system",cause:h.causes.CONNECTION_ERROR}),this.owner.onTransportError()},c.prototype.onDialogError=function(a){this.emit("failed",{originator:"remote",response:a,cause:h.causes.DIALOG_ERROR}),this.owner.onDialogError(a)},c.prototype.init_incoming=function(a){var b,c=/^(Signal\s*?=\s*?)([0-9A-D#*]{1})(\s)?.*/,d=/^(Duration\s?=\s?)([0-9]{1,4})(\s)?.*/;this.direction="incoming",this.request=a,a.reply(200),a.body&&(b=a.body.split("\r\n"),2===b.length&&(c.test(b[0])&&(this.tone=b[0].replace(c,"$2")),d.test(b[1])&&(this.duration=parseInt(b[1].replace(d,"$2"),10)))),this.tone&&this.duration?this.owner.newDTMF({originator:"remote",dtmf:this,request:a}):g("invalid INFO DTMF received, discarded")}},{"../Constants":15,"../Exceptions":19,"../RTCSession":25,"../Utils":37,debug:1,events:4,util:8}],27:[function(a,b){function c(a,b){b=b||{},this.session=a,this.localMedia=null,this.peerConnection=null,this.ready=!0,this.init(b)}b.exports=c;var d=a("debug")("JsSIP:RTCSession:RTCMediaHandler"),e=a("../Constants"),f=a("../WebRTC");c.prototype={isReady:function(){return this.ready},createOffer:function(a,b,c){function e(){"complete"===f.peerConnection.iceGatheringState?(f.ready=!0,a(f.peerConnection.localDescription.sdp)):f.onIceCompleted=function(){f.onIceCompleted=void 0,f.ready=!0,a(f.peerConnection.localDescription.sdp)}}var f=this;this.ready=!1,this.peerConnection.createOffer(function(a){f.setLocalDescription(a,e,function(a){f.ready=!0,b(a)})},function(a){f.ready=!0,d("unable to create offer"),d(a),b(a)},c)},createAnswer:function(a,b,c){function e(){"complete"===f.peerConnection.iceGatheringState?(f.ready=!0,a(f.peerConnection.localDescription.sdp)):f.onIceCompleted=function(){f.onIceCompleted=void 0,f.ready=!0,a(f.peerConnection.localDescription.sdp)}}var f=this;this.ready=!1,this.peerConnection.createAnswer(function(a){f.setLocalDescription(a,e,function(a){f.ready=!0,b(a)})},function(a){f.ready=!0,d("unable to create answer"),d(a),b(a)},c)},setLocalDescription:function(a,b,c){this.peerConnection.setLocalDescription(a,b,function(a){d("unable to set local description"),d(a),c(a)})},addStream:function(a,b,c,e){try{this.peerConnection.addStream(a,e)}catch(f){return d("error adding stream"),d(f),void c()}b()},init:function(a){a=a||{};var b,c,g,h=this,i=[],j=a.constraints||{},k=a.stun_servers||null,l=a.turn_servers||null,m=this.session.ua.configuration;for(k||(k=m.stun_servers),l||(l=m.turn_servers),k.length>0&&i.push({url:k}),c=l.length,b=0;c>b;b++)g=l[b],i.push({url:g.urls,username:g.username,credential:g.credential});this.peerConnection=new f.RTCPeerConnection({iceServers:i},j),this.peerConnection.onaddstream=function(a){d("stream added: "+a.stream.id)},this.peerConnection.onremovestream=function(a){d("stream removed: "+a.stream.id)},this.peerConnection.onicecandidate=function(a){a.candidate?d("ICE candidate received: "+a.candidate.candidate):void 0!==h.onIceCompleted&&h.onIceCompleted()},this.peerConnection.oniceconnectionstatechange=function(){d('ICE connection state changed to "'+this.iceConnectionState+'"'),"failed"===this.iceConnectionState&&h.session.terminate({cause:e.causes.RTP_TIMEOUT,status_code:200,reason_phrase:e.causes.RTP_TIMEOUT})},this.peerConnection.onstatechange=function(){d('PeerConnection state changed to "'+this.readyState+'"')}},close:function(){d("closing PeerConnection"),this.peerConnection&&(this.peerConnection.close(),this.localMedia&&this.localMedia.stop())},getUserMedia:function(a,b,c){var e=this;d("requesting access to local media"),f.getUserMedia(c,function(b){d("got local media stream"),e.localMedia=b,a(b)},function(a){d("unable to get user media"),d(a),b()})},onMessage:function(a,b,c,d){this.peerConnection.setRemoteDescription(new f.RTCSessionDescription({type:a,sdp:b}),c,d)}}},{"../Constants":15,"../WebRTC":38,debug:1}],28:[function(a,b){function c(a){this.owner=a,e.EventEmitter.call(this)}b.exports=c;var d=a("util"),e=a("events"),f=a("../Constants"),g=a("../Exceptions"),h=a("../RTCSession"),i=a("../Utils");d.inherits(c,e.EventEmitter),c.prototype.send=function(a,b){b=b||{};var c,d=b.extraHeaders&&b.extraHeaders.slice()||[],e=b.eventHandlers||{},i=b.body||null;if(void 0===a)throw new TypeError("Not enough arguments");if(this.owner.status!==h.C.STATUS_1XX_RECEIVED&&this.owner.status!==h.C.STATUS_WAITING_FOR_ANSWER&&this.owner.status!==h.C.STATUS_WAITING_FOR_ACK&&this.owner.status!==h.C.STATUS_CONFIRMED&&this.owner.status!==h.C.STATUS_TERMINATED)throw new g.InvalidStateError(this.owner.status);if(this.owner.status===h.C.STATUS_TERMINATED&&a!==f.BYE)throw new g.InvalidStateError(this.owner.status);for(c in e)this.on(c,e[c]);this.owner.dialog.sendRequest(this,a,{extraHeaders:d,body:i})},c.prototype.receiveResponse=function(a){var b;switch(!0){case/^1[0-9]{2}$/.test(a.status_code):this.emit("progress",{originator:"remote",response:a});break;case/^2[0-9]{2}$/.test(a.status_code):this.emit("succeeded",{originator:"remote",response:a});break;default:b=i.sipErrorCause(a.status_code),this.emit("failed",{originator:"remote",response:a,cause:b})}},c.prototype.onRequestTimeout=function(){this.emit("failed",{originator:"system",cause:f.causes.REQUEST_TIMEOUT}),this.owner.onRequestTimeout()},c.prototype.onTransportError=function(){this.emit("failed",{originator:"system",cause:f.causes.CONNECTION_ERROR}),this.owner.onTransportError()},c.prototype.onDialogError=function(a){this.emit("failed",{originator:"remote",response:a,cause:f.causes.DIALOG_ERROR}),this.owner.onDialogError(a)}},{"../Constants":15,"../Exceptions":19,"../RTCSession":25,"../Utils":37,events:4,util:8}],29:[function(a,b){function c(a,b){var c=1;this.ua=a,this.transport=b,this.registrar=a.configuration.registrar_server,this.expires=a.configuration.register_expires,this.call_id=e.createRandomToken(22),this.cseq=0,this.to_uri=a.configuration.uri,this.registrationTimer=null,this.registered=!1,this.contact=this.ua.contact.toString(),this.contact+=";+sip.ice",this.extraHeaders=[],this.extraContactParams="",c&&(this.contact+=";reg-id="+c,this.contact+=';+sip.instance="<urn:uuid:'+this.ua.configuration.instance_id+'>"')}b.exports=c;var d=a("debug")("JsSIP:Registrator"),e=a("./Utils"),f=a("./Constants"),g=a("./SIPMessage"),h=a("./RequestSender");c.prototype={setExtraHeaders:function(a){!a instanceof Array&&(a=[]),this.extraHeaders=a.slice()},setExtraContactParams:function(a){!a instanceof Object&&(a={}),this.extraContactParams="";for(var b in a){var c=a[b];this.extraContactParams+=";"+b,c&&(this.extraContactParams+="="+c)}},register:function(){var a,b,c,i=this;c=this.extraHeaders.slice(),c.push("Contact: "+this.contact+";expires="+this.expires+this.extraContactParams),c.push("Expires: "+this.expires),this.request=new g.OutgoingRequest(f.REGISTER,this.registrar,this.ua,{to_uri:this.to_uri,call_id:this.call_id,cseq:this.cseq+=1},c),a=new h(this,this.ua),this.receiveResponse=function(a){var c,g,h=a.getHeaders("contact").length;if(a.cseq===this.cseq)switch(null!==this.registrationTimer&&(clearTimeout(this.registrationTimer),this.registrationTimer=null),!0){case/^1[0-9]{2}$/.test(a.status_code):break;case/^2[0-9]{2}$/.test(a.status_code):if(a.hasHeader("expires")&&(g=a.getHeader("expires")),!h){d("no Contact header in response to REGISTER, response ignored");break}for(;h--;){if(c=a.parseHeader("contact",h),c.uri.user===this.ua.contact.uri.user){g=c.getParam("expires");break}c=null}if(!c){d("no Contact header pointing to us, response ignored");break}g||(g=this.expires),this.registrationTimer=setTimeout(function(){i.registrationTimer=null,i.register()},1e3*g-3e3),c.hasParam("temp-gruu")&&(this.ua.contact.temp_gruu=c.getParam("temp-gruu").replace(/"/g,"")),c.hasParam("pub-gruu")&&(this.ua.contact.pub_gruu=c.getParam("pub-gruu").replace(/"/g,"")),this.registered||(this.registered=!0,this.ua.registered({response:a}));break;case/^423$/.test(a.status_code):a.hasHeader("min-expires")?(this.expires=a.getHeader("min-expires"),this.register()):(d("423 response received for REGISTER without Min-Expires"),this.registrationFailure(a,f.causes.SIP_FAILURE_CODE));break;default:b=e.sipErrorCause(a.status_code),this.registrationFailure(a,b)}},this.onRequestTimeout=function(){this.registrationFailure(null,f.causes.REQUEST_TIMEOUT)},this.onTransportError=function(){this.registrationFailure(null,f.causes.CONNECTION_ERROR)},a.send()},unregister:function(a){var b;if(!this.registered)return void d("already unregistered");a=a||{},this.registered=!1,null!==this.registrationTimer&&(clearTimeout(this.registrationTimer),this.registrationTimer=null),b=this.extraHeaders.slice(),a.all?(b.push("Contact: *"+this.extraContactParams),b.push("Expires: 0"),this.request=new g.OutgoingRequest(f.REGISTER,this.registrar,this.ua,{to_uri:this.to_uri,call_id:this.call_id,cseq:this.cseq+=1},b)):(b.push("Contact: "+this.contact+";expires=0"+this.extraContactParams),b.push("Expires: 0"),this.request=new g.OutgoingRequest(f.REGISTER,this.registrar,this.ua,{to_uri:this.to_uri,call_id:this.call_id,cseq:this.cseq+=1},b));var c=new h(this,this.ua);this.receiveResponse=function(a){var b;switch(!0){case/^1[0-9]{2}$/.test(a.status_code):break;case/^2[0-9]{2}$/.test(a.status_code):this.unregistered(a);break;default:b=e.sipErrorCause(a.status_code),this.unregistered(a,b)}},this.onRequestTimeout=function(){this.unregistered(null,f.causes.REQUEST_TIMEOUT)},this.onTransportError=function(){this.unregistered(null,f.causes.CONNECTION_ERROR)},c.send()},registrationFailure:function(a,b){this.ua.registrationFailed({response:a||null,cause:b}),this.registered&&(this.registered=!1,this.ua.unregistered({response:a||null,cause:b}))},unregistered:function(a,b){this.registered=!1,this.ua.unregistered({response:a||null,cause:b||null})},onTransportClosed:function(){null!==this.registrationTimer&&(clearTimeout(this.registrationTimer),this.registrationTimer=null),this.registered&&(this.registered=!1,this.ua.unregistered({}))},close:function(){this.registered&&this.unregister()}}},{"./Constants":15,"./RequestSender":30,"./SIPMessage":31,"./Utils":37,debug:1}],30:[function(a,b){function c(a,b){this.ua=b,this.applicant=a,this.method=a.request.method,this.request=a.request,this.credentials=null,this.challenged=!1,this.staled=!1,b.status!==f.C.STATUS_USER_CLOSED||this.method===e.BYE&&this.method===e.ACK||this.onTransportError()}b.exports=c;var d=a("debug")("JsSIP:RequestSender"),e=a("./Constants"),f=a("./UA"),g=a("./DigestAuthentication"),h=a("./Transactions");c.prototype={send:function(){switch(this.method){case"INVITE":this.clientTransaction=new h.InviteClientTransaction(this,this.request,this.ua.transport);break;case"ACK":this.clientTransaction=new h.AckClientTransaction(this,this.request,this.ua.transport);break;default:this.clientTransaction=new h.NonInviteClientTransaction(this,this.request,this.ua.transport)}this.clientTransaction.send()},onRequestTimeout:function(){this.applicant.onRequestTimeout()},onTransportError:function(){this.applicant.onTransportError()},receiveResponse:function(a){var b,c,f,h=a.status_code;if(401!==h&&407!==h||null===this.ua.configuration.password)this.applicant.receiveResponse(a);else{if(401===a.status_code?(c=a.parseHeader("www-authenticate"),f="authorization"):(c=a.parseHeader("proxy-authenticate"),f="proxy-authorization"),!c)return d(a.status_code+" with wrong or missing challenge, cannot authenticate"),void this.applicant.receiveResponse(a);if(!this.challenged||!this.staled&&c.stale===!0){if(this.credentials||(this.credentials=new g(this.ua)),!this.credentials.authenticate(this.request,c))return void this.applicant.receiveResponse(a);this.challenged=!0,c.stale&&(this.staled=!0),a.method===e.REGISTER?b=this.applicant.cseq+=1:this.request.dialog?b=this.request.dialog.local_seqnum+=1:(b=this.request.cseq+1,this.request.cseq=b),this.request.setHeader("cseq",b+" "+this.method),this.request.setHeader(f,this.credentials.toString()),this.send()
}else this.applicant.receiveResponse(a)}}}},{"./Constants":15,"./DigestAuthentication":18,"./Transactions":33,"./UA":35,debug:1}],31:[function(a,b){function c(a,b,c,d,e,f){var g,k,l,m;return d=d||{},a&&b&&c?(this.ua=c,this.headers={},this.method=a,this.ruri=b,this.body=f,this.extraHeaders=e&&e.slice()||[],d.route_set?this.setHeader("route",d.route_set):c.configuration.use_preloaded_route&&this.setHeader("route",c.transport.server.sip_uri),this.setHeader("via",""),this.setHeader("max-forwards",h.MAX_FORWARDS),g=d.to_display_name||0===d.to_display_name?'"'+d.to_display_name+'" ':"",g+="<"+(d.to_uri||b)+">",g+=d.to_tag?";tag="+d.to_tag:"",this.to=new j.parse(g),this.setHeader("to",g),k=d.from_display_name||0===d.from_display_name?'"'+d.from_display_name+'" ':c.configuration.display_name?'"'+c.configuration.display_name+'" ':"",k+="<"+(d.from_uri||c.configuration.uri)+">;tag=",k+=d.from_tag||i.newTag(),this.from=new j.parse(k),this.setHeader("from",k),l=d.call_id||c.configuration.jssip_id+i.createRandomToken(15),this.call_id=l,this.setHeader("call-id",l),m=d.cseq||Math.floor(1e4*Math.random()),this.cseq=m,void this.setHeader("cseq",m+" "+a)):null}function d(){this.data=null,this.headers=null,this.method=null,this.via=null,this.via_branch=null,this.call_id=null,this.cseq=null,this.from=null,this.from_tag=null,this.to=null,this.to_tag=null,this.body=null}function e(a){this.ua=a,this.headers={},this.ruri=null,this.transport=null,this.server_transaction=null}function f(){this.headers={},this.status_code=null,this.reason_phrase=null}b.exports={OutgoingRequest:c,IncomingRequest:e,IncomingResponse:f};var g=a("debug")("JsSIP:SIPMessage"),h=a("./Constants"),i=a("./Utils"),j=a("./NameAddrHeader"),k=a("./Grammar");c.prototype={setHeader:function(a,b){this.headers[i.headerize(a)]=b instanceof Array?b:[b]},getHeader:function(a){var b,c,d=this.extraHeaders.length,e=this.headers[i.headerize(a)];if(e){if(e[0])return e[0]}else for(b=new RegExp("^\\s*"+a+"\\s*:","i"),c=0;d>c;c++)if(e=this.extraHeaders[c],b.test(e))return e.substring(e.indexOf(":")+1).trim()},getHeaders:function(a){var b,c,d,e=this.headers[i.headerize(a)],f=[];if(e){for(c=e.length,b=0;c>b;b++)f.push(e[b]);return f}for(c=this.extraHeaders.length,d=new RegExp("^\\s*"+a+"\\s*:","i"),b=0;c>b;b++)e=this.extraHeaders[b],d.test(e)&&f.push(e.substring(e.indexOf(":")+1).trim());return f},hasHeader:function(a){var b,c,d=this.extraHeaders.length;if(this.headers[i.headerize(a)])return!0;for(b=new RegExp("^\\s*"+a+"\\s*:","i"),c=0;d>c;c++)if(b.test(this.extraHeaders[c]))return!0;return!1},toString:function(){var a,b,c,d="",e=[];d+=this.method+" "+this.ruri+" SIP/2.0\r\n";for(a in this.headers)for(b=this.headers[a].length,c=0;b>c;c++)d+=a+": "+this.headers[a][c]+"\r\n";for(b=this.extraHeaders.length,c=0;b>c;c++)d+=this.extraHeaders[c].trim()+"\r\n";switch(this.method){case h.REGISTER:e.push("path","gruu");break;case h.INVITE:(this.ua.contact.pub_gruu||this.ua.contact.temp_gruu)&&e.push("gruu")}return e.push("outbound"),d+="Allow: "+h.ALLOWED_METHODS+"\r\n",d+="Supported: "+e+"\r\n",d+="User-Agent: "+h.USER_AGENT+"\r\n",this.body?(b=i.str_utf8_length(this.body),d+="Content-Length: "+b+"\r\n\r\n",d+=this.body):d+="Content-Length: 0\r\n\r\n",d}},d.prototype={addHeader:function(a,b){var c={raw:b};a=i.headerize(a),this.headers[a]?this.headers[a].push(c):this.headers[a]=[c]},getHeader:function(a){var b=this.headers[i.headerize(a)];if(b)return b[0]?b[0].raw:void 0},getHeaders:function(a){var b,c,d=this.headers[i.headerize(a)],e=[];if(!d)return[];for(c=d.length,b=0;c>b;b++)e.push(d[b].raw);return e},hasHeader:function(a){return this.headers[i.headerize(a)]?!0:!1},parseHeader:function(a,b){var c,d,e;return a=i.headerize(a),b=b||0,this.headers[a]?b>=this.headers[a].length?void g('not so many "'+a+'" headers present'):(c=this.headers[a][b],d=c.raw,c.parsed?c.parsed:(e=k.parse(d,a.replace(/-/g,"_")),-1===e?(this.headers[a].splice(b,1),void g('error parsing "'+a+'" header field with value "'+d+'"')):(c.parsed=e,e))):void g('header "'+a+'" not present')},s:function(a,b){return this.parseHeader(a,b)},setHeader:function(a,b){var c={raw:b};this.headers[i.headerize(a)]=[c]},toString:function(){return this.data}},e.prototype=new d,e.prototype.reply=function(a,b,c,d,e,f){var g,j,k,l,m,n=[],o=this.getHeader("To"),p=0,q=0;if(a=a||null,b=b||null,!a||100>a||a>699)throw new TypeError("Invalid status_code: "+a);if(b&&"string"!=typeof b&&!(b instanceof String))throw new TypeError("Invalid reason_phrase: "+b);if(b=b||h.REASON_PHRASE[a]||"",c=c&&c.slice()||[],m="SIP/2.0 "+a+" "+b+"\r\n",this.method===h.INVITE&&a>100&&200>=a)for(g=this.getHeaders("record-route"),k=g.length,p;k>p;p++)m+="Record-Route: "+g[p]+"\r\n";for(j=this.getHeaders("via"),k=j.length,q;k>q;q++)m+="Via: "+j[q]+"\r\n";for(!this.to_tag&&a>100?o+=";tag="+i.newTag():this.to_tag&&!this.s("to").hasParam("tag")&&(o+=";tag="+this.to_tag),m+="To: "+o+"\r\n",m+="From: "+this.getHeader("From")+"\r\n",m+="Call-ID: "+this.call_id+"\r\n",m+="CSeq: "+this.cseq+" "+this.method+"\r\n",k=c.length,l=0;k>l;l++)m+=c[l].trim()+"\r\n";switch(this.method){case h.INVITE:(this.ua.contact.pub_gruu||this.ua.contact.temp_gruu)&&n.push("gruu")}n.push("outbound"),this.method===h.OPTIONS?(m+="Allow: "+h.ALLOWED_METHODS+"\r\n",m+="Accept: "+h.ACCEPTED_BODY_TYPES+"\r\n"):405===a?m+="Allow: "+h.ALLOWED_METHODS+"\r\n":415===a&&(m+="Accept: "+h.ACCEPTED_BODY_TYPES+"\r\n"),m+="Supported: "+n+"\r\n",d?(k=i.str_utf8_length(d),m+="Content-Type: application/sdp\r\n",m+="Content-Length: "+k+"\r\n\r\n",m+=d):m+="Content-Length: 0\r\n\r\n",this.server_transaction.receiveResponse(a,m,e,f)},e.prototype.reply_sl=function(a,b){var c,d,e=0,f=this.getHeaders("via"),g=f.length;if(a=a||null,b=b||null,!a||100>a||a>699)throw new TypeError("Invalid status_code: "+a);if(b&&"string"!=typeof b&&!(b instanceof String))throw new TypeError("Invalid reason_phrase: "+b);for(b=b||h.REASON_PHRASE[a]||"",d="SIP/2.0 "+a+" "+b+"\r\n",e;g>e;e++)d+="Via: "+f[e]+"\r\n";c=this.getHeader("To"),!this.to_tag&&a>100?c+=";tag="+i.newTag():this.to_tag&&!this.s("to").hasParam("tag")&&(c+=";tag="+this.to_tag),d+="To: "+c+"\r\n",d+="From: "+this.getHeader("From")+"\r\n",d+="Call-ID: "+this.call_id+"\r\n",d+="CSeq: "+this.cseq+" "+this.method+"\r\n",d+="Content-Length: 0\r\n\r\n",this.transport.send(d)},f.prototype=new d},{"./Constants":15,"./Grammar":20,"./NameAddrHeader":23,"./Utils":37,debug:1}],32:[function(a,b){var c=500,d=4e3,e=5e3,f={T1:c,T2:d,T4:e,TIMER_B:64*c,TIMER_D:0*c,TIMER_F:64*c,TIMER_H:64*c,TIMER_I:0*c,TIMER_J:0*c,TIMER_K:0*e,TIMER_L:64*c,TIMER_M:64*c,PROVISIONAL_RESPONSE_INTERVAL:6e4};b.exports=f},{}],33:[function(a,b){function c(a,b,c){var d,e;this.type=i.NON_INVITE_CLIENT,this.transport=c,this.id="z9hG4bK"+Math.floor(1e7*Math.random()),this.request_sender=a,this.request=b,e=a.ua.configuration.hack_via_tcp?"TCP":a.ua.configuration.hack_via_ws?"WS":c.server.scheme,d="SIP/2.0/"+e,d+=" "+a.ua.configuration.via_host+";branch="+this.id,this.request.setHeader("via",d),this.request_sender.ua.newTransaction(this),k.EventEmitter.call(this)}function d(a,b,c){var d,e,f=this;this.type=i.INVITE_CLIENT,this.transport=c,this.id="z9hG4bK"+Math.floor(1e7*Math.random()),this.request_sender=a,this.request=b,e=a.ua.configuration.hack_via_tcp?"TCP":a.ua.configuration.hack_via_ws?"WS":c.server.scheme,d="SIP/2.0/"+e,d+=" "+a.ua.configuration.via_host+";branch="+this.id,this.request.setHeader("via",d),this.request_sender.ua.newTransaction(this),this.request.cancel=function(a){f.cancel_request(f,a)},k.EventEmitter.call(this)}function e(a,b,c){var d,e;this.transport=c,this.id="z9hG4bK"+Math.floor(1e7*Math.random()),this.request_sender=a,this.request=b,e=a.ua.configuration.hack_via_tcp?"TCP":a.ua.configuration.hack_via_ws?"WS":c.server.scheme,d="SIP/2.0/"+e,d+=" "+a.ua.configuration.via_host+";branch="+this.id,this.request.setHeader("via",d),k.EventEmitter.call(this)}function f(a,b){this.type=i.NON_INVITE_SERVER,this.id=a.via_branch,this.request=a,this.transport=a.transport,this.ua=b,this.last_response="",a.server_transaction=this,this.state=i.STATUS_TRYING,b.newTransaction(this),k.EventEmitter.call(this)}function g(a,b){this.type=i.INVITE_SERVER,this.id=a.via_branch,this.request=a,this.transport=a.transport,this.ua=b,this.last_response="",a.server_transaction=this,this.state=i.STATUS_PROCEEDING,b.newTransaction(this),this.resendProvisionalTimer=null,a.reply(100),k.EventEmitter.call(this)}function h(a,b){var c;switch(b.method){case q.INVITE:if(c=a.transactions.ist[b.via_branch]){switch(c.state){case i.STATUS_PROCEEDING:c.transport.send(c.last_response);break;case i.STATUS_ACCEPTED:}return!0}break;case q.ACK:if(c=a.transactions.ist[b.via_branch],!c)return!1;if(c.state===i.STATUS_ACCEPTED)return!1;if(c.state===i.STATUS_COMPLETED)return c.state=i.STATUS_CONFIRMED,c.I=setTimeout(function(){c.timer_I()},r.TIMER_I),!0;break;case q.CANCEL:return c=a.transactions.ist[b.via_branch],c?(b.reply_sl(200),c.state===i.STATUS_PROCEEDING?!1:!0):(b.reply_sl(481),!0);default:if(c=a.transactions.nist[b.via_branch]){switch(c.state){case i.STATUS_TRYING:break;case i.STATUS_PROCEEDING:case i.STATUS_COMPLETED:c.transport.send(c.last_response)}return!0}}}b.exports={C:null,NonInviteClientTransaction:c,InviteClientTransaction:d,AckClientTransaction:e,NonInviteServerTransaction:f,InviteServerTransaction:g,checkTransaction:h};var i={STATUS_TRYING:1,STATUS_PROCEEDING:2,STATUS_CALLING:3,STATUS_ACCEPTED:4,STATUS_COMPLETED:5,STATUS_TERMINATED:6,STATUS_CONFIRMED:7,NON_INVITE_CLIENT:"nict",NON_INVITE_SERVER:"nist",INVITE_CLIENT:"ict",INVITE_SERVER:"ist"};b.exports.C=i;var j=a("util"),k=a("events"),l=a("debug")("JsSIP:NonInviteClientTransaction"),m=a("debug")("JsSIP:InviteClientTransaction"),n=a("debug")("JsSIP:AckClientTransaction"),o=a("debug")("JsSIP:NonInviteServerTransaction"),p=a("debug")("JsSIP:InviteServerTransaction"),q=a("./Constants"),r=a("./Timers");j.inherits(c,k.EventEmitter),c.prototype.stateChanged=function(a){this.state=a,this.emit("stateChanged")},c.prototype.send=function(){var a=this;this.stateChanged(i.STATUS_TRYING),this.F=setTimeout(function(){a.timer_F()},r.TIMER_F),this.transport.send(this.request)||this.onTransportError()},c.prototype.onTransportError=function(){l("transport error occurred, deleting transaction "+this.id),clearTimeout(this.F),clearTimeout(this.K),this.stateChanged(i.STATUS_TERMINATED),this.request_sender.ua.destroyTransaction(this),this.request_sender.onTransportError()},c.prototype.timer_F=function(){l("Timer F expired for transaction "+this.id),this.stateChanged(i.STATUS_TERMINATED),this.request_sender.ua.destroyTransaction(this),this.request_sender.onRequestTimeout()},c.prototype.timer_K=function(){this.stateChanged(i.STATUS_TERMINATED),this.request_sender.ua.destroyTransaction(this)},c.prototype.receiveResponse=function(a){var b=this,c=a.status_code;if(200>c)switch(this.state){case i.STATUS_TRYING:case i.STATUS_PROCEEDING:this.stateChanged(i.STATUS_PROCEEDING),this.request_sender.receiveResponse(a)}else switch(this.state){case i.STATUS_TRYING:case i.STATUS_PROCEEDING:this.stateChanged(i.STATUS_COMPLETED),clearTimeout(this.F),408===c?this.request_sender.onRequestTimeout():this.request_sender.receiveResponse(a),this.K=setTimeout(function(){b.timer_K()},r.TIMER_K);break;case i.STATUS_COMPLETED:}},j.inherits(d,k.EventEmitter),d.prototype.stateChanged=function(a){this.state=a,this.emit("stateChanged")},d.prototype.send=function(){var a=this;this.stateChanged(i.STATUS_CALLING),this.B=setTimeout(function(){a.timer_B()},r.TIMER_B),this.transport.send(this.request)||this.onTransportError()},d.prototype.onTransportError=function(){m("transport error occurred, deleting transaction "+this.id),clearTimeout(this.B),clearTimeout(this.D),clearTimeout(this.M),this.state!==i.STATUS_ACCEPTED&&this.request_sender.onTransportError(),this.stateChanged(i.STATUS_TERMINATED),this.request_sender.ua.destroyTransaction(this)},d.prototype.timer_M=function(){m("Timer M expired for transaction "+this.id),this.state===i.STATUS_ACCEPTED&&(clearTimeout(this.B),this.stateChanged(i.STATUS_TERMINATED),this.request_sender.ua.destroyTransaction(this))},d.prototype.timer_B=function(){m("Timer B expired for transaction "+this.id),this.state===i.STATUS_CALLING&&(this.stateChanged(i.STATUS_TERMINATED),this.request_sender.ua.destroyTransaction(this),this.request_sender.onRequestTimeout())},d.prototype.timer_D=function(){m("Timer D expired for transaction "+this.id),clearTimeout(this.B),this.stateChanged(i.STATUS_TERMINATED),this.request_sender.ua.destroyTransaction(this)},d.prototype.sendACK=function(a){var b=this;this.ack="ACK "+this.request.ruri+" SIP/2.0\r\n",this.ack+="Via: "+this.request.headers.Via.toString()+"\r\n",this.request.headers.Route&&(this.ack+="Route: "+this.request.headers.Route.toString()+"\r\n"),this.ack+="To: "+a.getHeader("to")+"\r\n",this.ack+="From: "+this.request.headers.From.toString()+"\r\n",this.ack+="Call-ID: "+this.request.headers["Call-ID"].toString()+"\r\n",this.ack+="CSeq: "+this.request.headers.CSeq.toString().split(" ")[0],this.ack+=" ACK\r\n",this.ack+="Content-Length: 0\r\n\r\n",this.D=setTimeout(function(){b.timer_D()},r.TIMER_D),this.transport.send(this.ack)},d.prototype.cancel_request=function(a,b){var c=a.request;this.cancel=q.CANCEL+" "+c.ruri+" SIP/2.0\r\n",this.cancel+="Via: "+c.headers.Via.toString()+"\r\n",this.request.headers.Route&&(this.cancel+="Route: "+c.headers.Route.toString()+"\r\n"),this.cancel+="To: "+c.headers.To.toString()+"\r\n",this.cancel+="From: "+c.headers.From.toString()+"\r\n",this.cancel+="Call-ID: "+c.headers["Call-ID"].toString()+"\r\n",this.cancel+="CSeq: "+c.headers.CSeq.toString().split(" ")[0]+" CANCEL\r\n",b&&(this.cancel+="Reason: "+b+"\r\n"),this.cancel+="Content-Length: 0\r\n\r\n",this.state===i.STATUS_PROCEEDING&&this.transport.send(this.cancel)},d.prototype.receiveResponse=function(a){var b=this,c=a.status_code;if(c>=100&&199>=c)switch(this.state){case i.STATUS_CALLING:this.stateChanged(i.STATUS_PROCEEDING),this.request_sender.receiveResponse(a);break;case i.STATUS_PROCEEDING:this.request_sender.receiveResponse(a)}else if(c>=200&&299>=c)switch(this.state){case i.STATUS_CALLING:case i.STATUS_PROCEEDING:this.stateChanged(i.STATUS_ACCEPTED),this.M=setTimeout(function(){b.timer_M()},r.TIMER_M),this.request_sender.receiveResponse(a);break;case i.STATUS_ACCEPTED:this.request_sender.receiveResponse(a)}else if(c>=300&&699>=c)switch(this.state){case i.STATUS_CALLING:case i.STATUS_PROCEEDING:this.stateChanged(i.STATUS_COMPLETED),this.sendACK(a),this.request_sender.receiveResponse(a);break;case i.STATUS_COMPLETED:this.sendACK(a)}},j.inherits(e,k.EventEmitter),e.prototype.send=function(){this.transport.send(this.request)||this.onTransportError()},e.prototype.onTransportError=function(){n("transport error occurred for transaction "+this.id),this.request_sender.onTransportError()},j.inherits(f,k.EventEmitter),f.prototype.stateChanged=function(a){this.state=a,this.emit("stateChanged")},f.prototype.timer_J=function(){o("Timer J expired for transaction "+this.id),this.stateChanged(i.STATUS_TERMINATED),this.ua.destroyTransaction(this)},f.prototype.onTransportError=function(){this.transportError||(this.transportError=!0,o("transport error occurred, deleting transaction "+this.id),clearTimeout(this.J),this.stateChanged(i.STATUS_TERMINATED),this.ua.destroyTransaction(this))},f.prototype.receiveResponse=function(a,b,c,d){var e=this;if(100===a)switch(this.state){case i.STATUS_TRYING:this.stateChanged(i.STATUS_PROCEEDING),this.transport.send(b)||this.onTransportError();break;case i.STATUS_PROCEEDING:this.last_response=b,this.transport.send(b)?c&&c():(this.onTransportError(),d&&d())}else if(a>=200&&699>=a)switch(this.state){case i.STATUS_TRYING:case i.STATUS_PROCEEDING:this.stateChanged(i.STATUS_COMPLETED),this.last_response=b,this.J=setTimeout(function(){e.timer_J()},r.TIMER_J),this.transport.send(b)?c&&c():(this.onTransportError(),d&&d());break;case i.STATUS_COMPLETED:}},j.inherits(g,k.EventEmitter),g.prototype.stateChanged=function(a){this.state=a,this.emit("stateChanged")},g.prototype.timer_H=function(){p("Timer H expired for transaction "+this.id),this.state===i.STATUS_COMPLETED&&p("ACK not received, dialog will be terminated"),this.stateChanged(i.STATUS_TERMINATED),this.ua.destroyTransaction(this)},g.prototype.timer_I=function(){this.stateChanged(i.STATUS_TERMINATED),this.ua.destroyTransaction(this)},g.prototype.timer_L=function(){p("Timer L expired for transaction "+this.id),this.state===i.STATUS_ACCEPTED&&(this.stateChanged(i.STATUS_TERMINATED),this.ua.destroyTransaction(this))},g.prototype.onTransportError=function(){this.transportError||(this.transportError=!0,p("transport error occurred, deleting transaction "+this.id),null!==this.resendProvisionalTimer&&(clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null),clearTimeout(this.L),clearTimeout(this.H),clearTimeout(this.I),this.stateChanged(i.STATUS_TERMINATED),this.ua.destroyTransaction(this))},g.prototype.resend_provisional=function(){this.transport.send(this.last_response)||this.onTransportError()},g.prototype.receiveResponse=function(a,b,c,d){var e=this;if(a>=100&&199>=a)switch(this.state){case i.STATUS_PROCEEDING:this.transport.send(b)||this.onTransportError(),this.last_response=b}if(a>100&&199>=a&&this.state===i.STATUS_PROCEEDING)null===this.resendProvisionalTimer&&(this.resendProvisionalTimer=setInterval(function(){e.resend_provisional()},r.PROVISIONAL_RESPONSE_INTERVAL));else if(a>=200&&299>=a)switch(this.state){case i.STATUS_PROCEEDING:this.stateChanged(i.STATUS_ACCEPTED),this.last_response=b,this.L=setTimeout(function(){e.timer_L()},r.TIMER_L),null!==this.resendProvisionalTimer&&(clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null);case i.STATUS_ACCEPTED:this.transport.send(b)?c&&c():(this.onTransportError(),d&&d())}else if(a>=300&&699>=a)switch(this.state){case i.STATUS_PROCEEDING:null!==this.resendProvisionalTimer&&(clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null),this.transport.send(b)?(this.stateChanged(i.STATUS_COMPLETED),this.H=setTimeout(function(){e.timer_H()},r.TIMER_H),c&&c()):(this.onTransportError(),d&&d())}}},{"./Constants":15,"./Timers":32,debug:1,events:4,util:8}],34:[function(a,b){function c(a,b){this.ua=a,this.ws=null,this.server=b,this.reconnection_attempts=0,this.closed=!1,this.connected=!1,this.reconnectTimer=null,this.lastTransportError={},this.node_ws_options=this.ua.configuration.node_ws_options,this.node_ws_options.headers={"User-Agent":f.USER_AGENT}}b.exports=c;var d={STATUS_READY:0,STATUS_DISCONNECTED:1,STATUS_ERROR:2};c.C=d;var e=a("debug")("JsSIP:Transport"),f=a("./Constants"),g=a("./Parser"),h=a("./UA"),i=a("./SIPMessage"),j=a("./sanityCheck"),k=a("ws");c.prototype={connect:function(){var a=this;if(this.ws&&(this.ws.readyState===this.ws.OPEN||this.ws.readyState===this.ws.CONNECTING))return e("WebSocket "+this.server.ws_uri+" is already connected"),!1;this.ws&&this.ws.close(),e("connecting to WebSocket "+this.server.ws_uri),this.ua.onTransportConnecting(this,0===this.reconnection_attempts?1:this.reconnection_attempts);try{this.ws=new k(this.server.ws_uri,"sip",this.node_ws_options),this.ws.binaryType="arraybuffer",this.ws.onopen=function(){a.onOpen()},this.ws.onclose=function(b){a.onClose(b)},this.ws.onmessage=function(b){a.onMessage(b)},this.ws.onerror=function(b){a.onError(b)}}catch(b){e("error connecting to WebSocket "+this.server.ws_uri+": "+b),this.lastTransportError.code=null,this.lastTransportError.reason=b.message,this.ua.onTransportError(this)}},disconnect:function(){this.ws&&(clearTimeout(this.reconnectTimer),this.closed=!0,e("closing WebSocket "+this.server.ws_uri),this.ws.close()),null!==this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null,this.ua.onTransportDisconnected({transport:this,code:this.lastTransportError.code,reason:this.lastTransportError.reason}))},send:function(a){var b=a.toString();return this.ws&&this.ws.readyState===this.ws.OPEN?(e("sending WebSocket message:\n\n"+b+"\n"),this.ws.send(b),!0):(e("unable to send message, WebSocket is not open"),!1)},onOpen:function(){this.connected=!0,e("WebSocket "+this.server.ws_uri+" connected"),null!==this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.reconnection_attempts=0,this.closed=!1,this.ua.onTransportConnected(this)},onClose:function(a){var b=this.connected;this.connected=!1,this.lastTransportError.code=a.code,this.lastTransportError.reason=a.reason,e("WebSocket disconnected (code: "+a.code+(a.reason?"| reason: "+a.reason:"")+")"),a.wasClean===!1&&e("WebSocket abrupt disconnection"),b===!0?(this.ua.onTransportClosed(this),this.closed?this.ua.emit("disconnected",this.ua,{transport:this,code:this.lastTransportError.code,reason:this.lastTransportError.reason}):this.reConnect()):this.ua.onTransportError(this)},onMessage:function(a){var b,c,d=a.data;if("\r\n"===d)return void e("received WebSocket message with CRLF Keep Alive response");if("string"!=typeof d){try{d=String.fromCharCode.apply(null,new Uint8Array(d))}catch(k){return void e("received WebSocket binary message failed to be converted into string, message discarded")}e("received WebSocket binary message:\n\n"+d+"\n")}else e("received WebSocket text message:\n\n"+d+"\n");if(b=g.parseMessage(d,this.ua),b&&!(this.ua.status===h.C.STATUS_USER_CLOSED&&b instanceof i.IncomingRequest)&&j(b,this.ua,this))if(b instanceof i.IncomingRequest)b.transport=this,this.ua.receiveRequest(b);else if(b instanceof i.IncomingResponse)switch(b.method){case f.INVITE:c=this.ua.transactions.ict[b.via_branch],c&&c.receiveResponse(b);break;case f.ACK:break;default:c=this.ua.transactions.nict[b.via_branch],c&&c.receiveResponse(b)}},onError:function(a){e("WebSocket connection error: "+a)},reConnect:function(){var a=this;this.reconnection_attempts+=1,this.reconnection_attempts>this.ua.configuration.ws_server_max_reconnection?(e("maximum reconnection attempts for WebSocket "+this.server.ws_uri),this.ua.onTransportError(this)):(e("trying to reconnect to WebSocket "+this.server.ws_uri+" (reconnection attempt "+this.reconnection_attempts+")"),this.reconnectTimer=setTimeout(function(){a.connect(),a.reconnectTimer=null},1e3*this.ua.configuration.ws_server_reconnection_timeout))}}},{"./Constants":15,"./Parser":24,"./SIPMessage":31,"./UA":35,"./sanityCheck":39,debug:1,ws:13}],35:[function(a,b){function c(a){if(this.cache={credentials:{}},this.configuration={},this.dynConfiguration={},this.dialogs={},this.applicants={},this.sessions={},this.transport=null,this.contact=null,this.status=d.STATUS_INIT,this.error=null,this.transactions={nist:{},nict:{},ist:{},ict:{}},this.data={},this.transportRecoverAttempts=0,this.transportRecoveryTimer=null,Object.defineProperties(this,{transactionsCount:{get:function(){var a,b=["nist","nict","ist","ict"],c=0;for(a in b)c+=Object.keys(this.transactions[b[a]]).length;return c}},nictTransactionsCount:{get:function(){return Object.keys(this.transactions.nict).length}},nistTransactionsCount:{get:function(){return Object.keys(this.transactions.nist).length}},ictTransactionsCount:{get:function(){return Object.keys(this.transactions.ict).length}},istTransactionsCount:{get:function(){return Object.keys(this.transactions.ist).length}}}),void 0===a)throw new TypeError("Not enough arguments");try{this.loadConfig(a)}catch(b){throw this.status=d.STATUS_NOT_READY,this.error=d.CONFIGURATION_ERROR,b}this._registrator=new i(this),f.EventEmitter.call(this)}b.exports=c;var d={STATUS_INIT:0,STATUS_READY:1,STATUS_USER_CLOSED:2,STATUS_NOT_READY:3,CONFIGURATION_ERROR:1,NETWORK_ERROR:2};c.C=d;var e=a("util"),f=a("events"),g=a("debug")("JsSIP:UA"),h=a("./Constants"),i=a("./Registrator"),j=a("./RTCSession"),k=a("./Message"),l=a("./Transport"),m=a("./Transactions"),m=a("./Transactions"),n=a("./Utils"),o=a("./WebRTC"),p=a("./Exceptions"),q=a("./URI"),r=a("./Grammar");e.inherits(c,f.EventEmitter),c.prototype.start=function(){var a;g("user requested startup"),this.status===d.STATUS_INIT?(a=this.getNextWsServer(),this.transport=new l(this,a),this.transport.connect()):this.status===d.STATUS_USER_CLOSED?(g("restarting UA"),this.status=d.STATUS_READY,this.transport.connect()):g(this.status===d.STATUS_READY?"UA is in READY status, not restarted":"ERROR: connection is down, Auto-Recovery system is trying to reconnect"),this.dynConfiguration.register=this.configuration.register},c.prototype.register=function(){this.dynConfiguration.register=!0,this._registrator.register()},c.prototype.unregister=function(a){this.dynConfiguration.register=!1,this._registrator.unregister(a)},c.prototype.registrator=function(){return this._registrator},c.prototype.isRegistered=function(){return this._registrator.registered?!0:!1},c.prototype.isConnected=function(){return this.transport?this.transport.connected:!1},c.prototype.call=function(a,b){var c;c=new j(this),c.connect(a,b)},c.prototype.sendMessage=function(a,b,c){var d;d=new k(this),d.send(a,b,c)},c.prototype.terminateSessions=function(a){for(var b in this.sessions)this.sessions[b].state!==j.C.STATUS_TERMINATED&&this.sessions[b].terminate(a)},c.prototype.stop=function(){var a,b,c,e=this;if(g("user requested closure"),this.dynConfiguration={},this.status===d.STATUS_USER_CLOSED)return void g("UA already closed");clearTimeout(this.transportRecoveryTimer),this._registrator.close(),c=Object.keys(this.sessions).length;for(a in this.sessions)g("closing session "+a),this.sessions[a].terminate();for(b in this.applicants)this.applicants[b].close();this.status=d.STATUS_USER_CLOSED,0===this.nistTransactionsCount&&0===this.nictTransactionsCount&&0===c?e.transport.disconnect():setTimeout(function(){e.transport.disconnect()},2e3)},c.prototype.normalizeTarget=function(a){return n.normalizeTarget(a,this.configuration.hostport_params)},c.prototype.saveCredentials=function(a){this.cache.credentials[a.realm]=this.cache.credentials[a.realm]||{},this.cache.credentials[a.realm][a.uri]=a},c.prototype.getCredentials=function(a){var b,c;return b=a.ruri.host,this.cache.credentials[b]&&this.cache.credentials[b][a.ruri]&&(c=this.cache.credentials[b][a.ruri],c.method=a.method),c},c.prototype.onTransportClosed=function(a){var b,c,d,e=["nict","ict","nist","ist"];for(a.server.status=l.C.STATUS_DISCONNECTED,g("connection state set to "+l.C.STATUS_DISCONNECTED),d=e.length,b=0;d>b;b++)for(c in this.transactions[e[b]])this.transactions[e[b]][c].onTransportError();this.emit("disconnected")},c.prototype.onTransportError=function(a){var b;g("transport "+a.server.ws_uri+" failed | connection state set to "+l.C.STATUS_ERROR),a.server.status=l.C.STATUS_ERROR,this.emit("disconnected",{transport:a,code:a.lastTransportError.code,reason:a.lastTransportError.reason}),this.status!==d.STATUS_USER_CLOSED&&(b=this.getNextWsServer(),b?(this.transport=new l(this,b),this.transport.connect()):(this.closeSessionsOnTransportError(),this.error&&this.error===d.NETWORK_ERROR||(this.status=d.STATUS_NOT_READY,this.error=d.NETWORK_ERROR),this.recoverTransport()))},c.prototype.onTransportConnected=function(a){this.transport=a,this.transportRecoverAttempts=0,a.server.status=l.C.STATUS_READY,g("connection state set to "+l.C.STATUS_READY),this.status!==d.STATUS_USER_CLOSED&&(this.status=d.STATUS_READY,this.error=null,this.emit("connected",{transport:a}),this.dynConfiguration.register&&this._registrator.register())},c.prototype.onTransportConnecting=function(a,b){this.emit("connecting",{transport:a,attempts:b})},c.prototype.onTransportDisconnected=function(a){this.emit("disconnected",a)},c.prototype.newTransaction=function(a){this.transactions[a.type][a.id]=a,this.emit("newTransaction",{transaction:a})},c.prototype.destroyTransaction=function(a){delete this.transactions[a.type][a.id],this.emit("transactionDestroyed",{transaction:a})},c.prototype.newMessage=function(a){this.emit("newMessage",a)},c.prototype.newRTCSession=function(a){this.emit("newRTCSession",a)},c.prototype.registered=function(a){this.emit("registered",a)},c.prototype.unregistered=function(a){this.emit("unregistered",a)},c.prototype.registrationFailed=function(a){this.emit("registrationFailed",a)},c.prototype.receiveRequest=function(a){var b,c,d,e=a.method;if(a.ruri.user!==this.configuration.uri.user&&a.ruri.user!==this.contact.uri.user)return g("Request-URI does not point to us"),void(a.method!==h.ACK&&a.reply_sl(404));if(a.ruri.scheme===h.SIPS)return void a.reply_sl(416);if(!m.checkTransaction(this,a)){if(e===h.INVITE?new m.InviteServerTransaction(a,this):e!==h.ACK&&e!==h.CANCEL&&new m.NonInviteServerTransaction(a,this),e===h.OPTIONS)a.reply(200);else if(e===h.MESSAGE){if(0===this.listeners("newMessage").length)return void a.reply(405);d=new k(this),d.init_incoming(a)}else if(e===h.INVITE&&0===this.listeners("newRTCSession").length)return void a.reply(405);if(a.to_tag)b=this.findDialog(a),b?b.receiveRequest(a):e===h.NOTIFY?(c=this.findSession(a),c?c.receiveRequest(a):(g("received NOTIFY request for a non existent subscription"),a.reply(481,"Subscription does not exist"))):e!==h.ACK&&a.reply(481);else switch(e){case h.INVITE:o.isSupported?(c=new j(this),c.init_incoming(a)):(g("INVITE received but WebRTC is not supported"),a.reply(488));break;case h.BYE:a.reply(481);break;case h.CANCEL:c=this.findSession(a),c?c.receiveRequest(a):g("received CANCEL request for a non existent session");break;case h.ACK:break;default:a.reply(405)}}},c.prototype.findSession=function(a){var b=a.call_id+a.from_tag,c=this.sessions[b],d=a.call_id+a.to_tag,e=this.sessions[d];return c?c:e?e:null},c.prototype.findDialog=function(a){var b=a.call_id+a.from_tag+a.to_tag,c=this.dialogs[b];return c?c:(b=a.call_id+a.to_tag+a.from_tag,c=this.dialogs[b],c?c:null)},c.prototype.getNextWsServer=function(){var a,b,c,d=[];for(b=this.configuration.ws_servers.length,a=0;b>a;a++)c=this.configuration.ws_servers[a],c.status!==l.C.STATUS_ERROR&&(0===d.length?d.push(c):c.weight>d[0].weight?d=[c]:c.weight===d[0].weight&&d.push(c));return a=Math.floor(Math.random()*d.length),d[a]},c.prototype.closeSessionsOnTransportError=function(){var a;for(a in this.sessions)this.sessions[a].onTransportError();this._registrator.onTransportClosed()},c.prototype.recoverTransport=function(a){var b,c,d,e,f,h;for(a=a||this,f=a.transportRecoverAttempts,c=a.configuration.ws_servers.length,b=0;c>b;b++)a.configuration.ws_servers[b].status=0;h=a.getNextWsServer(),d=Math.floor(Math.random()*Math.pow(2,f)+1),e=d*a.configuration.connection_recovery_min_interval,e>a.configuration.connection_recovery_max_interval&&(g("time for next connection attempt exceeds connection_recovery_max_interval, resetting counter"),e=a.configuration.connection_recovery_min_interval,f=0),g("next connection attempt in "+e+" seconds"),this.transportRecoveryTimer=setTimeout(function(){a.transportRecoverAttempts=f+1,a.transport=new l(a,h),a.transport.connect()},1e3*e)},c.prototype.loadConfig=function(a){var b,d,e,f,h,i={via_host:n.createRandomToken(12)+".invalid",password:null,register_expires:600,register:!0,registrar_server:null,ws_server_max_reconnection:3,ws_server_reconnection_timeout:4,connection_recovery_min_interval:2,connection_recovery_max_interval:30,use_preloaded_route:!1,no_answer_timeout:60,stun_servers:["stun:stun.l.google.com:19302"],turn_servers:[],hack_via_tcp:!1,hack_via_ws:!1,hack_ip_in_contact:!1,node_ws_options:{}};for(b in c.configuration_check.mandatory){if(!a.hasOwnProperty(b))throw new p.ConfigurationError(b);if(d=a[b],e=c.configuration_check.mandatory[b].call(this,d),void 0===e)throw new p.ConfigurationError(b,d);i[b]=e}for(b in c.configuration_check.optional)if(a.hasOwnProperty(b)){if(d=a[b],n.isEmpty(d))continue;if(e=c.configuration_check.optional[b].call(this,d),void 0===e)throw new p.ConfigurationError(b,d);i[b]=e}if(i.connection_recovery_max_interval<i.connection_recovery_min_interval)throw new p.ConfigurationError("connection_recovery_max_interval",i.connection_recovery_max_interval);0===i.display_name&&(i.display_name="0"),i.instance_id||(i.instance_id=n.newUUID()),i.jssip_id=n.createRandomToken(5),f=i.uri.clone(),f.user=null,i.hostport_params=f.toString().replace(/^sip:/i,""),i.authorization_user||(i.authorization_user=i.uri.user),i.registrar_server||(h=i.uri.clone(),h.user=null,i.registrar_server=h),i.no_answer_timeout=1e3*i.no_answer_timeout,i.hack_ip_in_contact&&(i.via_host=n.getRandomTestNetIP()),d=a.stun_servers,d instanceof Array&&0===d.length&&(i.stun_servers=[]),this.contact={pub_gruu:null,temp_gruu:null,uri:new q("sip",n.createRandomToken(8),i.via_host,null,{transport:"ws"}),toString:function(a){a=a||{};
var b=a.anonymous||null,c=a.outbound||null,d="<";return d+=b?this.temp_gruu||"sip:anonymous@anonymous.invalid;transport=ws":this.pub_gruu||this.uri.toString(),!c||(b?this.temp_gruu:this.pub_gruu)||(d+=";ob"),d+=">"}};for(b in i)c.configuration_skeleton[b].value=i[b];Object.defineProperties(this.configuration,c.configuration_skeleton);for(b in i)c.configuration_skeleton[b].value="";g("configuration parameters after validation:");for(b in i)switch(b){case"uri":case"registrar_server":g("- "+b+": "+i[b]);break;case"password":g("- "+b+": NOT SHOWN");break;default:g("- "+b+": "+JSON.stringify(i[b]))}},c.configuration_skeleton=function(){var a,b,c={},d=["jssip_id","ws_server_max_reconnection","ws_server_reconnection_timeout","hostport_params","uri","ws_servers","authorization_user","connection_recovery_max_interval","connection_recovery_min_interval","display_name","hack_via_tcp","hack_via_ws","hack_ip_in_contact","instance_id","no_answer_timeout","node_ws_options","password","register_expires","registrar_server","stun_servers","turn_servers","use_preloaded_route","via_core_value","via_host"];for(a in d)b=d[a],c[b]={value:"",writable:!1,configurable:!1};return c.register={value:"",writable:!0,configurable:!1},c}(),c.configuration_check={mandatory:{uri:function(a){var b;return/^sip:/i.test(a)||(a=h.SIP+":"+a),b=q.parse(a),b&&b.user?b:void 0},ws_servers:function(a){var b,c,d;if("string"==typeof a)a=[{ws_uri:a}];else{if(!(a instanceof Array))return;for(c=a.length,b=0;c>b;b++)"string"==typeof a[b]&&(a[b]={ws_uri:a[b]})}if(0===a.length)return!1;for(c=a.length,b=0;c>b;b++){if(!a[b].ws_uri)return void g('ERROR: missing "ws_uri" attribute in ws_servers parameter');if(a[b].weight&&!Number(a[b].weight))return void g('ERROR: "weight" attribute in ws_servers parameter must be a Number');if(d=r.parse(a[b].ws_uri,"absoluteURI"),-1===d)return void g('ERROR: invalid "ws_uri" attribute in ws_servers parameter: '+a[b].ws_uri);if("wss"!==d.scheme&&"ws"!==d.scheme)return void g("ERROR: invalid URI scheme in ws_servers parameter: "+d.scheme);a[b].sip_uri="<sip:"+d.host+(d.port?":"+d.port:"")+";transport=ws;lr>",a[b].weight||(a[b].weight=0),a[b].status=0,a[b].scheme=d.scheme.toUpperCase()}return a}},optional:{authorization_user:function(a){return-1===r.parse('"'+a+'"',"quoted_string")?void 0:a},connection_recovery_max_interval:function(a){var b;return n.isDecimal(a)&&(b=Number(a),b>0)?b:void 0},connection_recovery_min_interval:function(a){var b;return n.isDecimal(a)&&(b=Number(a),b>0)?b:void 0},display_name:function(a){return-1===r.parse('"'+a+'"',"display_name")?void 0:a},hack_via_tcp:function(a){return"boolean"==typeof a?a:void 0},hack_via_ws:function(a){return"boolean"==typeof a?a:void 0},hack_ip_in_contact:function(a){return"boolean"==typeof a?a:void 0},instance_id:function(a){return/^uuid:/i.test(a)&&(a=a.substr(5)),-1===r.parse(a,"uuid")?void 0:a},no_answer_timeout:function(a){var b;return n.isDecimal(a)&&(b=Number(a),b>0)?b:void 0},node_ws_options:function(a){return"object"==typeof a?a:{}},password:function(a){return String(a)},register:function(a){return"boolean"==typeof a?a:void 0},register_expires:function(a){var b;return n.isDecimal(a)&&(b=Number(a),b>0)?b:void 0},registrar_server:function(a){var b;return/^sip:/i.test(a)||(a=h.SIP+":"+a),b=q.parse(a),b?b.user?void 0:b:void 0},stun_servers:function(a){var b,c,d;if("string"==typeof a)a=[a];else if(!(a instanceof Array))return;for(c=a.length,b=0;c>b;b++){if(d=a[b],/^stuns?:/.test(d)||(d="stun:"+d),-1===r.parse(d,"stun_URI"))return;a[b]=d}return a},turn_servers:function(a){var b,c,d,e,f,g;for(!a instanceof Array&&(a=[a]),d=a.length,b=0;d>b;b++){if(f=a[b],f.server&&(f.urls=[f.server]),f.password&&(f.credential=[f.password]),!f.urls||!f.username||!f.credential)return;for(f.urls instanceof Array||(f.urls=[f.urls]),e=f.urls.length,c=0;e>c;c++)if(g=f.urls[c],/^turns?:/.test(g)||(g="turn:"+g),-1===r.parse(g,"turn_URI"))return}return a},use_preloaded_route:function(a){return"boolean"==typeof a?a:void 0}}}},{"./Constants":15,"./Exceptions":19,"./Grammar":20,"./Message":22,"./RTCSession":25,"./Registrator":29,"./Transactions":33,"./Transport":34,"./URI":36,"./Utils":37,"./WebRTC":38,debug:1,events:4,util:8}],36:[function(a,b){function c(a,b,c,e,f,g){var h,i;if(!c)throw new TypeError('missing or invalid "host" parameter');a=a||d.SIP,this.parameters={},this.headers={};for(h in f)this.setParam(h,f[h]);for(i in g)this.setHeader(i,g[i]);Object.defineProperties(this,{scheme:{get:function(){return a},set:function(b){a=b.toLowerCase()}},user:{get:function(){return b},set:function(a){b=a}},host:{get:function(){return c},set:function(a){c=a.toLowerCase()}},port:{get:function(){return e},set:function(a){e=0===a?a:parseInt(a,10)||null}}})}b.exports=c;var d=a("./Constants"),e=a("./Utils"),f=a("./Grammar");c.prototype={setParam:function(a,b){a&&(this.parameters[a.toLowerCase()]="undefined"==typeof b||null===b?null:b.toString().toLowerCase())},getParam:function(a){return a?this.parameters[a.toLowerCase()]:void 0},hasParam:function(a){return a?this.parameters.hasOwnProperty(a.toLowerCase())&&!0||!1:void 0},deleteParam:function(a){var b;return a=a.toLowerCase(),this.parameters.hasOwnProperty(a)?(b=this.parameters[a],delete this.parameters[a],b):void 0},clearParams:function(){this.parameters={}},setHeader:function(a,b){this.headers[e.headerize(a)]=b instanceof Array?b:[b]},getHeader:function(a){return a?this.headers[e.headerize(a)]:void 0},hasHeader:function(a){return a?this.headers.hasOwnProperty(e.headerize(a))&&!0||!1:void 0},deleteHeader:function(a){var b;return a=e.headerize(a),this.headers.hasOwnProperty(a)?(b=this.headers[a],delete this.headers[a],b):void 0},clearHeaders:function(){this.headers={}},clone:function(){return new c(this.scheme,this.user,this.host,this.port,JSON.parse(JSON.stringify(this.parameters)),JSON.parse(JSON.stringify(this.headers)))},toString:function(){var a,b,c,d,f=[];d=this.scheme+":",this.user&&(d+=e.escapeUser(this.user)+"@"),d+=this.host,(this.port||0===this.port)&&(d+=":"+this.port);for(b in this.parameters)d+=";"+b,null!==this.parameters[b]&&(d+="="+this.parameters[b]);for(a in this.headers)for(c in this.headers[a])f.push(a+"="+this.headers[a][c]);return f.length>0&&(d+="?"+f.join("&")),d},toAor:function(a){var b;return b=this.scheme+":",this.user&&(b+=e.escapeUser(this.user)+"@"),b+=this.host,a&&(this.port||0===this.port)&&(b+=":"+this.port),b}},c.parse=function(a){return a=f.parse(a,"SIP_URI"),-1!==a?a:void 0}},{"./Constants":15,"./Grammar":20,"./Utils":37}],37:[function(a,b){var c={};b.exports=c;var d=a("./Constants"),e=a("./URI"),f=a("./Grammar");c.str_utf8_length=function(a){return unescape(encodeURIComponent(a)).length},c.isFunction=function(a){return void 0!==a&&"[object Function]"===Object.prototype.toString.call(a)?!0:!1},c.isDecimal=function(a){return!isNaN(a)&&parseFloat(a)===parseInt(a,10)},c.isEmpty=function(a){return null===a||""===a||void 0===a||a instanceof Array&&0===a.length||"number"==typeof a&&isNaN(a)?!0:void 0},c.createRandomToken=function(a,b){var c,d,e="";for(b=b||32,c=0;a>c;c++)d=Math.random()*b|0,e+=d.toString(b);return e},c.newTag=function(){return c.createRandomToken(10)},c.newUUID=function(){var a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)});return a},c.hostType=function(a){return a?(a=f.parse(a,"host"),-1!==a?a.host_type:void 0):void 0},c.normalizeTarget=function(a,b){var f,g,h,i;if(a){if(a instanceof e)return a;if("string"==typeof a){switch(g=a.split("@"),g.length){case 1:if(!b)return;h=a,i=b;break;case 2:h=g[0],i=g[1];break;default:h=g.slice(0,g.length-1).join("@"),i=g[g.length-1]}return h=h.replace(/^(sips?|tel):/i,""),/^[\-\.\(\)]*\+?[0-9\-\.\(\)]+$/.test(h)&&(h=h.replace(/[\-\.\(\)]/g,"")),a=d.SIP+":"+c.escapeUser(h)+"@"+i,(f=e.parse(a))?f:void 0}}else;},c.escapeUser=function(a){return encodeURIComponent(decodeURIComponent(a)).replace(/%3A/gi,":").replace(/%2B/gi,"+").replace(/%3F/gi,"?").replace(/%2F/gi,"/")},c.headerize=function(a){var b,c={"Call-Id":"Call-ID",Cseq:"CSeq","Www-Authenticate":"WWW-Authenticate"},d=a.toLowerCase().replace(/_/g,"-").split("-"),e="",f=d.length;for(b=0;f>b;b++)0!==b&&(e+="-"),e+=d[b].charAt(0).toUpperCase()+d[b].substring(1);return c[e]&&(e=c[e]),e},c.sipErrorCause=function(a){var b;for(b in d.SIP_ERROR_CAUSES)if(-1!==d.SIP_ERROR_CAUSES[b].indexOf(a))return d.causes[b];return d.causes.SIP_FAILURE_CODE},c.getRandomTestNetIP=function(){function a(a,b){return Math.floor(Math.random()*(b-a+1)+a)}return"192.0.2."+a(1,254)},c.calculateMD5=function(a){function b(a,b){return a<<b|a>>>32-b}function c(a,b){var c,d,e,f,g;return e=2147483648&a,f=2147483648&b,c=1073741824&a,d=1073741824&b,g=(1073741823&a)+(1073741823&b),c&d?2147483648^g^e^f:c|d?1073741824&g?3221225472^g^e^f:1073741824^g^e^f:g^e^f}function d(a,b,c){return a&b|~a&c}function e(a,b,c){return a&c|b&~c}function f(a,b,c){return a^b^c}function g(a,b,c){return b^(a|~c)}function h(a,e,f,g,h,i,j){return a=c(a,c(c(d(e,f,g),h),j)),c(b(a,i),e)}function i(a,d,f,g,h,i,j){return a=c(a,c(c(e(d,f,g),h),j)),c(b(a,i),d)}function j(a,d,e,g,h,i,j){return a=c(a,c(c(f(d,e,g),h),j)),c(b(a,i),d)}function k(a,d,e,f,h,i,j){return a=c(a,c(c(g(d,e,f),h),j)),c(b(a,i),d)}function l(a){for(var b,c=a.length,d=c+8,e=(d-d%64)/64,f=16*(e+1),g=new Array(f-1),h=0,i=0;c>i;)b=(i-i%4)/4,h=i%4*8,g[b]=g[b]|a.charCodeAt(i)<<h,i++;return b=(i-i%4)/4,h=i%4*8,g[b]=g[b]|128<<h,g[f-2]=c<<3,g[f-1]=c>>>29,g}function m(a){var b,c,d="",e="";for(c=0;3>=c;c++)b=a>>>8*c&255,e="0"+b.toString(16),d+=e.substr(e.length-2,2);return d}function n(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=String.fromCharCode(d):d>127&&2048>d?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(63&d|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(63&d|128))}return b}var o,p,q,r,s,t,u,v,w,x=[],y=7,z=12,A=17,B=22,C=5,D=9,E=14,F=20,G=4,H=11,I=16,J=23,K=6,L=10,M=15,N=21;for(a=n(a),x=l(a),t=1732584193,u=4023233417,v=2562383102,w=271733878,o=0;o<x.length;o+=16)p=t,q=u,r=v,s=w,t=h(t,u,v,w,x[o+0],y,3614090360),w=h(w,t,u,v,x[o+1],z,3905402710),v=h(v,w,t,u,x[o+2],A,606105819),u=h(u,v,w,t,x[o+3],B,3250441966),t=h(t,u,v,w,x[o+4],y,4118548399),w=h(w,t,u,v,x[o+5],z,1200080426),v=h(v,w,t,u,x[o+6],A,2821735955),u=h(u,v,w,t,x[o+7],B,4249261313),t=h(t,u,v,w,x[o+8],y,1770035416),w=h(w,t,u,v,x[o+9],z,2336552879),v=h(v,w,t,u,x[o+10],A,4294925233),u=h(u,v,w,t,x[o+11],B,2304563134),t=h(t,u,v,w,x[o+12],y,1804603682),w=h(w,t,u,v,x[o+13],z,4254626195),v=h(v,w,t,u,x[o+14],A,2792965006),u=h(u,v,w,t,x[o+15],B,1236535329),t=i(t,u,v,w,x[o+1],C,4129170786),w=i(w,t,u,v,x[o+6],D,3225465664),v=i(v,w,t,u,x[o+11],E,643717713),u=i(u,v,w,t,x[o+0],F,3921069994),t=i(t,u,v,w,x[o+5],C,3593408605),w=i(w,t,u,v,x[o+10],D,38016083),v=i(v,w,t,u,x[o+15],E,3634488961),u=i(u,v,w,t,x[o+4],F,3889429448),t=i(t,u,v,w,x[o+9],C,568446438),w=i(w,t,u,v,x[o+14],D,3275163606),v=i(v,w,t,u,x[o+3],E,4107603335),u=i(u,v,w,t,x[o+8],F,1163531501),t=i(t,u,v,w,x[o+13],C,2850285829),w=i(w,t,u,v,x[o+2],D,4243563512),v=i(v,w,t,u,x[o+7],E,1735328473),u=i(u,v,w,t,x[o+12],F,2368359562),t=j(t,u,v,w,x[o+5],G,4294588738),w=j(w,t,u,v,x[o+8],H,2272392833),v=j(v,w,t,u,x[o+11],I,1839030562),u=j(u,v,w,t,x[o+14],J,4259657740),t=j(t,u,v,w,x[o+1],G,2763975236),w=j(w,t,u,v,x[o+4],H,1272893353),v=j(v,w,t,u,x[o+7],I,4139469664),u=j(u,v,w,t,x[o+10],J,3200236656),t=j(t,u,v,w,x[o+13],G,681279174),w=j(w,t,u,v,x[o+0],H,3936430074),v=j(v,w,t,u,x[o+3],I,3572445317),u=j(u,v,w,t,x[o+6],J,76029189),t=j(t,u,v,w,x[o+9],G,3654602809),w=j(w,t,u,v,x[o+12],H,3873151461),v=j(v,w,t,u,x[o+15],I,530742520),u=j(u,v,w,t,x[o+2],J,3299628645),t=k(t,u,v,w,x[o+0],K,4096336452),w=k(w,t,u,v,x[o+7],L,1126891415),v=k(v,w,t,u,x[o+14],M,2878612391),u=k(u,v,w,t,x[o+5],N,4237533241),t=k(t,u,v,w,x[o+12],K,1700485571),w=k(w,t,u,v,x[o+3],L,2399980690),v=k(v,w,t,u,x[o+10],M,4293915773),u=k(u,v,w,t,x[o+1],N,2240044497),t=k(t,u,v,w,x[o+8],K,1873313359),w=k(w,t,u,v,x[o+15],L,4264355552),v=k(v,w,t,u,x[o+6],M,2734768916),u=k(u,v,w,t,x[o+13],N,1309151649),t=k(t,u,v,w,x[o+4],K,4149444226),w=k(w,t,u,v,x[o+11],L,3174756917),v=k(v,w,t,u,x[o+2],M,718787259),u=k(u,v,w,t,x[o+9],N,3951481745),t=c(t,p),u=c(u,q),v=c(v,r),w=c(w,s);var O=m(t)+m(u)+m(v)+m(w);return O.toLowerCase()}},{"./Constants":15,"./Grammar":20,"./URI":36}],38:[function(a,b){var c={};b.exports=c,"undefined"!=typeof navigator&&navigator.webkitGetUserMedia?c.getUserMedia=navigator.webkitGetUserMedia.bind(navigator):"undefined"!=typeof navigator&&navigator.mozGetUserMedia?c.getUserMedia=navigator.mozGetUserMedia.bind(navigator):"undefined"!=typeof navigator&&navigator.getUserMedia&&(c.getUserMedia=navigator.getUserMedia.bind(navigator)),"undefined"!=typeof webkitRTCPeerConnection?c.RTCPeerConnection=webkitRTCPeerConnection:"undefined"!=typeof mozRTCPeerConnection?c.RTCPeerConnection=mozRTCPeerConnection:"undefined"!=typeof RTCPeerConnection&&(c.RTCPeerConnection=RTCPeerConnection),"undefined"!=typeof webkitRTCSessionDescription?c.RTCSessionDescription=webkitRTCSessionDescription:"undefined"!=typeof mozRTCSessionDescription?c.RTCSessionDescription=mozRTCSessionDescription:"undefined"!=typeof RTCSessionDescription&&(c.RTCSessionDescription=RTCSessionDescription),c.RTCPeerConnection&&c.RTCPeerConnection.prototype&&(c.RTCPeerConnection.prototype.getLocalStreams||(c.RTCPeerConnection.prototype.getLocalStreams=function(){return this.localStreams},c.RTCPeerConnection.prototype.getRemoteStreams=function(){return this.remoteStreams})),c.isSupported=c.getUserMedia&&c.RTCPeerConnection&&c.RTCSessionDescription?!0:!1},{}],39:[function(a,b){function c(a,b,c){var d,e;for(l=a,m=b,n=c,d=u.length;d--;)if(e=u[d](l),e===!1)return!1;if(l instanceof q.IncomingRequest){for(d=s.length;d--;)if(e=s[d](l),e===!1)return!1}else if(l instanceof q.IncomingResponse)for(d=t.length;d--;)if(e=t[d](l),e===!1)return!1;return!0}function d(){return"sip"!==l.s("to").uri.scheme?(k(416),!1):void 0}function e(){return l.to_tag||l.call_id.substr(0,5)!==m.configuration.jssip_id?void 0:(k(482),!1)}function f(){var a=r.str_utf8_length(l.body),b=l.getHeader("content-length");return b>a?(k(400),!1):void 0}function g(){var a,b,c=l.from_tag,d=l.call_id,e=l.cseq;if(!l.to_tag)if(l.method===p.INVITE){if(m.transactions.ist[l.via_branch])return!1;for(b in m.transactions.ist)if(a=m.transactions.ist[b],a.request.from_tag===c&&a.request.call_id===d&&a.request.cseq===e)return k(482),!1}else{if(m.transactions.nist[l.via_branch])return!1;for(b in m.transactions.nist)if(a=m.transactions.nist[b],a.request.from_tag===c&&a.request.call_id===d&&a.request.cseq===e)return k(482),!1}}function h(){return l.getHeaders("via").length>1?(o("more than one Via header field present in the response, dropping the response"),!1):void 0}function i(){var a=r.str_utf8_length(l.body),b=l.getHeader("content-length");return b>a?(o("message body length is lower than the value in Content-Length header field, dropping the response"),!1):void 0}function j(){for(var a=["from","to","call_id","cseq","via"],b=a.length;b--;)if(!l.hasHeader(a[b]))return o("missing mandatory header field : "+a[b]+", dropping the response"),!1}function k(a){var b,c="SIP/2.0 "+a+" "+p.REASON_PHRASE[a]+"\r\n",d=l.getHeaders("via"),e=d.length,f=0;for(f;e>f;f++)c+="Via: "+d[f]+"\r\n";b=l.getHeader("To"),l.to_tag||(b+=";tag="+r.newTag()),c+="To: "+b+"\r\n",c+="From: "+l.getHeader("From")+"\r\n",c+="Call-ID: "+l.call_id+"\r\n",c+="CSeq: "+l.cseq+" "+l.method+"\r\n",c+="\r\n",n.send(c)}b.exports=c;var l,m,n,o=a("debug")("JsSIP:sanityCheck"),p=a("./Constants"),q=a("./SIPMessage"),r=a("./Utils"),s=[],t=[],u=[];s.push(d),s.push(e),s.push(f),s.push(g),t.push(h),t.push(i),u.push(j)},{"./Constants":15,"./SIPMessage":31,"./Utils":37,debug:1}]},{},[21])(21)});